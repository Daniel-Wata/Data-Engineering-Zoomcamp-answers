[0m10:12:30.930545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002729ADBF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002729ADBF8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002729ADA2690>]}


============================== 10:12:30.937056 | 22a5f153-9db9-4161-9f90-615c73a69537 ==============================
[0m10:12:30.937056 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:12:30.938060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:12:30.940060 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04/profiles.yml
  
[0m10:12:30.942059 [debug] [MainThread]: Command `dbt run` failed at 10:12:30.942059 after 0.11 seconds
[0m10:12:30.942059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027296436F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002729ADE39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002729ADC7A50>]}
[0m10:12:30.943059 [debug] [MainThread]: Flushing usage events
[0m10:12:32.777409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:30.689262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017360D72F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017360D72E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017360D72850>]}


============================== 10:13:30.695758 | dae9a0d5-716e-4cc1-9349-0a897d4592ea ==============================
[0m10:13:30.695758 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:13:30.696764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:13:32.341704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dae9a0d5-716e-4cc1-9349-0a897d4592ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017313AF6590>]}
[0m10:13:32.377770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dae9a0d5-716e-4cc1-9349-0a897d4592ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001735E2DD610>]}
[0m10:13:32.378771 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:13:32.821014 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:13:32.822015 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:13:32.823014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dae9a0d5-716e-4cc1-9349-0a897d4592ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017313638F10>]}
[0m10:13:35.822475 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.test' (models\silver\test.sql) depends on a source named 'raw_nyc_tripdata.green_taxi' which was not found
[0m10:13:35.824390 [debug] [MainThread]: Command `dbt run` failed at 10:13:35.824390 after 5.22 seconds
[0m10:13:35.824390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017359E96F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017315295750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017360C87810>]}
[0m10:13:35.825391 [debug] [MainThread]: Flushing usage events
[0m10:13:37.512285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:59.351349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F975C6E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F975A91D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F975CA3010>]}


============================== 10:15:59.355349 | 6ad87703-0992-4641-852a-674bb2a88a06 ==============================
[0m10:15:59.355349 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:15:59.355871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:16:00.398126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ad87703-0992-4641-852a-674bb2a88a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F982AF3490>]}
[0m10:16:00.444289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ad87703-0992-4641-852a-674bb2a88a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F982B15ED0>]}
[0m10:16:00.445795 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:16:00.825827 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:16:00.826489 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:16:00.826489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ad87703-0992-4641-852a-674bb2a88a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F982C09750>]}
[0m10:16:01.779640 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.test' (models\silver\test.sql) depends on a source named 'raw_nyc_tripdata.green_taxi' which was not found
[0m10:16:01.781641 [debug] [MainThread]: Command `dbt run` failed at 10:16:01.781641 after 2.49 seconds
[0m10:16:01.782641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F975A92490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96EDD6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9759931D0>]}
[0m10:16:01.783640 [debug] [MainThread]: Flushing usage events
[0m10:16:03.495435 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:41.336608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD1B72990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD1BA0DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD1BA2E50>]}


============================== 10:17:41.341700 | 039353de-204c-4acb-940c-5a2b2f3cb6a5 ==============================
[0m10:17:41.341700 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:17:41.342608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:42.514447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '039353de-204c-4acb-940c-5a2b2f3cb6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE029F2C50>]}
[0m10:17:42.559638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '039353de-204c-4acb-940c-5a2b2f3cb6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDCFE5FA50>]}
[0m10:17:42.560641 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:17:42.949458 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:17:42.950383 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:17:42.951375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '039353de-204c-4acb-940c-5a2b2f3cb6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE02AC3E90>]}
[0m10:17:43.791147 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.test' (models\silver\test.sql) depends on a source named 'raw_nyc_tripdata.green_taxi' which was not found
[0m10:17:43.792149 [debug] [MainThread]: Command `dbt run` failed at 10:17:43.792149 after 2.54 seconds
[0m10:17:43.792149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDCACD6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE04102A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE0410B610>]}
[0m10:17:43.793073 [debug] [MainThread]: Flushing usage events
[0m10:17:45.494151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:46.885883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8016EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A801A2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A801A1290>]}


============================== 10:19:46.890003 | 399eee53-54ab-40eb-8eaa-abecc2668f5e ==============================
[0m10:19:46.890003 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:19:46.890997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:19:48.108103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '399eee53-54ab-40eb-8eaa-abecc2668f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB1A05190>]}
[0m10:19:48.153029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '399eee53-54ab-40eb-8eaa-abecc2668f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AFB6D9E90>]}
[0m10:19:48.154029 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:19:48.523732 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:19:48.524722 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:19:48.525690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '399eee53-54ab-40eb-8eaa-abecc2668f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB30F3BD0>]}
[0m10:19:49.353495 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.test' (models\silver\test.sql) depends on a source named 'raw_nyc_tripdata.green_taxi' which was not found
[0m10:19:49.354482 [debug] [MainThread]: Command `dbt run` failed at 10:19:49.354482 after 2.56 seconds
[0m10:19:49.355483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AFA756F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB3553B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB380A690>]}
[0m10:19:49.355989 [debug] [MainThread]: Flushing usage events
[0m10:19:50.045607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:41.760039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8E26F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8E08DC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8E2A38D0>]}


============================== 10:21:41.764079 | c1981fc3-08d8-4518-83aa-947253638372 ==============================
[0m10:21:41.764079 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:21:41.765031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:21:42.902008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1981fc3-08d8-4518-83aa-947253638372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8E2F6810>]}
[0m10:21:42.944355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1981fc3-08d8-4518-83aa-947253638372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8C613950>]}
[0m10:21:42.945909 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:21:43.290593 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:21:43.291588 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:21:43.292504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1981fc3-08d8-4518-83aa-947253638372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AC12F52D0>]}
[0m10:21:44.094320 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.test' (models\silver\test.sql) depends on a source named 'raw_nyc_tripdata.green_taxi' which was not found
[0m10:21:44.095826 [debug] [MainThread]: Command `dbt run` failed at 10:21:44.095826 after 2.41 seconds
[0m10:21:44.096831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A88806F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8E263F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A8E263910>]}
[0m10:21:44.096831 [debug] [MainThread]: Flushing usage events
[0m10:21:44.754307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:16.119863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA786C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA78A2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA78A37D0>]}


============================== 10:22:16.126567 | 455b922a-67d7-40fc-b3a5-65b83024565c ==============================
[0m10:22:16.126567 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:22:16.128456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:22:17.246903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '455b922a-67d7-40fc-b3a5-65b83024565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDA537A10>]}
[0m10:22:17.283970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '455b922a-67d7-40fc-b3a5-65b83024565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA4C13810>]}
[0m10:22:17.285058 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:22:17.613787 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:22:17.614392 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:22:17.615502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '455b922a-67d7-40fc-b3a5-65b83024565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDAB9B7D0>]}
[0m10:22:18.386988 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.test' (models\silver\test.sql) depends on a source named 'sources.green_taxi' which was not found
[0m10:22:18.388985 [debug] [MainThread]: Command `dbt run` failed at 10:22:18.388985 after 2.35 seconds
[0m10:22:18.388985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA1E26F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA203F510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DDA8C7F50>]}
[0m10:22:18.390108 [debug] [MainThread]: Flushing usage events
[0m10:22:18.982861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:23:19.831886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AE56F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AE5A2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AE5A2E10>]}


============================== 10:23:19.837397 | 8ed7384d-3903-4984-b893-2dce7176262b ==============================
[0m10:23:19.837397 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:23:19.838411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:21.045000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ed7384d-3903-4984-b893-2dce7176262b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4E149C0D0>]}
[0m10:23:21.086005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ed7384d-3903-4984-b893-2dce7176262b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A9B59E10>]}
[0m10:23:21.088006 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:23:21.444892 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:23:21.445894 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:23:21.446894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ed7384d-3903-4984-b893-2dce7176262b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4E15EE810>]}
[0m10:23:22.264928 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.test' (models\silver\test.sql) depends on a source named 'staging.green_tripdata' which was not found
[0m10:23:22.266544 [debug] [MainThread]: Command `dbt run` failed at 10:23:22.266544 after 2.50 seconds
[0m10:23:22.267067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A8B86F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4A8E1B810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4E18F1E90>]}
[0m10:23:22.267594 [debug] [MainThread]: Flushing usage events
[0m10:23:23.045161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:07.178703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3366EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE2E7DC690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE334924D0>]}


============================== 10:25:07.183710 | 7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f ==============================
[0m10:25:07.183710 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:25:07.183710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:08.451952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE64FD51D0>]}
[0m10:25:08.491667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE31ABE1D0>]}
[0m10:25:08.492667 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:25:08.896304 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:25:08.897304 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:25:08.898305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE665F1C50>]}
[0m10:25:09.794664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE31B65B90>]}
[0m10:25:09.843991 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m10:25:09.849248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m10:25:10.135555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE66C38FD0>]}
[0m10:25:10.136560 [info ] [MainThread]: Found 1 model, 2 sources, 491 macros
[0m10:25:10.137559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE33663E90>]}
[0m10:25:10.138573 [info ] [MainThread]: 
[0m10:25:10.139561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:25:10.140560 [info ] [MainThread]: 
[0m10:25:10.140560 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:25:10.142558 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m10:25:10.142558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:10.669432 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m10:25:10.670430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:11.198724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE66C3CC10>]}
[0m10:25:11.199721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:11.204740 [debug] [Thread-1 (]: Began running node model.my_dbt_project.test
[0m10:25:11.205747 [info ] [Thread-1 (]: 1 of 1 START sql view model taxi_data.test ..................................... [RUN]
[0m10:25:11.206749 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.my_dbt_project.test'
[0m10:25:11.206749 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.test
[0m10:25:11.215021 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.test"
[0m10:25:11.218018 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.test
[0m10:25:11.241064 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.test"
[0m10:25:11.243064 [debug] [Thread-1 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data`.`test`
  OPTIONS()
  as with source as (
    select * 
    from `tough-timing-449701-k0`.`taxi_data`.`green_tripdata`
)
select * from source;


[0m10:25:11.244064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:11.992375 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:9d4c4388-bcfb-4ad1-a1c4-5a50d7ee03e1&page=queryresults
[0m10:25:15.632866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a80cff5-b5fc-41d2-a0f9-5fcbbab5b54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE66BFC710>]}
[0m10:25:15.633865 [info ] [Thread-1 (]: 1 of 1 OK created sql view model taxi_data.test ................................ [[32mCREATE VIEW (0 processed)[0m in 4.41s]
[0m10:25:15.634882 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.test
[0m10:25:15.635883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:15.637891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:15.637891 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m10:25:15.637891 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m10:25:15.637891 [debug] [MainThread]: Connection 'model.my_dbt_project.test' was properly closed.
[0m10:25:15.638882 [info ] [MainThread]: 
[0m10:25:15.638882 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m10:25:15.639882 [debug] [MainThread]: Command end result
[0m10:25:15.657580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m10:25:15.659675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m10:25:15.664108 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m10:25:15.665121 [info ] [MainThread]: 
[0m10:25:15.665121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:25:15.666128 [info ] [MainThread]: 
[0m10:25:15.667129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:25:15.668138 [debug] [MainThread]: Command `dbt run` succeeded at 10:25:15.668138 after 8.59 seconds
[0m10:25:15.668138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE2DC26F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE336C5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE2DEBB7D0>]}
[0m10:25:15.669134 [debug] [MainThread]: Flushing usage events
[0m10:25:16.501098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:50.083868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CFC26F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CFC2A1A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CFC26E7D0>]}


============================== 10:25:50.087401 | 0e4f7d8e-3374-4ae3-a5ea-1529337766b5 ==============================
[0m10:25:50.087401 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:25:50.088385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:25:51.227098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e4f7d8e-3374-4ae3-a5ea-1529337766b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CFADDA190>]}
[0m10:25:51.270843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e4f7d8e-3374-4ae3-a5ea-1529337766b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF77CDA50>]}
[0m10:25:51.271845 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:25:51.609476 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:25:51.739517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:25:51.740506 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\staging\schema.yaml
[0m10:25:51.972153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e4f7d8e-3374-4ae3-a5ea-1529337766b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAF5FB150>]}
[0m10:25:52.017985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m10:25:52.021977 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m10:25:52.036853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e4f7d8e-3374-4ae3-a5ea-1529337766b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAFA14BD0>]}
[0m10:25:52.037844 [info ] [MainThread]: Found 1 model, 2 sources, 491 macros
[0m10:25:52.038844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e4f7d8e-3374-4ae3-a5ea-1529337766b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAF856210>]}
[0m10:25:52.039853 [info ] [MainThread]: 
[0m10:25:52.039853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:25:52.040853 [info ] [MainThread]: 
[0m10:25:52.041853 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:25:52.041853 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m10:25:52.042852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:52.589251 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m10:25:52.589251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:53.099480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e4f7d8e-3374-4ae3-a5ea-1529337766b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAFA28B10>]}
[0m10:25:53.099480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:53.102484 [debug] [Thread-1 (]: Began running node model.my_dbt_project.test
[0m10:25:53.102484 [info ] [Thread-1 (]: 1 of 1 START sql view model taxi_data.test ..................................... [RUN]
[0m10:25:53.104096 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.my_dbt_project.test'
[0m10:25:53.104096 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.test
[0m10:25:53.109921 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.test"
[0m10:25:53.110885 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.test
[0m10:25:53.200442 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.test"
[0m10:25:53.202349 [debug] [Thread-1 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data`.`test`
  OPTIONS()
  as with source as (
    select * 
    from `none`.`taxi_data`.`green_tripdata`
)
select * from source;


[0m10:25:53.202349 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:53.922611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:29f37cc8-e18e-45fe-861f-f41f7ed5e46f&page=queryresults
[0m10:25:53.924229 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:29f37cc8-e18e-45fe-861f-f41f7ed5e46f&page=queryresults
[0m10:25:53.952807 [debug] [Thread-1 (]: Database Error in model test (models\silver\test.sql)
  Access Denied: Table none:taxi_data.green_tripdata: User does not have permission to query table none:taxi_data.green_tripdata, or perhaps it does not exist.
  compiled code at target\run\my_dbt_project\models\silver\test.sql
[0m10:25:53.953801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e4f7d8e-3374-4ae3-a5ea-1529337766b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CAF8B4310>]}
[0m10:25:53.955204 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model taxi_data.test ............................ [[31mERROR[0m in 0.85s]
[0m10:25:53.957206 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.test
[0m10:25:53.957206 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.test' to be skipped because of status 'error'.  Reason: Database Error in model test (models\silver\test.sql)
  Access Denied: Table none:taxi_data.green_tripdata: User does not have permission to query table none:taxi_data.green_tripdata, or perhaps it does not exist.
  compiled code at target\run\my_dbt_project\models\silver\test.sql.
[0m10:25:53.959203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:53.960219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:53.961211 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m10:25:53.961211 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m10:25:53.962207 [debug] [MainThread]: Connection 'model.my_dbt_project.test' was properly closed.
[0m10:25:53.962207 [info ] [MainThread]: 
[0m10:25:53.963713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m10:25:53.964719 [debug] [MainThread]: Command end result
[0m10:25:53.982231 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m10:25:53.983746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m10:25:53.989765 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m10:25:53.989765 [info ] [MainThread]: 
[0m10:25:53.990776 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:25:53.990776 [info ] [MainThread]: 
[0m10:25:53.991766 [error] [MainThread]:   Database Error in model test (models\silver\test.sql)
  Access Denied: Table none:taxi_data.green_tripdata: User does not have permission to query table none:taxi_data.green_tripdata, or perhaps it does not exist.
  compiled code at target\run\my_dbt_project\models\silver\test.sql
[0m10:25:53.991766 [info ] [MainThread]: 
[0m10:25:53.992765 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:25:53.995048 [debug] [MainThread]: Command `dbt run` failed at 10:25:53.995048 after 3.98 seconds
[0m10:25:53.996040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF67F6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF6A0F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF6A0F550>]}
[0m10:25:53.996040 [debug] [MainThread]: Flushing usage events
[0m10:25:54.623922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:40.690413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27976EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27976F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27976C490>]}


============================== 10:26:40.693929 | dcc75044-f9d3-4d38-aa64-5270f1a7dbb8 ==============================
[0m10:26:40.693929 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:26:40.695936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:26:41.825531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcc75044-f9d3-4d38-aa64-5270f1a7dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2797F4650>]}
[0m10:26:41.864605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcc75044-f9d3-4d38-aa64-5270f1a7dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22C712190>]}
[0m10:26:41.865611 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m10:26:42.234133 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:26:42.356988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:42.357988 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\staging\schema.yaml
[0m10:26:42.606366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcc75044-f9d3-4d38-aa64-5270f1a7dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22C9F23D0>]}
[0m10:26:42.652669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m10:26:42.657921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m10:26:42.815217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcc75044-f9d3-4d38-aa64-5270f1a7dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22CE96F90>]}
[0m10:26:42.816218 [info ] [MainThread]: Found 1 model, 2 sources, 491 macros
[0m10:26:42.818223 [info ] [MainThread]: 
[0m10:26:42.819214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:42.820217 [info ] [MainThread]: 
[0m10:26:42.821213 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:26:42.822214 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m10:26:42.822214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:43.469600 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m10:26:43.470694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:43.940372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcc75044-f9d3-4d38-aa64-5270f1a7dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22CD26550>]}
[0m10:26:43.941382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:43.943897 [debug] [Thread-1 (]: Began running node model.my_dbt_project.test
[0m10:26:43.943897 [info ] [Thread-1 (]: 1 of 1 START sql view model taxi_data.test ..................................... [RUN]
[0m10:26:43.944907 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.my_dbt_project.test'
[0m10:26:43.944907 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.test
[0m10:26:43.950913 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.test"
[0m10:26:43.951915 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.test
[0m10:26:43.976005 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.test"
[0m10:26:43.976997 [debug] [Thread-1 (]: On model.my_dbt_project.test: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.test"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data`.`test`
  OPTIONS()
  as with source as (
    select * 
    from `tough-timing-449701-k0`.`taxi_data`.`green_tripdata`
)
select * from source;


[0m10:26:43.977998 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:26:44.662436 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:33128106-fb37-4805-8efd-db8254af40e0&page=queryresults
[0m10:26:45.149885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc75044-f9d3-4d38-aa64-5270f1a7dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D22CC89410>]}
[0m10:26:45.150891 [info ] [Thread-1 (]: 1 of 1 OK created sql view model taxi_data.test ................................ [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m10:26:45.151886 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.test
[0m10:26:45.152886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:45.153897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:45.153897 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m10:26:45.153897 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m10:26:45.155031 [debug] [MainThread]: Connection 'model.my_dbt_project.test' was properly closed.
[0m10:26:45.155031 [info ] [MainThread]: 
[0m10:26:45.156033 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m10:26:45.156033 [debug] [MainThread]: Command end result
[0m10:26:45.173902 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m10:26:45.176921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m10:26:45.181910 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m10:26:45.181910 [info ] [MainThread]: 
[0m10:26:45.182913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:45.183910 [info ] [MainThread]: 
[0m10:26:45.183910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:26:45.185305 [debug] [MainThread]: Command `dbt build` succeeded at 10:26:45.185305 after 4.60 seconds
[0m10:26:45.185305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D273CD6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D273F6B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D273EEE910>]}
[0m10:26:45.186291 [debug] [MainThread]: Flushing usage events
[0m10:26:46.445232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:07.728846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4E356F450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4E35A6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4E35A6DD0>]}


============================== 19:01:07.744483 | c7ab20da-dd03-4e24-afa4-e30dade86fde ==============================
[0m19:01:07.744483 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:01:07.745023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:01:20.511866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7ab20da-dd03-4e24-afa4-e30dade86fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E49623BB90>]}
[0m19:01:20.549862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7ab20da-dd03-4e24-afa4-e30dade86fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4DEA78690>]}
[0m19:01:20.550386 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:01:21.258183 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:01:23.793228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m19:01:23.794227 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_yellow_tripdata.sql
[0m19:01:23.794227 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dim_zones.sql
[0m19:01:23.794227 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\taxi_zone_lookup.csv
[0m19:01:23.794227 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\get_payment_type_description.sql
[0m19:01:23.795808 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\macros_properties.yml
[0m19:01:23.795808 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\fact_trips.sql
[0m19:01:23.796835 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_green_tripdata.sql
[0m19:01:23.796835 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\silver\schema.yaml
[0m19:01:23.797818 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\schema.yml
[0m19:01:23.797818 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dm_monthly)zone_revenue.sql
[0m19:01:23.797818 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\seeds_properties.yml
[0m19:01:24.093148 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_nyc_tripdata_green_tripdata".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw_nyc_tripdata", "green_tripdata").
  
  To fix this, change the name of one of these resources:
  - source.my_dbt_project.raw_nyc_tripdata.green_tripdata (models\silver\schema.yaml)
  - source.my_dbt_project.raw_nyc_tripdata.green_tripdata (models\staging\schema.yaml)
[0m19:01:24.094148 [debug] [MainThread]: Command `dbt test` failed at 19:01:24.094148 after 16.48 seconds
[0m19:01:24.095146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4DDAA6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4E35C9710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4E35C8750>]}
[0m19:01:24.095146 [debug] [MainThread]: Flushing usage events
[0m19:01:24.755498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:03.601694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FA5C6E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FA5CCA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FA5C6C390>]}


============================== 19:02:03.605703 | 45bdd56c-17e5-4726-9993-6cfcb5c3f49c ==============================
[0m19:02:03.605703 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:02:03.605703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:02:05.052127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45bdd56c-17e5-4726-9993-6cfcb5c3f49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FD893BED0>]}
[0m19:02:05.107129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45bdd56c-17e5-4726-9993-6cfcb5c3f49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FA32D9B50>]}
[0m19:02:05.112175 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:02:05.549142 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:02:05.707496 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 10 files added, 1 files changed.
[0m19:02:05.709009 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\macros_properties.yml
[0m19:02:05.709577 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dm_monthly)zone_revenue.sql
[0m19:02:05.709577 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\get_payment_type_description.sql
[0m19:02:05.709577 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dim_zones.sql
[0m19:02:05.710649 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\taxi_zone_lookup.csv
[0m19:02:05.710649 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\seeds_properties.yml
[0m19:02:05.711652 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_green_tripdata.sql
[0m19:02:05.711652 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_yellow_tripdata.sql
[0m19:02:05.713008 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\fact_trips.sql
[0m19:02:05.713008 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\schema.yml
[0m19:02:05.714011 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\staging\schema.yaml
[0m19:02:05.714011 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\silver\test.sql
[0m19:02:06.119415 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dm_monthly_zone_revenue' in the 'models' section of file 'models\core\schema.yml'
[0m19:02:06.345221 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  'NoneType' object is not iterable
  
  > in macro test_accepted_values (tests\generic\builtin.sql)
  > called by test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
[0m19:02:06.347784 [debug] [MainThread]: Command `dbt test` failed at 19:02:06.346608 after 2.82 seconds
[0m19:02:06.347784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F9EE46F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDA265FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FA5C63850>]}
[0m19:02:06.348444 [debug] [MainThread]: Flushing usage events
[0m19:02:06.939542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:46.630914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2EF36F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2EF18E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2EF36C210>]}


============================== 19:02:46.635909 | 65759309-75e2-483e-a69a-ed7ee225cf9b ==============================
[0m19:02:46.635909 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:02:46.636900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:02:47.742510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65759309-75e2-483e-a69a-ed7ee225cf9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A0C4C650>]}
[0m19:02:47.779712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65759309-75e2-483e-a69a-ed7ee225cf9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A203BD90>]}
[0m19:02:47.779712 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:02:48.127699 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:02:48.261387 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 10 files added, 1 files changed.
[0m19:02:48.262398 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\taxi_zone_lookup.csv
[0m19:02:48.263396 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\get_payment_type_description.sql
[0m19:02:48.263396 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dim_zones.sql
[0m19:02:48.264381 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\macros_properties.yml
[0m19:02:48.264381 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_yellow_tripdata.sql
[0m19:02:48.264381 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\seeds_properties.yml
[0m19:02:48.265380 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_green_tripdata.sql
[0m19:02:48.265380 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\fact_trips.sql
[0m19:02:48.265380 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\schema.yml
[0m19:02:48.266381 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dm_monthly)zone_revenue.sql
[0m19:02:48.267393 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\staging\schema.yaml
[0m19:02:48.268387 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\silver\test.sql
[0m19:02:48.616606 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dm_monthly_zone_revenue' in the 'models' section of file 'models\core\schema.yml'
[0m19:02:48.807756 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  'NoneType' object is not iterable
  
  > in macro test_accepted_values (tests\generic\builtin.sql)
  > called by test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
[0m19:02:48.809344 [debug] [MainThread]: Command `dbt test` failed at 19:02:48.809344 after 2.25 seconds
[0m19:02:48.810460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2E99E6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2EF3C8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2EF3C8850>]}
[0m19:02:48.810460 [debug] [MainThread]: Flushing usage events
[0m19:02:50.551902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:11.887597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002438D26F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002438D091A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002438BDCA390>]}


============================== 19:05:11.894027 | b7dae423-c8a4-42a6-b90a-7500fe740215 ==============================
[0m19:05:11.894027 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:05:11.894988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:05:13.571862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7dae423-c8a4-42a6-b90a-7500fe740215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243BEE3BD50>]}
[0m19:05:13.608483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7dae423-c8a4-42a6-b90a-7500fe740215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002438B60F9D0>]}
[0m19:05:13.608986 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:05:13.967177 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:05:14.109425 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 10 files added, 1 files changed.
[0m19:05:14.110425 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\get_payment_type_description.sql
[0m19:05:14.110425 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_yellow_tripdata.sql
[0m19:05:14.111430 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_green_tripdata.sql
[0m19:05:14.111430 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\macros_properties.yml
[0m19:05:14.111430 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dim_zones.sql
[0m19:05:14.112431 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\fact_trips.sql
[0m19:05:14.112431 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dm_monthly)zone_revenue.sql
[0m19:05:14.112431 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\seeds_properties.yml
[0m19:05:14.113433 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\taxi_zone_lookup.csv
[0m19:05:14.113433 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\schema.yml
[0m19:05:14.114439 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\staging\schema.yaml
[0m19:05:14.114439 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\silver\test.sql
[0m19:05:14.441460 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dm_monthly_zone_revenue' in the 'models' section of file 'models\core\schema.yml'
[0m19:05:14.624209 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  'NoneType' object is not iterable
  
  > in macro test_accepted_values (tests\generic\builtin.sql)
  > called by test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
[0m19:05:14.626204 [debug] [MainThread]: Command `dbt test` failed at 19:05:14.626204 after 2.84 seconds
[0m19:05:14.626204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243877C6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243C051B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002438D2636D0>]}
[0m19:05:14.626204 [debug] [MainThread]: Flushing usage events
[0m19:05:15.389919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:06:06.319512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A3006EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A2EBD9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A300A3010>]}


============================== 19:06:06.323725 | 6b275d24-0d9f-4e82-88d0-a6845b4d67a8 ==============================
[0m19:06:06.323725 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:06:06.324736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:07.495259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b275d24-0d9f-4e82-88d0-a6845b4d67a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A61F13C10>]}
[0m19:06:07.551245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b275d24-0d9f-4e82-88d0-a6845b4d67a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A2B5D88D0>]}
[0m19:06:07.552244 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:06:07.930286 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:06:08.049027 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 10 files added, 1 files changed.
[0m19:06:08.050031 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\taxi_zone_lookup.csv
[0m19:06:08.050031 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\get_payment_type_description.sql
[0m19:06:08.051037 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_yellow_tripdata.sql
[0m19:06:08.051037 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dm_monthly)zone_revenue.sql
[0m19:06:08.051037 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\seeds_properties.yml
[0m19:06:08.052038 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\fact_trips.sql
[0m19:06:08.052038 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros\macros_properties.yml
[0m19:06:08.053037 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\schema.yml
[0m19:06:08.053037 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\core\dim_zones.sql
[0m19:06:08.054037 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\staging\stg_green_tripdata.sql
[0m19:06:08.054037 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\staging\schema.yaml
[0m19:06:08.055036 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\silver\test.sql
[0m19:06:08.414118 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dm_monthly_zone_revenue' in the 'models' section of file 'models\core\schema.yml'
[0m19:06:08.601640 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  'NoneType' object is not iterable
  
  > in macro test_accepted_values (tests\generic\builtin.sql)
  > called by test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
[0m19:06:08.603652 [debug] [MainThread]: Command `dbt run` failed at 19:06:08.603652 after 2.35 seconds
[0m19:06:08.603652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A2A6A6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A300E2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A2A8BE950>]}
[0m19:06:08.604640 [debug] [MainThread]: Flushing usage events
[0m19:06:09.326552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:08:04.257222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D248F6DF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D248D8DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D248D8DE90>]}


============================== 19:08:04.265391 | 82648346-cdee-474a-b29e-3c779d8c033a ==============================
[0m19:08:04.265391 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:08:04.266401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:08:06.160288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82648346-cdee-474a-b29e-3c779d8c033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D248ADA190>]}
[0m19:08:06.200124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82648346-cdee-474a-b29e-3c779d8c033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D245548390>]}
[0m19:08:06.200124 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:08:06.564509 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:08:06.624587 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:08:06.626586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82648346-cdee-474a-b29e-3c779d8c033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D248A82110>]}
[0m19:08:07.560474 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dm_monthly_zone_revenue' in the 'models' section of file 'models\core\schema.yml'
[0m19:08:07.840473 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' (models\core\schema.yml) depends on a node named 'dm_monthly_zone_revenue' in package '' which was not found
[0m19:08:07.917218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82648346-cdee-474a-b29e-3c779d8c033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27D6F8B50>]}
[0m19:08:07.987438 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:08:08.056074 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:08:08.290342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82648346-cdee-474a-b29e-3c779d8c033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27DAECD90>]}
[0m19:08:08.291341 [info ] [MainThread]: Found 5 models, 1 seed, 10 data tests, 2 sources, 492 macros
[0m19:08:08.291341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82648346-cdee-474a-b29e-3c779d8c033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27D7C92D0>]}
[0m19:08:08.293340 [info ] [MainThread]: 
[0m19:08:08.294341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:08:08.294341 [info ] [MainThread]: 
[0m19:08:08.295342 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:08:08.298870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:08:08.299871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:08.968090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82648346-cdee-474a-b29e-3c779d8c033a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27DAA2DD0>]}
[0m19:08:08.969092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:08.972092 [debug] [Thread-1 (]: Began running node test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:08:08.973105 [info ] [Thread-1 (]: 1 of 10 START test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m19:08:08.973105 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854'
[0m19:08:08.974097 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:08:08.980091 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m19:08:08.982091 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:08:08.999602 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m19:08:09.001607 [debug] [Thread-1 (]: On test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `tough-timing-449701-k0`.`taxi_data`.`stg_green_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m19:08:09.002605 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:08:09.677032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f9b2e694-5a83-483a-9a61-642ef5b7f168&page=queryresults
[0m19:08:09.677032 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f9b2e694-5a83-483a-9a61-642ef5b7f168&page=queryresults
[0m19:08:09.773983 [debug] [Thread-1 (]: Database Error in test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\accepted_values_stg_green_trip_8bd92fa878bbdaa505c8ff907b29c964.sql
[0m19:08:09.774934 [error] [Thread-1 (]: 1 of 10 ERROR accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [[31mERROR[0m in 0.80s]
[0m19:08:09.775932 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:08:09.775932 [debug] [Thread-1 (]: Began running node test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:08:09.776932 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\accepted_values_stg_green_trip_8bd92fa878bbdaa505c8ff907b29c964.sql.
[0m19:08:09.776932 [info ] [Thread-1 (]: 2 of 10 START test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m19:08:09.777931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854, now test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2)
[0m19:08:09.778935 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:08:09.781940 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m19:08:09.782939 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:08:09.784932 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m19:08:09.786937 [debug] [Thread-1 (]: On test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `tough-timing-449701-k0`.`taxi_data`.`stg_yellow_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m19:08:09.786937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:10.361725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:73e49597-487b-49b5-9010-9776f008b60c&page=queryresults
[0m19:08:10.361725 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:73e49597-487b-49b5-9010-9776f008b60c&page=queryresults
[0m19:08:10.364730 [debug] [Thread-1 (]: Database Error in test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\accepted_values_stg_yellow_tri_cdbbfc38b4155ed5a31e452d94d3f501.sql
[0m19:08:10.364730 [error] [Thread-1 (]: 2 of 10 ERROR accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [[31mERROR[0m in 0.59s]
[0m19:08:10.365723 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:08:10.365723 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:08:10.366723 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\accepted_values_stg_yellow_tri_cdbbfc38b4155ed5a31e452d94d3f501.sql.
[0m19:08:10.366723 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_green_tripdata_tripid .......................... [RUN]
[0m19:08:10.367723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2, now test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b)
[0m19:08:10.367723 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:08:10.372724 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m19:08:10.373725 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:08:10.375724 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m19:08:10.376723 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `tough-timing-449701-k0`.`taxi_data`.`stg_green_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m19:08:10.376723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:10.984761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f793b689-ec47-43e5-bd77-b8e3045784e0&page=queryresults
[0m19:08:10.984761 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f793b689-ec47-43e5-bd77-b8e3045784e0&page=queryresults
[0m19:08:10.986751 [debug] [Thread-1 (]: Database Error in test not_null_stg_green_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\not_null_stg_green_tripdata_tripid.sql
[0m19:08:10.988015 [error] [Thread-1 (]: 3 of 10 ERROR not_null_stg_green_tripdata_tripid ............................... [[31mERROR[0m in 0.62s]
[0m19:08:10.989019 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:08:10.989019 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:08:10.989019 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_green_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\not_null_stg_green_tripdata_tripid.sql.
[0m19:08:10.990020 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_yellow_tripdata_tripid ......................... [RUN]
[0m19:08:10.991019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b, now test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c)
[0m19:08:10.991019 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:08:10.994027 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m19:08:10.995018 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:08:10.998019 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m19:08:11.000021 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `tough-timing-449701-k0`.`taxi_data`.`stg_yellow_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m19:08:11.000021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:11.597896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:d2b70199-24fe-4c49-872c-4a0e3350968a&page=queryresults
[0m19:08:11.598885 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:d2b70199-24fe-4c49-872c-4a0e3350968a&page=queryresults
[0m19:08:11.601896 [debug] [Thread-1 (]: Database Error in test not_null_stg_yellow_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\not_null_stg_yellow_tripdata_tripid.sql
[0m19:08:11.601896 [error] [Thread-1 (]: 4 of 10 ERROR not_null_stg_yellow_tripdata_tripid .............................. [[31mERROR[0m in 0.61s]
[0m19:08:11.602886 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:08:11.602886 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:08:11.602886 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_yellow_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\not_null_stg_yellow_tripdata_tripid.sql.
[0m19:08:11.604074 [info ] [Thread-1 (]: 5 of 10 START test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m19:08:11.604074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c, now test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22)
[0m19:08:11.605074 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:08:11.608073 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m19:08:11.609074 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:08:11.610073 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m19:08:11.611074 [debug] [Thread-1 (]: On test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `tough-timing-449701-k0`.`taxi_data`.`stg_green_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:08:11.612074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:12.219625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:87d03c55-6106-42bc-988a-0f6e92988fb6&page=queryresults
[0m19:08:12.220625 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:87d03c55-6106-42bc-988a-0f6e92988fb6&page=queryresults
[0m19:08:12.223624 [debug] [Thread-1 (]: Database Error in test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_green_tripda_6ffcd043789986d1cc6714b458b28cb4.sql
[0m19:08:12.224625 [error] [Thread-1 (]: 5 of 10 ERROR relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[31mERROR[0m in 0.62s]
[0m19:08:12.225625 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:08:12.226626 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:08:12.226626 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_green_tripda_6ffcd043789986d1cc6714b458b28cb4.sql.
[0m19:08:12.227624 [info ] [Thread-1 (]: 6 of 10 START test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m19:08:12.227624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22, now test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e)
[0m19:08:12.228624 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:08:12.231628 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m19:08:12.232629 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:08:12.235628 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m19:08:12.236629 [debug] [Thread-1 (]: On test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `tough-timing-449701-k0`.`taxi_data`.`stg_green_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:08:12.237630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:12.798673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:228d0d8c-9696-4a06-be7b-eafb1752983f&page=queryresults
[0m19:08:12.799674 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:228d0d8c-9696-4a06-be7b-eafb1752983f&page=queryresults
[0m19:08:12.801673 [debug] [Thread-1 (]: Database Error in test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_green_tripda_7e2e9dd76234729b3368d0cbfe7be67e.sql
[0m19:08:12.803176 [error] [Thread-1 (]: 6 of 10 ERROR relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[31mERROR[0m in 0.58s]
[0m19:08:12.804179 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:08:12.804179 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:08:12.805182 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_green_tripda_7e2e9dd76234729b3368d0cbfe7be67e.sql.
[0m19:08:12.805182 [info ] [Thread-1 (]: 7 of 10 START test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m19:08:12.806182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e, now test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f)
[0m19:08:12.807181 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:08:12.812181 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m19:08:12.813182 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:08:12.817183 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m19:08:12.819181 [debug] [Thread-1 (]: On test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `tough-timing-449701-k0`.`taxi_data`.`stg_yellow_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:08:12.819181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:13.489678 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:c851f428-38a2-4733-abc4-ddbb01638c5a&page=queryresults
[0m19:08:13.490183 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:c851f428-38a2-4733-abc4-ddbb01638c5a&page=queryresults
[0m19:08:13.493196 [debug] [Thread-1 (]: Database Error in test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_yellow_tripd_34a330c0bba22ec645770bddd345cbdd.sql
[0m19:08:13.493196 [error] [Thread-1 (]: 7 of 10 ERROR relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[31mERROR[0m in 0.69s]
[0m19:08:13.494712 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:08:13.495722 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:08:13.496724 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_yellow_tripd_34a330c0bba22ec645770bddd345cbdd.sql.
[0m19:08:13.496724 [info ] [Thread-1 (]: 8 of 10 START test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m19:08:13.498230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f, now test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631)
[0m19:08:13.498230 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:08:13.502764 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m19:08:13.503766 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:08:13.505764 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m19:08:13.505764 [debug] [Thread-1 (]: On test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `tough-timing-449701-k0`.`taxi_data`.`stg_yellow_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:08:13.506767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:14.179986 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:b312fc0f-458d-4917-9a84-91011dfb9f7d&page=queryresults
[0m19:08:14.181508 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:b312fc0f-458d-4917-9a84-91011dfb9f7d&page=queryresults
[0m19:08:14.185083 [debug] [Thread-1 (]: Database Error in test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_yellow_tripd_f6d8c8b080a78a51f538240dcc18a2e1.sql
[0m19:08:14.186096 [error] [Thread-1 (]: 8 of 10 ERROR relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[31mERROR[0m in 0.69s]
[0m19:08:14.186605 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:08:14.186605 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:08:14.188053 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_yellow_tripd_f6d8c8b080a78a51f538240dcc18a2e1.sql.
[0m19:08:14.188053 [info ] [Thread-1 (]: 9 of 10 START test unique_stg_green_tripdata_tripid ............................ [RUN]
[0m19:08:14.188053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631, now test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182)
[0m19:08:14.189559 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:08:14.194564 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m19:08:14.196568 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:08:14.199481 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m19:08:14.200488 [debug] [Thread-1 (]: On test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `tough-timing-449701-k0`.`taxi_data`.`stg_green_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:08:14.201493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:14.806433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:a5386f53-7634-4f62-a393-b0fd777df1d6&page=queryresults
[0m19:08:14.807438 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:a5386f53-7634-4f62-a393-b0fd777df1d6&page=queryresults
[0m19:08:14.809569 [debug] [Thread-1 (]: Database Error in test unique_stg_green_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\unique_stg_green_tripdata_tripid.sql
[0m19:08:14.810573 [error] [Thread-1 (]: 9 of 10 ERROR unique_stg_green_tripdata_tripid ................................. [[31mERROR[0m in 0.62s]
[0m19:08:14.811573 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:08:14.811573 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:08:14.812575 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_green_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\unique_stg_green_tripdata_tripid.sql.
[0m19:08:14.813598 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_yellow_tripdata_tripid .......................... [RUN]
[0m19:08:14.814604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182, now test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82)
[0m19:08:14.814604 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:08:14.819380 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m19:08:14.820670 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:08:14.822679 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m19:08:14.823674 [debug] [Thread-1 (]: On test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `tough-timing-449701-k0`.`taxi_data`.`stg_yellow_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:08:14.823674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:15.410914 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:3c0fd5df-3778-4817-a755-d4199ace22c0&page=queryresults
[0m19:08:15.411927 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:3c0fd5df-3778-4817-a755-d4199ace22c0&page=queryresults
[0m19:08:15.414920 [debug] [Thread-1 (]: Database Error in test unique_stg_yellow_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\unique_stg_yellow_tripdata_tripid.sql
[0m19:08:15.414920 [error] [Thread-1 (]: 10 of 10 ERROR unique_stg_yellow_tripdata_tripid ............................... [[31mERROR[0m in 0.60s]
[0m19:08:15.415921 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:08:15.416921 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_yellow_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\unique_stg_yellow_tripdata_tripid.sql.
[0m19:08:15.416921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:15.420696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:15.420696 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:08:15.420696 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82' was properly closed.
[0m19:08:15.422085 [info ] [MainThread]: 
[0m19:08:15.422701 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m19:08:15.424213 [debug] [MainThread]: Command end result
[0m19:08:15.452305 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:08:15.457648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:08:15.464178 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:08:15.464178 [info ] [MainThread]: 
[0m19:08:15.465506 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m19:08:15.467512 [info ] [MainThread]: 
[0m19:08:15.467512 [error] [MainThread]:   Database Error in test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\accepted_values_stg_green_trip_8bd92fa878bbdaa505c8ff907b29c964.sql
[0m19:08:15.467512 [info ] [MainThread]: 
[0m19:08:15.469018 [error] [MainThread]:   Database Error in test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\accepted_values_stg_yellow_tri_cdbbfc38b4155ed5a31e452d94d3f501.sql
[0m19:08:15.469534 [info ] [MainThread]: 
[0m19:08:15.470609 [error] [MainThread]:   Database Error in test not_null_stg_green_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\not_null_stg_green_tripdata_tripid.sql
[0m19:08:15.470609 [info ] [MainThread]: 
[0m19:08:15.470609 [error] [MainThread]:   Database Error in test not_null_stg_yellow_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\not_null_stg_yellow_tripdata_tripid.sql
[0m19:08:15.471767 [info ] [MainThread]: 
[0m19:08:15.472764 [error] [MainThread]:   Database Error in test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_green_tripda_6ffcd043789986d1cc6714b458b28cb4.sql
[0m19:08:15.472764 [info ] [MainThread]: 
[0m19:08:15.473778 [error] [MainThread]:   Database Error in test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_green_tripda_7e2e9dd76234729b3368d0cbfe7be67e.sql
[0m19:08:15.473778 [info ] [MainThread]: 
[0m19:08:15.475043 [error] [MainThread]:   Database Error in test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_yellow_tripd_34a330c0bba22ec645770bddd345cbdd.sql
[0m19:08:15.476054 [info ] [MainThread]: 
[0m19:08:15.476054 [error] [MainThread]:   Database Error in test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\relationships_stg_yellow_tripd_f6d8c8b080a78a51f538240dcc18a2e1.sql
[0m19:08:15.477052 [info ] [MainThread]: 
[0m19:08:15.477052 [error] [MainThread]:   Database Error in test unique_stg_green_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_green_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\unique_stg_green_tripdata_tripid.sql
[0m19:08:15.479091 [info ] [MainThread]: 
[0m19:08:15.479608 [error] [MainThread]:   Database Error in test unique_stg_yellow_tripdata_tripid (models\staging\schema.yaml)
  Not found: Table tough-timing-449701-k0:taxi_data.stg_yellow_tripdata was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\staging\schema.yaml\unique_stg_yellow_tripdata_tripid.sql
[0m19:08:15.479608 [info ] [MainThread]: 
[0m19:08:15.480612 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=10 SKIP=0 TOTAL=10
[0m19:08:15.480612 [debug] [MainThread]: Command `dbt test` failed at 19:08:15.480612 after 11.36 seconds
[0m19:08:15.481998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2445A6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D248FE4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D248FE4AD0>]}
[0m19:08:15.481998 [debug] [MainThread]: Flushing usage events
[0m19:08:17.219856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:16.025335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0BE6FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0BD5B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0BD5BD10>]}


============================== 19:10:16.029334 | bc896d78-db01-4dd1-bff8-497e6626493e ==============================
[0m19:10:16.029334 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:10:16.029842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:10:17.151829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A3E78D050>]}
[0m19:10:17.192322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A093FD990>]}
[0m19:10:17.192322 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:10:17.532510 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:10:17.613495 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:10:17.614700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0B985F50>]}
[0m19:10:18.459849 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dm_monthly_zone_revenue' in the 'models' section of file 'models\core\schema.yml'
[0m19:10:18.609743 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' (models\core\schema.yml) depends on a node named 'dm_monthly_zone_revenue' in package '' which was not found
[0m19:10:18.658102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m19:10:18.666958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A402150D0>]}
[0m19:10:18.732683 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:10:18.735726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:10:18.752186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A40840C50>]}
[0m19:10:18.753317 [info ] [MainThread]: Found 5 models, 1 seed, 10 data tests, 2 sources, 492 macros
[0m19:10:18.753317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A406E3BD0>]}
[0m19:10:18.755076 [info ] [MainThread]: 
[0m19:10:18.756093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:10:18.756093 [info ] [MainThread]: 
[0m19:10:18.757087 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:10:18.759594 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:10:18.759594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:19.262622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:10:19.262622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:19.792649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A40711950>]}
[0m19:10:19.792649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:19.796649 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_zones
[0m19:10:19.797650 [info ] [Thread-1 (]: 1 of 5 START sql table model taxi_data.dim_zones ............................... [RUN]
[0m19:10:19.797650 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.my_dbt_project.dim_zones'
[0m19:10:19.798657 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_zones
[0m19:10:19.802966 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_zones"
[0m19:10:19.804974 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_zones
[0m19:10:19.831903 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_zones"
[0m19:10:19.833877 [debug] [Thread-1 (]: On model.my_dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m19:10:19.834821 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:10:20.497360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:5a4840be-c5f8-474e-8666-663652e454bf&page=queryresults
[0m19:10:20.497681 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:5a4840be-c5f8-474e-8666-663652e454bf&page=queryresults
[0m19:10:20.520324 [debug] [Thread-1 (]: Database Error in model dim_zones (models\core\dim_zones.sql)
  Not found: Table tough-timing-449701-k0:taxi_data.taxi_zone_lookup was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\core\dim_zones.sql
[0m19:10:20.528328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A408203D0>]}
[0m19:10:20.529837 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model taxi_data.dim_zones ...................... [[31mERROR[0m in 0.72s]
[0m19:10:20.530843 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_zones
[0m19:10:20.531953 [debug] [Thread-1 (]: Began running node model.my_dbt_project.stg_green_tripdata
[0m19:10:20.531953 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dim_zones' to be skipped because of status 'error'.  Reason: Database Error in model dim_zones (models\core\dim_zones.sql)
  Not found: Table tough-timing-449701-k0:taxi_data.taxi_zone_lookup was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\core\dim_zones.sql.
[0m19:10:20.531953 [info ] [Thread-1 (]: 2 of 5 START sql view model taxi_data.stg_green_tripdata ....................... [RUN]
[0m19:10:20.533845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.dim_zones, now model.my_dbt_project.stg_green_tripdata)
[0m19:10:20.533845 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.stg_green_tripdata
[0m19:10:20.539509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:10:20.585971 [debug] [Thread-1 (]: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:10:20.586971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A409965D0>]}
[0m19:10:20.587972 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model taxi_data.stg_green_tripdata .............. [[31mERROR[0m in 0.05s]
[0m19:10:20.589476 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.stg_green_tripdata
[0m19:10:20.589476 [debug] [Thread-1 (]: Began running node model.my_dbt_project.stg_yellow_tripdata
[0m19:10:20.590482 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.stg_green_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:10:20.591481 [info ] [Thread-1 (]: 3 of 5 START sql view model taxi_data.stg_yellow_tripdata ...................... [RUN]
[0m19:10:20.592481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.stg_green_tripdata, now model.my_dbt_project.stg_yellow_tripdata)
[0m19:10:20.593480 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.stg_yellow_tripdata
[0m19:10:20.597489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:10:20.599485 [debug] [Thread-1 (]: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:10:20.599485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc896d78-db01-4dd1-bff8-497e6626493e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A409DFA90>]}
[0m19:10:20.600963 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model taxi_data.stg_yellow_tripdata ............. [[31mERROR[0m in 0.01s]
[0m19:10:20.600963 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.stg_yellow_tripdata
[0m19:10:20.601962 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.stg_yellow_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:10:20.602962 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_trips
[0m19:10:20.602962 [info ] [Thread-1 (]: 4 of 5 SKIP relation taxi_data.fact_trips ...................................... [[33mSKIP[0m]
[0m19:10:20.603963 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_trips
[0m19:10:20.603963 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dm_monthly)zone_revenue
[0m19:10:20.604963 [info ] [Thread-1 (]: 5 of 5 SKIP relation taxi_data.dm_monthly)zone_revenue ......................... [[33mSKIP[0m]
[0m19:10:20.604963 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dm_monthly)zone_revenue
[0m19:10:20.605961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:10:20.607962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:20.607962 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:10:20.607962 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:10:20.609478 [debug] [MainThread]: Connection 'model.my_dbt_project.stg_yellow_tripdata' was properly closed.
[0m19:10:20.609478 [info ] [MainThread]: 
[0m19:10:20.609478 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m19:10:20.611055 [debug] [MainThread]: Command end result
[0m19:10:20.631689 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:10:20.633682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:10:20.638688 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:10:20.639681 [info ] [MainThread]: 
[0m19:10:20.639681 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:10:20.640971 [info ] [MainThread]: 
[0m19:10:20.641977 [error] [MainThread]:   Database Error in model dim_zones (models\core\dim_zones.sql)
  Not found: Table tough-timing-449701-k0:taxi_data.taxi_zone_lookup was not found in location us-east1
  compiled code at target\run\my_dbt_project\models\core\dim_zones.sql
[0m19:10:20.641977 [info ] [MainThread]: 
[0m19:10:20.642984 [error] [MainThread]:   Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:10:20.643981 [info ] [MainThread]: 
[0m19:10:20.643981 [error] [MainThread]:   Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:10:20.644974 [info ] [MainThread]: 
[0m19:10:20.644974 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m19:10:20.645974 [debug] [MainThread]: Command `dbt run` failed at 19:10:20.645974 after 4.71 seconds
[0m19:10:20.646973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A07436F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A3E820090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0BEA1650>]}
[0m19:10:20.646973 [debug] [MainThread]: Flushing usage events
[0m19:10:21.487823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:01.676082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E42C6F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E40A22750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E42C6E650>]}


============================== 19:11:01.680601 | 6d9680a4-dccf-4543-889f-677391ef730a ==============================
[0m19:11:01.680601 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:11:01.681593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:02.826800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E7561C650>]}
[0m19:11:02.862487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E402DC090>]}
[0m19:11:02.863489 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:11:03.232538 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:11:03.360520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:11:03.360520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:11:03.365434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m19:11:03.402712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E75C0E090>]}
[0m19:11:03.469020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:11:03.472023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:11:03.547765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E77026850>]}
[0m19:11:03.547765 [info ] [MainThread]: Found 5 models, 1 seed, 10 data tests, 2 sources, 492 macros
[0m19:11:03.550780 [info ] [MainThread]: 
[0m19:11:03.551770 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:11:03.551770 [info ] [MainThread]: 
[0m19:11:03.552771 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:11:03.555778 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:11:03.556771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:05.134159 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:11:05.135159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:05.641851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E75C0C050>]}
[0m19:11:05.642763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:05.645842 [debug] [Thread-1 (]: Began running node model.my_dbt_project.stg_green_tripdata
[0m19:11:05.645842 [info ] [Thread-1 (]: 1 of 16 START sql view model taxi_data.stg_green_tripdata ...................... [RUN]
[0m19:11:05.648456 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.my_dbt_project.stg_green_tripdata'
[0m19:11:05.648456 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.stg_green_tripdata
[0m19:11:05.658178 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:11:05.665270 [debug] [Thread-1 (]: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:11:05.666178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E7751F510>]}
[0m19:11:05.667684 [error] [Thread-1 (]: 1 of 16 ERROR creating sql view model taxi_data.stg_green_tripdata ............. [[31mERROR[0m in 0.02s]
[0m19:11:05.668692 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.stg_green_tripdata
[0m19:11:05.668692 [debug] [Thread-1 (]: Began running node model.my_dbt_project.stg_yellow_tripdata
[0m19:11:05.669690 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.stg_green_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:11:05.670691 [info ] [Thread-1 (]: 2 of 16 START sql view model taxi_data.stg_yellow_tripdata ..................... [RUN]
[0m19:11:05.671690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.stg_green_tripdata, now model.my_dbt_project.stg_yellow_tripdata)
[0m19:11:05.671690 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.stg_yellow_tripdata
[0m19:11:05.678392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:05.681481 [debug] [Thread-1 (]: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:11:05.681481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E77564510>]}
[0m19:11:05.682391 [error] [Thread-1 (]: 2 of 16 ERROR creating sql view model taxi_data.stg_yellow_tripdata ............ [[31mERROR[0m in 0.01s]
[0m19:11:05.683390 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.stg_yellow_tripdata
[0m19:11:05.683390 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.taxi_zone_lookup
[0m19:11:05.683390 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.stg_yellow_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:11:05.684390 [info ] [Thread-1 (]: 3 of 16 START seed file taxi_data.taxi_zone_lookup ............................. [RUN]
[0m19:11:05.685390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.stg_yellow_tripdata, now seed.my_dbt_project.taxi_zone_lookup)
[0m19:11:05.685390 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.taxi_zone_lookup
[0m19:11:05.686408 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.taxi_zone_lookup
[0m19:11:08.979692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:14.775875 [debug] [Thread-1 (]: On seed.my_dbt_project.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "seed.my_dbt_project.taxi_zone_lookup"} */

    alter table `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup` set OPTIONS()
  
[0m19:11:15.031188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:d51660dd-a581-4564-a846-5733d3bba696&page=queryresults
[0m19:11:15.457557 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_dbt_project.taxi_zone_lookup"
[0m19:11:15.472181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E77964F50>]}
[0m19:11:15.472685 [info ] [Thread-1 (]: 3 of 16 OK loaded seed file taxi_data.taxi_zone_lookup ......................... [[32mINSERT 265[0m in 9.79s]
[0m19:11:15.473691 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.taxi_zone_lookup
[0m19:11:15.474691 [debug] [Thread-1 (]: Began running node test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:11:15.474691 [info ] [Thread-1 (]: 4 of 16 SKIP test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [[33mSKIP[0m]
[0m19:11:15.480361 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:11:15.480361 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:11:15.480361 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854' to be skipped because of status 'skipped'. 
[0m19:11:15.481361 [info ] [Thread-1 (]: 5 of 16 SKIP test not_null_stg_green_tripdata_tripid ........................... [[33mSKIP[0m]
[0m19:11:15.481361 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:11:15.482360 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:11:15.482360 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b' to be skipped because of status 'skipped'. 
[0m19:11:15.482360 [info ] [Thread-1 (]: 6 of 16 SKIP test unique_stg_green_tripdata_tripid ............................. [[33mSKIP[0m]
[0m19:11:15.483361 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:11:15.483361 [debug] [Thread-1 (]: Began running node test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:11:15.484361 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182' to be skipped because of status 'skipped'. 
[0m19:11:15.484361 [info ] [Thread-1 (]: 7 of 16 SKIP test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [[33mSKIP[0m]
[0m19:11:15.485360 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:11:15.485360 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:11:15.485360 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2' to be skipped because of status 'skipped'. 
[0m19:11:15.485360 [info ] [Thread-1 (]: 8 of 16 SKIP test not_null_stg_yellow_tripdata_tripid .......................... [[33mSKIP[0m]
[0m19:11:15.486361 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:11:15.487360 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:11:15.487360 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c' to be skipped because of status 'skipped'. 
[0m19:11:15.487360 [info ] [Thread-1 (]: 9 of 16 SKIP test unique_stg_yellow_tripdata_tripid ............................ [[33mSKIP[0m]
[0m19:11:15.488827 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:11:15.488827 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_zones
[0m19:11:15.488827 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82' to be skipped because of status 'skipped'. 
[0m19:11:15.488827 [info ] [Thread-1 (]: 10 of 16 START sql table model taxi_data.dim_zones ............................. [RUN]
[0m19:11:15.490330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.taxi_zone_lookup, now model.my_dbt_project.dim_zones)
[0m19:11:15.490330 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_zones
[0m19:11:15.493345 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_zones"
[0m19:11:15.494342 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_zones
[0m19:11:15.514814 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_zones"
[0m19:11:15.515805 [debug] [Thread-1 (]: On model.my_dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m19:11:15.516809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:16.146636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f824fe7d-4118-4152-83eb-d7059da7a17c&page=queryresults
[0m19:11:18.311264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d9680a4-dccf-4543-889f-677391ef730a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E42C6F710>]}
[0m19:11:18.311264 [info ] [Thread-1 (]: 10 of 16 OK created sql table model taxi_data.dim_zones ........................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.82s]
[0m19:11:18.312491 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_zones
[0m19:11:18.313503 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:11:18.313503 [info ] [Thread-1 (]: 11 of 16 SKIP test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[33mSKIP[0m]
[0m19:11:18.314495 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:11:18.314495 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:11:18.314495 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22' to be skipped because of status 'skipped'. 
[0m19:11:18.315519 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[33mSKIP[0m]
[0m19:11:18.315519 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:11:18.316496 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:11:18.316496 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e' to be skipped because of status 'skipped'. 
[0m19:11:18.316496 [info ] [Thread-1 (]: 13 of 16 SKIP test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[33mSKIP[0m]
[0m19:11:18.317494 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:11:18.317494 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:11:18.317494 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f' to be skipped because of status 'skipped'. 
[0m19:11:18.317494 [info ] [Thread-1 (]: 14 of 16 SKIP test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[33mSKIP[0m]
[0m19:11:18.318528 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:11:18.319527 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631' to be skipped because of status 'skipped'. 
[0m19:11:18.319527 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_trips
[0m19:11:18.320528 [info ] [Thread-1 (]: 15 of 16 SKIP relation taxi_data.fact_trips .................................... [[33mSKIP[0m]
[0m19:11:18.321528 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_trips
[0m19:11:18.322527 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_trips' to be skipped because of status 'skipped'. 
[0m19:11:18.322527 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dm_monthly)zone_revenue
[0m19:11:18.323535 [info ] [Thread-1 (]: 16 of 16 SKIP relation taxi_data.dm_monthly)zone_revenue ....................... [[33mSKIP[0m]
[0m19:11:18.323535 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dm_monthly)zone_revenue
[0m19:11:18.324528 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dm_monthly)zone_revenue' to be skipped because of status 'skipped'. 
[0m19:11:18.325528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:11:18.326527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:11:18.327535 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:11:18.327535 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:11:18.328055 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_zones' was properly closed.
[0m19:11:18.328055 [info ] [MainThread]: 
[0m19:11:18.328055 [info ] [MainThread]: Finished running 1 seed, 3 table models, 10 data tests, 2 view models in 0 hours 0 minutes and 14.78 seconds (14.78s).
[0m19:11:18.329052 [debug] [MainThread]: Command end result
[0m19:11:18.347578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:11:18.350019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:11:18.355019 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:11:18.356013 [info ] [MainThread]: 
[0m19:11:18.356013 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:11:18.357522 [info ] [MainThread]: 
[0m19:11:18.358527 [error] [MainThread]:   Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:11:18.358527 [info ] [MainThread]: 
[0m19:11:18.359527 [error] [MainThread]:   Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:11:18.360537 [info ] [MainThread]: 
[0m19:11:18.360537 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=12 TOTAL=16
[0m19:11:18.362526 [debug] [MainThread]: Command `dbt build` failed at 19:11:18.362526 after 16.77 seconds
[0m19:11:18.362526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E3BE66F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E75CE5C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E75CB8FD0>]}
[0m19:11:18.362526 [debug] [MainThread]: Flushing usage events
[0m19:11:18.953869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:16.976928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C326EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286BE9C2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C326FAD0>]}


============================== 19:12:16.982466 | 93600203-d789-494a-b949-3b3b7b4cdc8c ==============================
[0m19:12:16.982466 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:12:16.983460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:12:18.762005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286F4B0C650>]}
[0m19:12:18.802977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286BE7EA010>]}
[0m19:12:18.804426 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:12:19.204889 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:12:19.356716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:12:19.356716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:12:19.363381 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m19:12:19.412179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286F672A290>]}
[0m19:12:19.506672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:12:19.510932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:12:19.554138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286F6AEB090>]}
[0m19:12:19.554138 [info ] [MainThread]: Found 5 models, 1 seed, 10 data tests, 2 sources, 492 macros
[0m19:12:19.557665 [info ] [MainThread]: 
[0m19:12:19.558660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:19.559664 [info ] [MainThread]: 
[0m19:12:19.560663 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:12:19.563658 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:12:19.564665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:20.101441 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:12:20.102478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:20.602521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286F61F3190>]}
[0m19:12:20.602521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:20.606532 [debug] [Thread-1 (]: Began running node model.my_dbt_project.stg_green_tripdata
[0m19:12:20.607711 [info ] [Thread-1 (]: 1 of 16 START sql view model taxi_data.stg_green_tripdata ...................... [RUN]
[0m19:12:20.608711 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.my_dbt_project.stg_green_tripdata'
[0m19:12:20.608711 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.stg_green_tripdata
[0m19:12:20.620756 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:20.626413 [debug] [Thread-1 (]: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:12:20.628421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286F6B4A510>]}
[0m19:12:20.629421 [error] [Thread-1 (]: 1 of 16 ERROR creating sql view model taxi_data.stg_green_tripdata ............. [[31mERROR[0m in 0.02s]
[0m19:12:20.630422 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.stg_green_tripdata
[0m19:12:20.630422 [debug] [Thread-1 (]: Began running node model.my_dbt_project.stg_yellow_tripdata
[0m19:12:20.630422 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.stg_green_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:12:20.631421 [info ] [Thread-1 (]: 2 of 16 START sql view model taxi_data.stg_yellow_tripdata ..................... [RUN]
[0m19:12:20.632427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.stg_green_tripdata, now model.my_dbt_project.stg_yellow_tripdata)
[0m19:12:20.632427 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.stg_yellow_tripdata
[0m19:12:20.636950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:20.640955 [debug] [Thread-1 (]: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:12:20.641947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286F6B56A90>]}
[0m19:12:20.642947 [error] [Thread-1 (]: 2 of 16 ERROR creating sql view model taxi_data.stg_yellow_tripdata ............ [[31mERROR[0m in 0.01s]
[0m19:12:20.643948 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.stg_yellow_tripdata
[0m19:12:20.643948 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.taxi_zone_lookup
[0m19:12:20.644947 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.stg_yellow_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:12:20.644947 [info ] [Thread-1 (]: 3 of 16 START seed file taxi_data.taxi_zone_lookup ............................. [RUN]
[0m19:12:20.646451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.stg_yellow_tripdata, now seed.my_dbt_project.taxi_zone_lookup)
[0m19:12:20.646451 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.taxi_zone_lookup
[0m19:12:20.647459 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.taxi_zone_lookup
[0m19:12:20.800550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:24.971278 [debug] [Thread-1 (]: On seed.my_dbt_project.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "seed.my_dbt_project.taxi_zone_lookup"} */

    alter table `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup` set OPTIONS()
  
[0m19:12:25.208980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:e27def65-07cf-43e1-8792-7b12fa547927&page=queryresults
[0m19:12:25.595491 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_dbt_project.taxi_zone_lookup"
[0m19:12:25.605701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286F6BD8690>]}
[0m19:12:25.606795 [info ] [Thread-1 (]: 3 of 16 OK loaded seed file taxi_data.taxi_zone_lookup ......................... [[32mINSERT 265[0m in 4.96s]
[0m19:12:25.608407 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.taxi_zone_lookup
[0m19:12:25.608407 [debug] [Thread-1 (]: Began running node test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:12:25.609521 [info ] [Thread-1 (]: 4 of 16 SKIP test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [[33mSKIP[0m]
[0m19:12:25.610499 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:12:25.610499 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:12:25.610499 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854' to be skipped because of status 'skipped'. 
[0m19:12:25.610499 [info ] [Thread-1 (]: 5 of 16 SKIP test not_null_stg_green_tripdata_tripid ........................... [[33mSKIP[0m]
[0m19:12:25.611495 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:12:25.612495 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:12:25.612495 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.not_null_stg_green_tripdata_tripid.3e149d002b' to be skipped because of status 'skipped'. 
[0m19:12:25.612495 [info ] [Thread-1 (]: 6 of 16 SKIP test unique_stg_green_tripdata_tripid ............................. [[33mSKIP[0m]
[0m19:12:25.613500 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:12:25.613500 [debug] [Thread-1 (]: Began running node test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:12:25.614405 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.unique_stg_green_tripdata_tripid.d46e7e4182' to be skipped because of status 'skipped'. 
[0m19:12:25.614405 [info ] [Thread-1 (]: 7 of 16 SKIP test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [[33mSKIP[0m]
[0m19:12:25.615501 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:12:25.615501 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:12:25.616406 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2' to be skipped because of status 'skipped'. 
[0m19:12:25.615501 [info ] [Thread-1 (]: 8 of 16 SKIP test not_null_stg_yellow_tripdata_tripid .......................... [[33mSKIP[0m]
[0m19:12:25.617525 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:12:25.617525 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:12:25.617525 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.not_null_stg_yellow_tripdata_tripid.099802d91c' to be skipped because of status 'skipped'. 
[0m19:12:25.617525 [info ] [Thread-1 (]: 9 of 16 SKIP test unique_stg_yellow_tripdata_tripid ............................ [[33mSKIP[0m]
[0m19:12:25.618527 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:12:25.618527 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dim_zones
[0m19:12:25.619535 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.unique_stg_yellow_tripdata_tripid.7a6ae70c82' to be skipped because of status 'skipped'. 
[0m19:12:25.619535 [info ] [Thread-1 (]: 10 of 16 START sql table model taxi_data.dim_zones ............................. [RUN]
[0m19:12:25.620526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.taxi_zone_lookup, now model.my_dbt_project.dim_zones)
[0m19:12:25.620526 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.dim_zones
[0m19:12:25.622534 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.dim_zones"
[0m19:12:25.623529 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.dim_zones
[0m19:12:25.630692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:26.124757 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.dim_zones"
[0m19:12:26.125768 [debug] [Thread-1 (]: On model.my_dbt_project.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m19:12:26.490586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:8be9b9ac-2131-4282-bab1-7807ae30ac4e&page=queryresults
[0m19:12:28.344802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93600203-d789-494a-b949-3b3b7b4cdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C1644ED0>]}
[0m19:12:28.346306 [info ] [Thread-1 (]: 10 of 16 OK created sql table model taxi_data.dim_zones ........................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.73s]
[0m19:12:28.347314 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dim_zones
[0m19:12:28.347314 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:12:28.349515 [info ] [Thread-1 (]: 11 of 16 SKIP test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[33mSKIP[0m]
[0m19:12:28.357493 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:12:28.358500 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:12:28.358500 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22' to be skipped because of status 'skipped'. 
[0m19:12:28.359499 [info ] [Thread-1 (]: 12 of 16 SKIP test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[33mSKIP[0m]
[0m19:12:28.360500 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:12:28.362498 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:12:28.362498 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e' to be skipped because of status 'skipped'. 
[0m19:12:28.363498 [info ] [Thread-1 (]: 13 of 16 SKIP test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[33mSKIP[0m]
[0m19:12:28.365696 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:12:28.366221 [debug] [Thread-1 (]: Began running node test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:12:28.366738 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f' to be skipped because of status 'skipped'. 
[0m19:12:28.367743 [info ] [Thread-1 (]: 14 of 16 SKIP test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[33mSKIP[0m]
[0m19:12:28.368743 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:12:28.369748 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631' to be skipped because of status 'skipped'. 
[0m19:12:28.370759 [debug] [Thread-1 (]: Began running node model.my_dbt_project.fact_trips
[0m19:12:28.371748 [info ] [Thread-1 (]: 15 of 16 SKIP relation taxi_data.fact_trips .................................... [[33mSKIP[0m]
[0m19:12:28.372750 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.fact_trips
[0m19:12:28.372750 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.fact_trips' to be skipped because of status 'skipped'. 
[0m19:12:28.373749 [debug] [Thread-1 (]: Began running node model.my_dbt_project.dm_monthly)zone_revenue
[0m19:12:28.374748 [info ] [Thread-1 (]: 16 of 16 SKIP relation taxi_data.dm_monthly)zone_revenue ....................... [[33mSKIP[0m]
[0m19:12:28.374748 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.dm_monthly)zone_revenue
[0m19:12:28.375747 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.dm_monthly)zone_revenue' to be skipped because of status 'skipped'. 
[0m19:12:28.376747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:28.378943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:28.378943 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:12:28.379944 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:12:28.379944 [debug] [MainThread]: Connection 'model.my_dbt_project.dim_zones' was properly closed.
[0m19:12:28.380943 [info ] [MainThread]: 
[0m19:12:28.380943 [info ] [MainThread]: Finished running 1 seed, 3 table models, 10 data tests, 2 view models in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m19:12:28.381952 [debug] [MainThread]: Command end result
[0m19:12:28.406471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:12:28.409545 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:12:28.414547 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:12:28.415550 [info ] [MainThread]: 
[0m19:12:28.416546 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:12:28.416546 [info ] [MainThread]: 
[0m19:12:28.417586 [error] [MainThread]:   Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:12:28.417586 [info ] [MainThread]: 
[0m19:12:28.418586 [error] [MainThread]:   Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:12:28.418586 [info ] [MainThread]: 
[0m19:12:28.419587 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=12 TOTAL=16
[0m19:12:28.420586 [debug] [MainThread]: Command `dbt build` failed at 19:12:28.420586 after 11.53 seconds
[0m19:12:28.420586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286BD816F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286BE7D1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286F6915B90>]}
[0m19:12:28.421586 [debug] [MainThread]: Flushing usage events
[0m19:12:29.139960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:39.489123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028989BC6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028989BC7F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028989BC7A50>]}


============================== 19:16:39.492651 | 9c3411d2-93ce-4beb-ba24-414c7264a5de ==============================
[0m19:16:39.492651 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:16:39.493650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:16:39.494642 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m19:16:39.495643 [debug] [MainThread]: Command `dbt run` failed at 19:16:39.495643 after 0.08 seconds
[0m19:16:39.495643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028982CC6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028989B6CDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028989B6D650>]}
[0m19:16:39.496643 [debug] [MainThread]: Flushing usage events
[0m19:16:41.211614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:16.750888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BBDC6FC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BBDC6FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BBDC6DC90>]}


============================== 19:18:16.756351 | 5e08348a-c091-4da4-ab42-81b7020c24fe ==============================
[0m19:18:16.756351 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:18:16.756351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:16.759351 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'profiles'
[0m19:18:16.759351 [debug] [MainThread]: Command `dbt run` failed at 19:18:16.759351 after 0.11 seconds
[0m19:18:16.760855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB6E06F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BBDC6EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BB942E950>]}
[0m19:18:16.760855 [debug] [MainThread]: Flushing usage events
[0m19:18:18.072993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:24.098905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBABA6C890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBABA6E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBABA6F8D0>]}


============================== 19:18:24.103301 | 3242ab79-ea2c-439d-8207-f7b05123c295 ==============================
[0m19:18:24.103301 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:18:24.104297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:24.107305 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'profiles.yml'
[0m19:18:24.107305 [debug] [MainThread]: Command `dbt run` failed at 19:18:24.107305 after 0.10 seconds
[0m19:18:24.108554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBABAC5C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA6FA6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBABAE7FD0>]}
[0m19:18:24.108554 [debug] [MainThread]: Flushing usage events
[0m19:18:24.777560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:36.985660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D186C3F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1866F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1866F190>]}


============================== 19:18:36.990756 | 76055f99-cff6-473f-99ed-65d02a8b39c8 ==============================
[0m19:18:36.990756 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:18:36.991791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:38.668660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4B56DF90>]}
[0m19:18:38.716657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D13BF8850>]}
[0m19:18:38.717654 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:18:39.171991 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:18:39.253067 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:18:39.254070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D18186110>]}
[0m19:18:40.184213 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dm_monthly_zone_revenue' in the 'models' section of file 'models\core\schema.yml'
[0m19:18:40.368187 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' (models\core\schema.yml) depends on a node named 'dm_monthly_zone_revenue' in package '' which was not found
[0m19:18:40.439754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4BBDA1D0>]}
[0m19:18:40.506956 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:18:40.509915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:18:40.535422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4D085B90>]}
[0m19:18:40.535422 [info ] [MainThread]: Found 5 models, 1 seed, 10 data tests, 2 sources, 492 macros
[0m19:18:40.536422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4BF04390>]}
[0m19:18:40.537438 [info ] [MainThread]: 
[0m19:18:40.538434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:40.538434 [info ] [MainThread]: 
[0m19:18:40.539518 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:18:40.541524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:18:40.542528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:41.216017 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:18:41.216520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:41.755427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4D00FD90>]}
[0m19:18:41.755427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:41.763465 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m19:18:41.764885 [info ] [Thread-1 (]: 1 of 5 START sql table model taxi_data.dim_zones ............................... [RUN]
[0m19:18:41.766779 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.dim_zones'
[0m19:18:41.766779 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m19:18:41.772304 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m19:18:41.773314 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m19:18:41.785024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:18:42.346491 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m19:18:42.348502 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m19:18:42.794166 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:e8f5957c-cf0d-4d7e-b933-e44e6abe13e6&page=queryresults
[0m19:18:44.844462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4BEC2890>]}
[0m19:18:44.845459 [info ] [Thread-1 (]: 1 of 5 OK created sql table model taxi_data.dim_zones .......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.08s]
[0m19:18:44.846462 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m19:18:44.846462 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m19:18:44.847465 [info ] [Thread-1 (]: 2 of 5 START sql view model taxi_data.stg_green_tripdata ....................... [RUN]
[0m19:18:44.847465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now model.taxi_rides_ny.stg_green_tripdata)
[0m19:18:44.848465 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m19:18:44.856174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:44.862868 [debug] [Thread-1 (]: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:18:44.863884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4D41B150>]}
[0m19:18:44.864500 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model taxi_data.stg_green_tripdata .............. [[31mERROR[0m in 0.02s]
[0m19:18:44.865581 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m19:18:44.865581 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:18:44.866596 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.stg_green_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:18:44.866596 [info ] [Thread-1 (]: 3 of 5 START sql view model taxi_data.stg_yellow_tripdata ...................... [RUN]
[0m19:18:44.867581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m19:18:44.868588 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:18:44.873903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:44.875860 [debug] [Thread-1 (]: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:18:44.875860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76055f99-cff6-473f-99ed-65d02a8b39c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D4D029850>]}
[0m19:18:44.876910 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model taxi_data.stg_yellow_tripdata ............. [[31mERROR[0m in 0.01s]
[0m19:18:44.877855 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:18:44.877855 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.stg_yellow_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:18:44.878855 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m19:18:44.878855 [info ] [Thread-1 (]: 4 of 5 SKIP relation taxi_data.fact_trips ...................................... [[33mSKIP[0m]
[0m19:18:44.879856 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m19:18:44.881367 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dm_monthly)zone_revenue
[0m19:18:44.881367 [info ] [Thread-1 (]: 5 of 5 SKIP relation taxi_data.dm_monthly)zone_revenue ......................... [[33mSKIP[0m]
[0m19:18:44.881869 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dm_monthly)zone_revenue
[0m19:18:44.883379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:44.885376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:44.885882 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:18:44.885882 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:18:44.885882 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
[0m19:18:44.886890 [info ] [MainThread]: 
[0m19:18:44.888010 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m19:18:44.889020 [debug] [MainThread]: Command end result
[0m19:18:44.912182 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:18:44.915123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:18:44.920509 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:18:44.921547 [info ] [MainThread]: 
[0m19:18:44.922667 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:18:44.923665 [info ] [MainThread]: 
[0m19:18:44.923665 [error] [MainThread]:   Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:18:44.924744 [info ] [MainThread]: 
[0m19:18:44.925668 [error] [MainThread]:   Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:18:44.925668 [info ] [MainThread]: 
[0m19:18:44.926664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=2 TOTAL=5
[0m19:18:44.927538 [debug] [MainThread]: Command `dbt run` failed at 19:18:44.927538 after 8.04 seconds
[0m19:18:44.928552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D186C5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D12C26F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D12EBB810>]}
[0m19:18:44.929543 [debug] [MainThread]: Flushing usage events
[0m19:18:45.542893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:16.194683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B26C6F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B26CC9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B26C6FC90>]}


============================== 19:19:16.199724 | 5795ab50-def6-440b-9fe7-4e93484dcc4c ==============================
[0m19:19:16.199724 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:19:16.200641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:17.317445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5795ab50-def6-440b-9fe7-4e93484dcc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B595D8F10>]}
[0m19:19:17.359420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5795ab50-def6-440b-9fe7-4e93484dcc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B242DDA90>]}
[0m19:19:17.360926 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:19:17.730563 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:19:17.867943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:17.868944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:17.910637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5795ab50-def6-440b-9fe7-4e93484dcc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5B0EFB90>]}
[0m19:19:17.979993 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:19:17.983499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:19:18.003523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5795ab50-def6-440b-9fe7-4e93484dcc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5B2D4090>]}
[0m19:19:18.003523 [info ] [MainThread]: Found 5 models, 1 seed, 10 data tests, 2 sources, 492 macros
[0m19:19:18.005523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5795ab50-def6-440b-9fe7-4e93484dcc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B59C5F210>]}
[0m19:19:18.007523 [info ] [MainThread]: 
[0m19:19:18.007523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:18.008523 [info ] [MainThread]: 
[0m19:19:18.008523 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:19:18.012126 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:19:18.012126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:18.486917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5795ab50-def6-440b-9fe7-4e93484dcc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5B0FC410>]}
[0m19:19:18.486917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:18.490925 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m19:19:18.492497 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_green_tripdata'
[0m19:19:18.492497 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m19:19:18.503657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:18.507653 [debug] [Thread-1 (]: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:19:18.507653 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m19:19:18.508646 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:19:18.508646 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.stg_green_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:19:18.509646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m19:19:18.510656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:18.511174 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:19:18.511174 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:19:18.516179 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
[0m19:19:18.516179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:18.517172 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model stg_green_tripdata (models\staging\stg_green_tripdata.sql)
    'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:19:18.519173 [debug] [Thread-1 (]: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:19:18.519173 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:19:18.519173 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m19:19:18.520686 [debug] [MainThread]: Command `dbt compile` failed at 19:19:18.519173 after 2.38 seconds
[0m19:19:18.520686 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.stg_yellow_tripdata' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m19:19:18.520686 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.taxi_rides_ny.taxi_zone_lookup'
[0m19:19:18.521697 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m19:19:18.521697 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m19:19:18.522705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:18.524704 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m19:19:18.525704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B1FE36F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5B3F2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5B38CED0>]}
[0m19:19:18.526695 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m19:19:18.526695 [debug] [MainThread]: Flushing usage events
[0m19:19:19.261768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:20:56.728839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99956F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D999563DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99956E810>]}


============================== 19:20:56.734209 | 092d4052-c230-49b7-9b6a-c6d01e7450b1 ==============================
[0m19:20:56.734209 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:20:56.734209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:20:56.860239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '092d4052-c230-49b7-9b6a-c6d01e7450b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99956D550>]}
[0m19:20:56.988684 [debug] [MainThread]: Set downloads directory='C:\Users\watan\AppData\Local\Temp\dbt-downloads-cr8554k4'
[0m19:20:56.988684 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:20:57.718313 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:20:57.718313 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:20:57.753312 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:20:57.757320 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m19:20:57.806498 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m19:20:57.815323 [info ] [MainThread]: Updating lock file in file path: C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04/package-lock.yml
[0m19:20:57.825368 [debug] [MainThread]: Set downloads directory='C:\Users\watan\AppData\Local\Temp\dbt-downloads-molj74qc'
[0m19:20:57.827674 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:20:59.038440 [error] [MainThread]: Encountered an error:
[WinError 32] O arquivo já está sendo usado por outro processo: 'dbt_packages\\dbt-utils-1.1.1'
[0m19:20:59.088112 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\shutil.py", line 853, in move
    os.rename(src, real_dst)
PermissionError: [WinError 5] Acesso negado: 'dbt_packages\\dbt-utils-1.1.1' -> 'dbt_packages\\dbt_utils'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\cli\main.py", line 455, in deps
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\task\deps.py", line 254, in run
    package.install(self.project, renderer)
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\deps\registry.py", line 63, in install
    self._install(project, renderer)
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\deps\base.py", line 121, in _install
    connection_exception_retry(download_untar_fn, 5)
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt_common\utils\connection.py", line 21, in connection_exception_retry
    return fn()
           ^^^^
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt\deps\base.py", line 133, in download_and_untar
    system.untar_package(tar_path, deps_path, package_name)
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt_common\clients\system.py", line 646, in untar_package
    dbt_common.clients.system.rename(downloaded_path, desired_path, force=True)
  File "C:\Users\watan\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\dbt_common\clients\system.py", line 609, in rename
    shutil.move(from_path, to_path)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\shutil.py", line 871, in move
    rmtree(src)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\shutil.py", line 638, in _rmtree_unsafe
    onerror(os.rmdir, path, sys.exc_info())
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\shutil.py", line 636, in _rmtree_unsafe
    os.rmdir(path)
PermissionError: [WinError 32] O arquivo já está sendo usado por outro processo: 'dbt_packages\\dbt-utils-1.1.1'

[0m19:20:59.090629 [debug] [MainThread]: Command `dbt deps` failed at 19:20:59.089619 after 2.45 seconds
[0m19:20:59.090629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D993B96F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9995E7F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9995E7B10>]}
[0m19:20:59.091630 [debug] [MainThread]: Flushing usage events
[0m19:20:59.880339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:26.822764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D293D6FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D293D6E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D293D6EFD0>]}


============================== 19:21:26.827776 | 62921e07-d4f7-43e6-a861-9c4012fb73bb ==============================
[0m19:21:26.827776 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:21:26.828779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:21:26.951295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62921e07-d4f7-43e6-a861-9c4012fb73bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D293DEE090>]}
[0m19:21:27.015531 [debug] [MainThread]: Set downloads directory='C:\Users\watan\AppData\Local\Temp\dbt-downloads-y8879toz'
[0m19:21:27.015531 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:21:27.084721 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:21:27.085719 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:21:27.139511 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:21:27.142522 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m19:21:27.526342 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m19:21:27.528342 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:21:27.941057 [info ] [MainThread]: Installed from version 1.1.1
[0m19:21:27.942062 [info ] [MainThread]: Updated version available: 1.3.0
[0m19:21:27.943069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '62921e07-d4f7-43e6-a861-9c4012fb73bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D293DC37D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D293DC69D0>]}
[0m19:21:27.943069 [info ] [MainThread]: Installing dbt-labs/codegen
[0m19:21:28.218666 [info ] [MainThread]: Installed from version 0.12.1
[0m19:21:28.219668 [info ] [MainThread]: Updated version available: 0.13.1
[0m19:21:28.219668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '62921e07-d4f7-43e6-a861-9c4012fb73bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2931BDE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D293DC4710>]}
[0m19:21:28.220985 [info ] [MainThread]: 
[0m19:21:28.220985 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m19:21:28.223517 [debug] [MainThread]: Command `dbt deps` succeeded at 19:21:28.223011 after 1.50 seconds
[0m19:21:28.223517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D28CEB6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D28F5CB7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D28F54E910>]}
[0m19:21:28.223517 [debug] [MainThread]: Flushing usage events
[0m19:21:28.810058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:51.404408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9686DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9686FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9686F210>]}


============================== 19:21:51.408406 | 754de923-ccca-4e83-a809-47b623804343 ==============================
[0m19:21:51.408406 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:21:51.409909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:21:53.205300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9686C210>]}
[0m19:21:53.246176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF91E69F90>]}
[0m19:21:53.247177 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:21:53.639979 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:21:53.722771 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:21:53.724690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF96386090>]}
[0m19:21:55.248032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC9FDB0D0>]}
[0m19:21:55.314399 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:21:55.317396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:21:55.338390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCA145D90>]}
[0m19:21:55.339894 [info ] [MainThread]: Found 5 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m19:21:55.339894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF910AF650>]}
[0m19:21:55.341926 [info ] [MainThread]: 
[0m19:21:55.341926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:21:55.342923 [info ] [MainThread]: 
[0m19:21:55.343920 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:21:55.347921 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:21:55.347921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:55.873174 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:21:55.873174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:56.361107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCA373B90>]}
[0m19:21:56.362012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:21:56.371632 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m19:21:56.372716 [info ] [Thread-1 (]: 1 of 5 START sql table model taxi_data.dim_zones ............................... [RUN]
[0m19:21:56.374773 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.dim_zones'
[0m19:21:56.374773 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m19:21:56.380418 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m19:21:56.380418 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m19:21:56.391920 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:21:56.885268 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m19:21:56.886270 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m19:21:57.295121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:8dd6f043-9d73-4d97-9564-1aa492801c9d&page=queryresults
[0m19:21:59.297338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCA36F190>]}
[0m19:21:59.299923 [info ] [Thread-1 (]: 1 of 5 OK created sql table model taxi_data.dim_zones .......................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.92s]
[0m19:21:59.301791 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m19:21:59.302801 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m19:21:59.303802 [info ] [Thread-1 (]: 2 of 5 START sql view model taxi_data.stg_green_tripdata ....................... [RUN]
[0m19:21:59.305969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now model.taxi_rides_ny.stg_green_tripdata)
[0m19:21:59.305969 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m19:21:59.313499 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m19:21:59.315498 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m19:21:59.331526 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m19:21:59.333527 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100

;


[0m19:21:59.334538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:00.050360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:ff4bad5f-c269-4e5a-9d55-fa664ee12aad&page=queryresults
[0m19:22:00.440023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC9D60F50>]}
[0m19:22:00.441030 [info ] [Thread-1 (]: 2 of 5 OK created sql view model taxi_data.stg_green_tripdata .................. [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m19:22:00.442035 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m19:22:00.442035 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:22:00.443034 [info ] [Thread-1 (]: 3 of 5 START sql view model taxi_data.stg_yellow_tripdata ...................... [RUN]
[0m19:22:00.443034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m19:22:00.444047 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:22:00.448034 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m19:22:00.449033 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:22:00.452047 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m19:22:00.452047 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m19:22:00.453047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:01.056444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:75845d17-478e-41b4-b499-5144a7291c20&page=queryresults
[0m19:22:01.450942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCA7E1210>]}
[0m19:22:01.451942 [info ] [Thread-1 (]: 3 of 5 OK created sql view model taxi_data.stg_yellow_tripdata ................. [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m19:22:01.452947 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:22:01.452947 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m19:22:01.453946 [info ] [Thread-1 (]: 4 of 5 START sql table model taxi_data.fact_trips .............................. [RUN]
[0m19:22:01.453946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now model.taxi_rides_ny.fact_trips)
[0m19:22:01.454949 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m19:22:01.457948 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m19:22:01.459947 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m19:22:01.465472 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m19:22:01.466469 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m19:22:01.466469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:02.469728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:93f0b4aa-536e-44a5-a336-d41d3dc79301&page=queryresults
[0m19:22:10.155604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCA727B50>]}
[0m19:22:10.157023 [info ] [Thread-1 (]: 4 of 5 OK created sql table model taxi_data.fact_trips ......................... [[32mCREATE TABLE (196.0 rows, 19.4 GiB processed)[0m in 8.70s]
[0m19:22:10.157527 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m19:22:10.158996 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:22:10.159800 [info ] [Thread-1 (]: 5 of 5 START sql table model taxi_data.dm_monthly_zone_revenue ................. [RUN]
[0m19:22:10.160423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fact_trips, now model.taxi_rides_ny.dm_monthly_zone_revenue)
[0m19:22:10.161428 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:22:10.164457 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
[0m19:22:10.165456 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:22:10.168459 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
[0m19:22:10.169965 [debug] [Thread-1 (]: On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data`.`dm_monthly_zone_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips_data as (
    select * from `tough-timing-449701-k0`.`taxi_data`.`fact_trips`
)
    select 
    -- Revenue grouping 
    pickup_zone as revenue_zone,
    timestamp_trunc(
        cast(pickup_datetime as timestamp),
        month
    ) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

    from trips_data
    group by 1,2,3
    );
  
[0m19:22:10.170972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:11.261748 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:259f4304-ec9e-4b08-96e4-62dd9b255da3&page=queryresults
[0m19:22:13.106605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '754de923-ccca-4e83-a809-47b623804343', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFCA7346D0>]}
[0m19:22:13.107605 [info ] [Thread-1 (]: 5 of 5 OK created sql table model taxi_data.dm_monthly_zone_revenue ............ [[32mCREATE TABLE (89.0 rows, 40.5 KiB processed)[0m in 2.95s]
[0m19:22:13.107605 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:22:13.109606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:22:13.111121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:13.111121 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:22:13.112123 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:22:13.112123 [debug] [MainThread]: Connection 'model.taxi_rides_ny.dm_monthly_zone_revenue' was properly closed.
[0m19:22:13.112123 [info ] [MainThread]: 
[0m19:22:13.113123 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 17.77 seconds (17.77s).
[0m19:22:13.114123 [debug] [MainThread]: Command end result
[0m19:22:13.142235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:22:13.146235 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:22:13.152434 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:22:13.152434 [info ] [MainThread]: 
[0m19:22:13.153943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:22:13.154950 [info ] [MainThread]: 
[0m19:22:13.154950 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:22:13.155950 [debug] [MainThread]: Command `dbt run` succeeded at 19:22:13.155950 after 21.82 seconds
[0m19:22:13.156951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF90E96F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF968E7E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF9112B7D0>]}
[0m19:22:13.156951 [debug] [MainThread]: Flushing usage events
[0m19:22:13.963886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:58.789852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0DF6F450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0DF6F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0DF6F650>]}


============================== 19:23:58.794317 | e2e3203b-8d52-4845-8481-73fd063a9e43 ==============================
[0m19:23:58.794317 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:23:58.795323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:24:00.321876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0B93E990>]}
[0m19:24:00.366380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0D313950>]}
[0m19:24:00.367380 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:24:00.784173 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:24:00.886998 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:24:00.887999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0DA85FD0>]}
[0m19:24:02.423831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC42793A10>]}
[0m19:24:02.510842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:24:02.515846 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:24:02.559808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC42B5B410>]}
[0m19:24:02.560822 [info ] [MainThread]: Found 5 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m19:24:02.563813 [info ] [MainThread]: 
[0m19:24:02.564821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:02.565812 [info ] [MainThread]: 
[0m19:24:02.565812 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:24:02.570320 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:24:02.570320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:03.141559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:03.616849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:04.117478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0, now create_tough-timing-449701-k0_taxi_data_staging)
[0m19:24:04.118472 [debug] [ThreadPool]: Creating schema "database: "tough-timing-449701-k0"
schema: "taxi_data_staging"
"
[0m19:24:04.125668 [debug] [ThreadPool]: On create_tough-timing-449701-k0_taxi_data_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "create_tough-timing-449701-k0_taxi_data_staging"} */
create schema if not exists `tough-timing-449701-k0`.`taxi_data_staging`
  
[0m19:24:04.126191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:04.670487 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:bffb24b3-81f5-4925-ad46-b470a0ff9498&page=queryresults
[0m19:24:06.091398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_tough-timing-449701-k0_taxi_data_staging, now create_tough-timing-449701-k0_taxi_data_core)
[0m19:24:06.092393 [debug] [ThreadPool]: Creating schema "database: "tough-timing-449701-k0"
schema: "taxi_data_core"
"
[0m19:24:06.094394 [debug] [ThreadPool]: On create_tough-timing-449701-k0_taxi_data_core: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "create_tough-timing-449701-k0_taxi_data_core"} */
create schema if not exists `tough-timing-449701-k0`.`taxi_data_core`
  
[0m19:24:06.094394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:06.847480 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:00a3df4b-5a39-4320-a745-ab2c211102d0&page=queryresults
[0m19:24:08.173824 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:24:08.174824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:08.818661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m19:24:08.827662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:09.370323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m19:24:09.371456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:09.872123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4292B9D0>]}
[0m19:24:09.873120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:09.877120 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m19:24:09.878122 [info ] [Thread-1 (]: 1 of 17 START sql view model taxi_data_staging.stg_green_tripdata .............. [RUN]
[0m19:24:09.879120 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.stg_green_tripdata'
[0m19:24:09.879120 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m19:24:09.887639 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m19:24:09.887639 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m19:24:09.911641 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m19:24:09.913634 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100

;


[0m19:24:09.913634 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:10.599556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f4a73765-3317-49c9-a500-e29d8addb1e5&page=queryresults
[0m19:24:11.024503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC42F94890>]}
[0m19:24:11.025499 [info ] [Thread-1 (]: 1 of 17 OK created sql view model taxi_data_staging.stg_green_tripdata ......... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m19:24:11.026503 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m19:24:11.026503 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:24:11.027502 [info ] [Thread-1 (]: 2 of 17 START sql view model taxi_data_staging.stg_yellow_tripdata ............. [RUN]
[0m19:24:11.028507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m19:24:11.028507 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:24:11.033498 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m19:24:11.034500 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:24:11.037498 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m19:24:11.038503 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m19:24:11.038503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:11.721783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:c4ccf048-574d-4040-a96f-1746f85d5a05&page=queryresults
[0m19:24:12.088096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC422FFE50>]}
[0m19:24:12.088096 [info ] [Thread-1 (]: 2 of 17 OK created sql view model taxi_data_staging.stg_yellow_tripdata ........ [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m19:24:12.089096 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:24:12.089096 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m19:24:12.090305 [info ] [Thread-1 (]: 3 of 17 START seed file taxi_data.taxi_zone_lookup ............................. [RUN]
[0m19:24:12.091308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m19:24:12.091308 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m19:24:12.091308 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m19:24:12.107307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:16.595375 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup` set OPTIONS()
  
[0m19:24:16.833538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:a8500c06-dcab-4717-a0b8-6b20c48021fa&page=queryresults
[0m19:24:17.208730 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m19:24:17.211729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC42FB5310>]}
[0m19:24:17.211729 [info ] [Thread-1 (]: 3 of 17 OK loaded seed file taxi_data.taxi_zone_lookup ......................... [[32mINSERT 265[0m in 5.12s]
[0m19:24:17.212721 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m19:24:17.212721 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:24:17.213721 [info ] [Thread-1 (]: 4 of 17 START test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m19:24:17.214722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854)
[0m19:24:17.214722 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:24:17.217720 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m19:24:17.218720 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:24:17.227807 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m19:24:17.229722 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m19:24:17.229722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:18.723103 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:2ffc56f1-478b-4398-aceb-389cf1016ba6&page=queryresults
[0m19:24:19.339045 [info ] [Thread-1 (]: 4 of 17 PASS accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 2.12s]
[0m19:24:19.340037 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m19:24:19.340037 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:24:19.340037 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_green_tripdata_tripid .......................... [RUN]
[0m19:24:19.341315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854, now test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b)
[0m19:24:19.341315 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:24:19.346320 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m19:24:19.347320 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:24:19.348321 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m19:24:19.349320 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m19:24:19.349320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:20.982697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:59f50fba-1a78-4055-bb6a-06f8eb763b87&page=queryresults
[0m19:24:21.601872 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_green_tripdata_tripid ................................ [[32mPASS[0m in 2.26s]
[0m19:24:21.603909 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
[0m19:24:21.603909 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:24:21.604830 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_green_tripdata_tripid ............................ [RUN]
[0m19:24:21.604830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b, now test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182)
[0m19:24:21.605829 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:24:21.609845 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m19:24:21.610842 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:24:21.613836 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m19:24:21.614828 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:24:21.614828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:23.145214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:e73287b6-fdb3-4579-bc24-bd5d37b547a9&page=queryresults
[0m19:24:23.749168 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_green_tripdata_tripid .................................. [[32mPASS[0m in 2.14s]
[0m19:24:23.751251 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
[0m19:24:23.751251 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:24:23.752159 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m19:24:23.752159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182, now test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2)
[0m19:24:23.753159 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:24:23.757158 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m19:24:23.758163 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:24:23.759161 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m19:24:23.760161 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m19:24:23.761158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:25.774376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:43c4ac26-1b3c-4a42-a5b6-431e81c8e6ef&page=queryresults
[0m19:24:27.060035 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 3.31s]
[0m19:24:27.061033 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m19:24:27.061033 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:24:27.062038 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_yellow_tripdata_tripid ......................... [RUN]
[0m19:24:27.063039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2, now test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c)
[0m19:24:27.063039 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:24:27.066539 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m19:24:27.066539 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:24:27.068538 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m19:24:27.069540 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m19:24:27.069540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:29.293459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:c37ed30a-b122-443c-975f-66848c165289&page=queryresults
[0m19:24:29.952150 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_yellow_tripdata_tripid ............................... [[32mPASS[0m in 2.89s]
[0m19:24:29.953151 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m19:24:29.953151 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:24:29.954465 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_yellow_tripdata_tripid ........................... [RUN]
[0m19:24:29.954465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c, now test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82)
[0m19:24:29.955470 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:24:29.958554 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m19:24:29.959558 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:24:29.963484 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m19:24:29.964471 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:24:29.965470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:31.975722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:38429506-6a80-4d00-8743-b621d0a17004&page=queryresults
[0m19:24:32.621517 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_yellow_tripdata_tripid ................................. [[32mPASS[0m in 2.67s]
[0m19:24:32.623529 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m19:24:32.623529 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m19:24:32.624528 [info ] [Thread-1 (]: 10 of 17 START sql table model taxi_data_core.dim_zones ........................ [RUN]
[0m19:24:32.625528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82, now model.taxi_rides_ny.dim_zones)
[0m19:24:32.626528 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m19:24:32.630071 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m19:24:32.631252 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m19:24:32.649153 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m19:24:32.651153 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m19:24:32.651153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:33.323271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:78f771d9-80a4-48a8-9f33-796b6baa6d06&page=queryresults
[0m19:24:35.423443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0B213050>]}
[0m19:24:35.424449 [info ] [Thread-1 (]: 10 of 17 OK created sql table model taxi_data_core.dim_zones ................... [[32mCREATE TABLE (265.0 rows, 14.2 KiB processed)[0m in 2.80s]
[0m19:24:35.426459 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m19:24:35.427458 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:24:35.427458 [info ] [Thread-1 (]: 11 of 17 START test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m19:24:35.429440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22)
[0m19:24:35.430857 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:24:35.436212 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m19:24:35.436718 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:24:35.438731 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m19:24:35.439732 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:35.439732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:36.892126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:cc601487-4f52-4145-988d-66f9ec3b5c81&page=queryresults
[0m19:24:37.506475 [info ] [Thread-1 (]: 11 of 17 PASS relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.08s]
[0m19:24:37.507498 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m19:24:37.507498 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:24:37.508521 [info ] [Thread-1 (]: 12 of 17 START test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m19:24:37.508521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22, now test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e)
[0m19:24:37.509648 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:24:37.512656 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m19:24:37.513583 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:24:37.514634 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m19:24:37.515616 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:37.516530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:39.106296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:164b5abf-325f-48db-9566-d95436097621&page=queryresults
[0m19:24:39.756075 [info ] [Thread-1 (]: 12 of 17 PASS relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 2.25s]
[0m19:24:39.757066 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m19:24:39.758066 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:24:39.758066 [info ] [Thread-1 (]: 13 of 17 START test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m19:24:39.759777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e, now test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f)
[0m19:24:39.760283 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:24:39.764290 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m19:24:39.764290 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:24:39.767140 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m19:24:39.767140 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:39.768385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:41.914478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:0633fcf8-89e4-4b29-8d8d-aa054f767151&page=queryresults
[0m19:24:42.873341 [info ] [Thread-1 (]: 13 of 17 PASS relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 3.11s]
[0m19:24:42.874345 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m19:24:42.874345 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:24:42.874345 [info ] [Thread-1 (]: 14 of 17 START test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m19:24:42.875491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f, now test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631)
[0m19:24:42.875491 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:24:42.879499 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m19:24:42.880596 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:24:42.883339 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m19:24:42.884340 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:24:42.885340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:44.892676 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:32a2b973-33db-41ff-ab2c-8dc276e93207&page=queryresults
[0m19:24:45.950943 [info ] [Thread-1 (]: 14 of 17 PASS relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 3.08s]
[0m19:24:45.952260 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m19:24:45.954267 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m19:24:45.955266 [info ] [Thread-1 (]: 15 of 17 START sql table model taxi_data_core.fact_trips ....................... [RUN]
[0m19:24:45.955774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631, now model.taxi_rides_ny.fact_trips)
[0m19:24:45.955774 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m19:24:45.958780 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m19:24:45.959783 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m19:24:45.961780 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m19:24:45.962781 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m19:24:45.963781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:47.303789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:a94425d2-0472-469d-94a5-02bd46881112&page=queryresults
[0m19:24:54.606929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC42F0B310>]}
[0m19:24:54.607844 [info ] [Thread-1 (]: 15 of 17 OK created sql table model taxi_data_core.fact_trips .................. [[32mCREATE TABLE (196.0 rows, 19.4 GiB processed)[0m in 8.65s]
[0m19:24:54.608844 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m19:24:54.609843 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:24:54.609843 [info ] [Thread-1 (]: 16 of 17 START sql table model taxi_data_core.dm_monthly_zone_revenue .......... [RUN]
[0m19:24:54.610844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fact_trips, now model.taxi_rides_ny.dm_monthly_zone_revenue)
[0m19:24:54.610844 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:24:54.613370 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
[0m19:24:54.614377 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:24:54.616369 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
[0m19:24:54.617371 [debug] [Thread-1 (]: On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`dm_monthly_zone_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips_data as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)
    select 
    -- Revenue grouping 
    pickup_zone as revenue_zone,
    timestamp_trunc(
        cast(pickup_datetime as timestamp),
        month
    ) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

    from trips_data
    group by 1,2,3
    );
  
[0m19:24:54.617371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:55.352825 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:a3d2b479-6904-4500-b5a7-24b2ac1b1a84&page=queryresults
[0m19:24:57.572726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e3203b-8d52-4845-8481-73fd063a9e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC42F0B310>]}
[0m19:24:57.573732 [info ] [Thread-1 (]: 16 of 17 OK created sql table model taxi_data_core.dm_monthly_zone_revenue ..... [[32mCREATE TABLE (88.0 rows, 40.5 KiB processed)[0m in 2.96s]
[0m19:24:57.574724 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:24:57.575724 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m19:24:57.576723 [info ] [Thread-1 (]: 17 of 17 START test not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount  [RUN]
[0m19:24:57.576723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dm_monthly_zone_revenue, now test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41)
[0m19:24:57.577723 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m19:24:57.580723 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m19:24:57.580723 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m19:24:57.583238 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m19:24:57.584229 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select revenue_monthly_total_amount
from `tough-timing-449701-k0`.`taxi_data_core`.`dm_monthly_zone_revenue`
where revenue_monthly_total_amount is null



      
    ) dbt_internal_test
[0m19:24:57.584229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:58.282285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:6949d53a-3c73-4956-889a-c0206aed7aae&page=queryresults
[0m19:24:58.868830 [info ] [Thread-1 (]: 17 of 17 PASS not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount .... [[32mPASS[0m in 1.29s]
[0m19:24:58.869829 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m19:24:58.871831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:58.872961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:58.872961 [debug] [MainThread]: Connection 'create_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m19:24:58.873961 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m19:24:58.873961 [debug] [MainThread]: Connection 'test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' was properly closed.
[0m19:24:58.873961 [info ] [MainThread]: 
[0m19:24:58.874969 [info ] [MainThread]: Finished running 1 seed, 3 table models, 11 data tests, 2 view models in 0 hours 0 minutes and 56.31 seconds (56.31s).
[0m19:24:58.876962 [debug] [MainThread]: Command end result
[0m19:24:58.899023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:24:58.902025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:24:58.908436 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:24:58.909362 [info ] [MainThread]: 
[0m19:24:58.910408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:58.910408 [info ] [MainThread]: 
[0m19:24:58.910408 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m19:24:58.913021 [debug] [MainThread]: Command `dbt build` succeeded at 19:24:58.912006 after 60.22 seconds
[0m19:24:58.913021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC095A6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0DFC5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0DFC5150>]}
[0m19:24:58.914021 [debug] [MainThread]: Flushing usage events
[0m19:24:59.688697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:59.605692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178C566E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178C566F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178C566F010>]}


============================== 19:27:59.609195 | 14f4ad1d-f7b9-4dfd-97e3-51d095008731 ==============================
[0m19:27:59.609195 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:27:59.610703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:28:00.747450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f4ad1d-f7b9-4dfd-97e3-51d095008731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178F85DBA50>]}
[0m19:28:00.785914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14f4ad1d-f7b9-4dfd-97e3-51d095008731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178C0C19ED0>]}
[0m19:28:00.785914 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:28:01.165369 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:28:01.362268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:01.364262 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\staging\schema.yaml
[0m19:28:01.755647 [error] [MainThread]: Encountered an error:
Parsing Error
  Failed to render models\staging\schema.yaml from project taxi_rides_ny: Parsing Error
    Env var required but not provided: 'DBT_DATABASE'
[0m19:28:01.757645 [debug] [MainThread]: Command `dbt build` failed at 19:28:01.757645 after 2.25 seconds
[0m19:28:01.757645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178BFC46F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178F8D92B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178F8D918D0>]}
[0m19:28:01.759151 [debug] [MainThread]: Flushing usage events
[0m19:33:45.968199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8086FC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C808C6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C808C4050>]}


============================== 19:33:45.974207 | ad8449b5-0589-4ffc-b327-52e861e0af2b ==============================
[0m19:33:45.974207 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:33:45.975200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:47.713201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB31D4650>]}
[0m19:33:47.761149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C803D8710>]}
[0m19:33:47.762148 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:33:48.196335 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:33:48.421821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:33:48.423325 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fact_trips.sql
[0m19:33:48.706324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB4083B90>]}
[0m19:33:48.868055 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:33:48.871055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:33:48.896063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB3CDC490>]}
[0m19:33:48.897063 [info ] [MainThread]: Found 5 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m19:33:48.897063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB38D1590>]}
[0m19:33:48.899127 [info ] [MainThread]: 
[0m19:33:48.899127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:48.900126 [info ] [MainThread]: 
[0m19:33:48.900126 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:33:48.903127 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:33:48.904127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:49.686977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:50.196270 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:33:50.197276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:50.680534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m19:33:50.693207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:51.162583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m19:33:51.163581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:51.626932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB3FF7F50>]}
[0m19:33:51.627942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:51.632208 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m19:33:51.634216 [info ] [Thread-1 (]: 1 of 5 START sql table model taxi_data_core.dim_zones .......................... [RUN]
[0m19:33:51.635213 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.dim_zones'
[0m19:33:51.635213 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m19:33:51.641245 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m19:33:51.641752 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m19:33:51.653127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:33:52.154842 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m19:33:52.156213 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m19:33:52.640132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:e8942564-5acd-4932-b1c7-ffed2720b1da&page=queryresults
[0m19:33:54.857246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB3C2BB10>]}
[0m19:33:54.858375 [info ] [Thread-1 (]: 1 of 5 OK created sql table model taxi_data_core.dim_zones ..................... [[32mCREATE TABLE (265.0 rows, 14.2 KiB processed)[0m in 3.22s]
[0m19:33:54.858878 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m19:33:54.858878 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m19:33:54.859893 [info ] [Thread-1 (]: 2 of 5 START sql view model taxi_data_staging.stg_green_tripdata ............... [RUN]
[0m19:33:54.860143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now model.taxi_rides_ny.stg_green_tripdata)
[0m19:33:54.860143 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m19:33:54.882079 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m19:33:54.884080 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m19:33:54.897892 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m19:33:54.898951 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100

;


[0m19:33:54.898951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:55.524750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:409f8bc0-39d3-4f77-a338-7b5c3c122a00&page=queryresults
[0m19:33:55.920576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB3CE8490>]}
[0m19:33:55.921568 [info ] [Thread-1 (]: 2 of 5 OK created sql view model taxi_data_staging.stg_green_tripdata .......... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m19:33:55.922429 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m19:33:55.922429 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:33:55.923434 [info ] [Thread-1 (]: 3 of 5 START sql view model taxi_data_staging.stg_yellow_tripdata .............. [RUN]
[0m19:33:55.923434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m19:33:55.923434 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:33:55.929201 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m19:33:55.930624 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:33:55.932631 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m19:33:55.933632 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m19:33:55.933632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:56.573858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:c81b4eb1-ddb7-4588-907b-592ff265bd54&page=queryresults
[0m19:33:57.002243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB4431250>]}
[0m19:33:57.003244 [info ] [Thread-1 (]: 3 of 5 OK created sql view model taxi_data_staging.stg_yellow_tripdata ......... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m19:33:57.004236 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m19:33:57.005500 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m19:33:57.007004 [info ] [Thread-1 (]: 4 of 5 START sql table model taxi_data_core.fact_trips ......................... [RUN]
[0m19:33:57.008008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now model.taxi_rides_ny.fact_trips)
[0m19:33:57.009009 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m19:33:57.013291 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m19:33:57.014298 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m19:33:57.016297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:57.518452 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m19:33:57.519463 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description,
    YEAR(trips_unioned.pickup_datetime) as pickup_year,
    MONTH(trips_unioned.pickup_datetime) as pickup_month,
    format_date('%Q(%Y)', date(trips_unioned.pickup_datetime)) as pickup_quarter
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m19:33:58.145378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:5429f9ca-61e1-4dc8-a8aa-b65bec8fa72f&page=queryresults
[0m19:33:58.339976 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:5429f9ca-61e1-4dc8-a8aa-b65bec8fa72f&page=queryresults
[0m19:33:58.347478 [debug] [Thread-1 (]: Database Error in model fact_trips (models\core\fact_trips.sql)
  Function not found: YEAR at [60:5]
  compiled code at target\run\taxi_rides_ny\models\core\fact_trips.sql
[0m19:33:58.347478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad8449b5-0589-4ffc-b327-52e861e0af2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CB44E1490>]}
[0m19:33:58.348480 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model taxi_data_core.fact_trips ................ [[31mERROR[0m in 1.34s]
[0m19:33:58.349482 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m19:33:58.349482 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fact_trips' to be skipped because of status 'error'.  Reason: Database Error in model fact_trips (models\core\fact_trips.sql)
  Function not found: YEAR at [60:5]
  compiled code at target\run\taxi_rides_ny\models\core\fact_trips.sql.
[0m19:33:58.350830 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:33:58.352309 [info ] [Thread-1 (]: 5 of 5 SKIP relation taxi_data_core.dm_monthly_zone_revenue .................... [[33mSKIP[0m]
[0m19:33:58.352812 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m19:33:58.354140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:33:58.356230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:58.357733 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:33:58.357733 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_staging' was properly closed.
[0m19:33:58.357733 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m19:33:58.358737 [info ] [MainThread]: 
[0m19:33:58.359742 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 9.46 seconds (9.46s).
[0m19:33:58.361134 [debug] [MainThread]: Command end result
[0m19:33:58.388087 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:33:58.390103 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:33:58.397644 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:33:58.398650 [info ] [MainThread]: 
[0m19:33:58.399838 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:33:58.400845 [info ] [MainThread]: 
[0m19:33:58.400845 [error] [MainThread]:   Database Error in model fact_trips (models\core\fact_trips.sql)
  Function not found: YEAR at [60:5]
  compiled code at target\run\taxi_rides_ny\models\core\fact_trips.sql
[0m19:33:58.401844 [info ] [MainThread]: 
[0m19:33:58.402844 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:33:58.404244 [debug] [MainThread]: Command `dbt run` failed at 19:33:58.403738 after 12.55 seconds
[0m19:33:58.405256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014CFAE96F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C808E6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C808E7FD0>]}
[0m19:33:58.405256 [debug] [MainThread]: Flushing usage events
[0m19:34:00.095684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:27.304712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C76F810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C58DED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C76FF50>]}


============================== 19:35:27.308716 | 8378cd7a-f9c7-47eb-80fa-9c84c858e499 ==============================
[0m19:35:27.308716 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:35:27.309709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fact_trips', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:28.494336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8378cd7a-f9c7-47eb-80fa-9c84c858e499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB3F727F10>]}
[0m19:35:28.540283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8378cd7a-f9c7-47eb-80fa-9c84c858e499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07D3DE10>]}
[0m19:35:28.541369 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:35:28.894691 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:35:29.091193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:35:29.093200 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fact_trips.sql
[0m19:35:29.378487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8378cd7a-f9c7-47eb-80fa-9c84c858e499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB3F75E710>]}
[0m19:35:29.531981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:35:29.535986 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:35:29.558453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8378cd7a-f9c7-47eb-80fa-9c84c858e499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB3FCAC8D0>]}
[0m19:35:29.559515 [info ] [MainThread]: Found 5 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m19:35:29.559515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8378cd7a-f9c7-47eb-80fa-9c84c858e499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB3FBD3F50>]}
[0m19:35:29.561998 [info ] [MainThread]: 
[0m19:35:29.563002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:29.564003 [info ] [MainThread]: 
[0m19:35:29.565003 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:35:29.566017 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:35:29.566017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:30.152738 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m19:35:30.153742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:30.608662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m19:35:30.608662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:31.146980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m19:35:31.147980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:31.644594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8378cd7a-f9c7-47eb-80fa-9c84c858e499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB3FEC8DD0>]}
[0m19:35:31.644594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:31.648113 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m19:35:31.649112 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fact_trips ......................... [RUN]
[0m19:35:31.650112 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fact_trips'
[0m19:35:31.650112 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m19:35:31.655548 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m19:35:31.655548 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m19:35:31.666883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:35:32.187753 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m19:35:32.189027 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description,
    format_date('%Y', date(trips_unioned.pickup_datetime)) as pickup_year,
    format_date('%Y-%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m19:35:32.857412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:1caad7f1-0438-4e3e-bf72-f594ac4dfe96&page=queryresults
[0m19:35:40.626147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8378cd7a-f9c7-47eb-80fa-9c84c858e499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB3FF49990>]}
[0m19:35:40.627150 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fact_trips .................... [[32mCREATE TABLE (197.0 rows, 19.4 GiB processed)[0m in 8.98s]
[0m19:35:40.628140 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m19:35:40.628645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:40.631198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:40.631716 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:35:40.631716 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:35:40.631716 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m19:35:40.632753 [info ] [MainThread]: 
[0m19:35:40.632753 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.07 seconds (11.07s).
[0m19:35:40.634196 [debug] [MainThread]: Command end result
[0m19:35:40.661216 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:35:40.664625 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:35:40.669835 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:35:40.669835 [info ] [MainThread]: 
[0m19:35:40.671340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:35:40.671340 [info ] [MainThread]: 
[0m19:35:40.672754 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:35:40.673758 [debug] [MainThread]: Command `dbt run` succeeded at 19:35:40.673758 after 13.45 seconds
[0m19:35:40.674264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C7C5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C7C5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB06F7F490>]}
[0m19:35:40.674264 [debug] [MainThread]: Flushing usage events
[0m19:35:42.356858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:23.058862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319D56FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319D56F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319D56FB10>]}


============================== 19:37:23.062281 | c20bfcd8-fb61-41fe-99f7-3905852e7b55 ==============================
[0m19:37:23.062281 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:37:23.063285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_trips', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:37:24.510441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c20bfcd8-fb61-41fe-99f7-3905852e7b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231CEEDDE50>]}
[0m19:37:24.553465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c20bfcd8-fb61-41fe-99f7-3905852e7b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023198B09D90>]}
[0m19:37:24.553465 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:37:24.935336 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:37:25.163716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:25.164819 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fact_trips.sql
[0m19:37:25.438243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c20bfcd8-fb61-41fe-99f7-3905852e7b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0D4EE10>]}
[0m19:37:25.597606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:37:25.602004 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:37:25.625330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c20bfcd8-fb61-41fe-99f7-3905852e7b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0A77E90>]}
[0m19:37:25.626330 [info ] [MainThread]: Found 5 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m19:37:25.626330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20bfcd8-fb61-41fe-99f7-3905852e7b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0DAE310>]}
[0m19:37:25.628323 [info ] [MainThread]: 
[0m19:37:25.629343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:25.629343 [info ] [MainThread]: 
[0m19:37:25.630331 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:37:25.631332 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:37:25.631332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:26.139524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m19:37:26.139524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:26.614037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m19:37:26.615037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:27.074185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m19:37:27.076183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:27.569540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c20bfcd8-fb61-41fe-99f7-3905852e7b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0CFD350>]}
[0m19:37:27.570531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:27.574046 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m19:37:27.575046 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fact_trips ......................... [RUN]
[0m19:37:27.578043 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fact_trips'
[0m19:37:27.578549 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m19:37:27.584966 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m19:37:27.585969 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m19:37:27.597478 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:28.109048 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m19:37:28.110048 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description,
    SAFE_CAST(format_date('%Y', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_year,
    SAFE_CAST(format_date('%M', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_month,
    format_date('%Y-%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m19:37:28.771308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:e615278b-79bb-4388-be06-5f023a98c595&page=queryresults
[0m19:37:36.519341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c20bfcd8-fb61-41fe-99f7-3905852e7b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0A7D250>]}
[0m19:37:36.519859 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fact_trips .................... [[32mCREATE TABLE (197.0 rows, 19.4 GiB processed)[0m in 8.94s]
[0m19:37:36.520425 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m19:37:36.521490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:36.523050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:36.523574 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:37:36.524121 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m19:37:36.524121 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m19:37:36.524645 [info ] [MainThread]: 
[0m19:37:36.525748 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.89 seconds (10.89s).
[0m19:37:36.526806 [debug] [MainThread]: Command end result
[0m19:37:36.552109 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:37:36.555360 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:37:36.561386 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:37:36.561386 [info ] [MainThread]: 
[0m19:37:36.563579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:36.568574 [info ] [MainThread]: 
[0m19:37:36.569574 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:37:36.570573 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:36.570573 after 13.59 seconds
[0m19:37:36.572078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319D5E7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319D5E7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023197D4E910>]}
[0m19:37:36.572078 [debug] [MainThread]: Flushing usage events
[0m19:37:37.250410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:00.791794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFE6EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFE6F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FFE6D210>]}


============================== 19:45:00.798887 | 27db088e-db71-4355-a955-4d6833d7633c ==============================
[0m19:45:00.798887 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:45:00.800893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fact_trips', 'send_anonymous_usage_stats': 'True'}
[0m19:45:02.581585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27db088e-db71-4355-a955-4d6833d7633c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FF1FF9D0>]}
[0m19:45:02.618452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27db088e-db71-4355-a955-4d6833d7633c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FD3D9A10>]}
[0m19:45:02.618452 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:45:02.987440 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:45:03.202149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:45:03.202149 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m19:45:03.202149 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fact_trips.sql
[0m19:45:03.465390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27db088e-db71-4355-a955-4d6833d7633c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F234137D90>]}
[0m19:45:03.633412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:45:03.638920 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:45:03.673045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27db088e-db71-4355-a955-4d6833d7633c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2343973D0>]}
[0m19:45:03.673045 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m19:45:03.674214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27db088e-db71-4355-a955-4d6833d7633c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23427CC90>]}
[0m19:45:03.675221 [info ] [MainThread]: 
[0m19:45:03.676344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:45:03.676344 [info ] [MainThread]: 
[0m19:45:03.677633 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:45:03.678136 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m19:45:03.679142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:05.310179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m19:45:05.311184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:06.234115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m19:45:06.249058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:06.791052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m19:45:06.792058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:07.319344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27db088e-db71-4355-a955-4d6833d7633c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F234590E90>]}
[0m19:45:07.320426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:07.324344 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m19:45:07.325344 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fact_trips ......................... [RUN]
[0m19:45:07.326344 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fact_trips'
[0m19:45:07.326344 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m19:45:07.332467 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m19:45:07.333460 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m19:45:07.345359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:45:07.894226 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m19:45:07.895560 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description,
    SAFE_CAST(format_date('%Y', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_year,
    SAFE_CAST(format_date('%M', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_month,
    format_date('%Y-%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter_year,
    format_date('%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m19:45:08.543242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:ded8de8c-a7b5-46bf-8a9b-4a1d4e58c73b&page=queryresults
[0m19:45:16.789451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db088e-db71-4355-a955-4d6833d7633c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F232DB4090>]}
[0m19:45:16.790454 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fact_trips .................... [[32mCREATE TABLE (194.0 rows, 19.4 GiB processed)[0m in 9.46s]
[0m19:45:16.791451 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m19:45:16.794399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:16.795972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:16.796497 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m19:45:16.796497 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m19:45:16.797029 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
[0m19:45:16.797029 [info ] [MainThread]: 
[0m19:45:16.797557 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.12 seconds (13.12s).
[0m19:45:16.798790 [debug] [MainThread]: Command end result
[0m19:45:16.840826 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m19:45:16.843827 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m19:45:16.851339 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m19:45:16.852339 [info ] [MainThread]: 
[0m19:45:16.853337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:45:16.853924 [info ] [MainThread]: 
[0m19:45:16.854930 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:45:16.855930 [debug] [MainThread]: Command `dbt run` succeeded at 19:45:16.855930 after 16.16 seconds
[0m19:45:16.856933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FB64E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FB64E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FB64F490>]}
[0m19:45:16.856933 [debug] [MainThread]: Flushing usage events
[0m19:45:18.624152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:29.018658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7D772ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7D7734D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7D772950>]}


============================== 20:23:29.024946 | 015ab879-64af-4292-9d44-f9d870bd8d6e ==============================
[0m20:23:29.024946 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:23:29.026289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:23:30.869925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '015ab879-64af-4292-9d44-f9d870bd8d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A30181C90>]}
[0m20:23:30.906138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '015ab879-64af-4292-9d44-f9d870bd8d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A78D6D850>]}
[0m20:23:30.907139 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:23:31.246180 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:23:31.453450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:31.453450 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:23:31.623827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '015ab879-64af-4292-9d44-f9d870bd8d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A30C47850>]}
[0m20:23:31.685031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:23:31.689031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:23:31.783153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '015ab879-64af-4292-9d44-f9d870bd8d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A30C5B810>]}
[0m20:23:31.783153 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:23:31.784191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015ab879-64af-4292-9d44-f9d870bd8d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A30CE8550>]}
[0m20:23:31.785192 [info ] [MainThread]: 
[0m20:23:31.786192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:23:31.787192 [info ] [MainThread]: 
[0m20:23:31.787192 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:23:31.789192 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:23:31.790192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:32.395473 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m20:23:32.395473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:32.883221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m20:23:32.883221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:33.393530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:23:33.405058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:33.875538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015ab879-64af-4292-9d44-f9d870bd8d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A30CC74D0>]}
[0m20:23:33.876592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:33.880543 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:23:33.881537 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:23:33.881537 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:23:33.882539 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:23:33.887051 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:23:33.890047 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:23:33.913269 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:23:33.914728 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

with agg_trips_per_quarter as (
select 
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    sum(total_amount) as total_quarter_revenue  
from trips 
GROUP BY ALL)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    total_quarter_revenue,
    yoy_growth
from quarterly_revenue_growth
    );
  
[0m20:23:33.915728 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:23:34.918103 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:ae3472c5-bf36-45a2-ad70-4514d6f5bcc3&page=queryresults
[0m20:23:34.918103 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:ae3472c5-bf36-45a2-ad70-4514d6f5bcc3&page=queryresults
[0m20:23:34.926336 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Syntax error: Expected keyword DEPTH but got identifier "agg_trips_per_quarter" at [19:6]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:23:34.928336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015ab879-64af-4292-9d44-f9d870bd8d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A307DB510>]}
[0m20:23:34.929336 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[31mERROR[0m in 1.05s]
[0m20:23:34.930335 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:23:34.930335 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Syntax error: Expected keyword DEPTH but got identifier "agg_trips_per_quarter" at [19:6]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql.
[0m20:23:34.932336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:23:34.933336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:34.933336 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:23:34.933336 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m20:23:34.934723 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:23:34.934723 [info ] [MainThread]: 
[0m20:23:34.935723 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m20:23:34.936722 [debug] [MainThread]: Command end result
[0m20:23:34.956264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:23:34.958260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:23:34.962263 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:23:34.963261 [info ] [MainThread]: 
[0m20:23:34.963765 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:23:34.964770 [info ] [MainThread]: 
[0m20:23:34.965770 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Syntax error: Expected keyword DEPTH but got identifier "agg_trips_per_quarter" at [19:6]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:23:34.965770 [info ] [MainThread]: 
[0m20:23:34.966771 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:23:34.967784 [debug] [MainThread]: Command `dbt run` failed at 20:23:34.967784 after 6.04 seconds
[0m20:23:34.968783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7D7C7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7D7C5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7D4930D0>]}
[0m20:23:34.969772 [debug] [MainThread]: Flushing usage events
[0m20:23:35.749767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:18.699170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178D16FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178D16F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178D16F990>]}


============================== 20:25:18.704682 | 6d6127eb-3ba0-426b-94f5-3b4a47831d41 ==============================
[0m20:25:18.704682 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:25:18.705684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:25:20.219223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d6127eb-3ba0-426b-94f5-3b4a47831d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C00DFE50>]}
[0m20:25:20.256309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d6127eb-3ba0-426b-94f5-3b4a47831d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021788749B50>]}
[0m20:25:20.257308 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:25:20.619536 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:25:20.805844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:20.806844 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:25:21.017900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d6127eb-3ba0-426b-94f5-3b4a47831d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C01A3A50>]}
[0m20:25:21.101693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:25:21.108204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:25:21.197522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d6127eb-3ba0-426b-94f5-3b4a47831d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C01A6110>]}
[0m20:25:21.198529 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:25:21.199522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d6127eb-3ba0-426b-94f5-3b4a47831d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C0591D90>]}
[0m20:25:21.200863 [info ] [MainThread]: 
[0m20:25:21.201920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:21.202468 [info ] [MainThread]: 
[0m20:25:21.203471 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:25:21.204489 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:25:21.204489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:21.777647 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m20:25:21.778649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:22.279370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m20:25:22.280374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:22.817662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:25:22.829805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:23.788879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d6127eb-3ba0-426b-94f5-3b4a47831d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C05C7910>]}
[0m20:25:23.789879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:23.794383 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:23.794383 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:25:23.795385 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:25:23.795385 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:23.801892 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:25:23.801892 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:23.837332 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:25:23.839290 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    pickup_zone,
    pickup_borough,
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    number_of_trips,
    total_passenger_count,
    total_trip_distance,
    average_trip_distance,
    total_fare_amount,
    total_extra,
    total_mta_tax,
    total_tip_amount,
    total_tolls_amount,
    total_ehail_fee,
    total_improvement_surcharge,
    total_quarter_revenue,
    yoy_growth
from quarterly_revenue_growth
    );
  
[0m20:25:23.840294 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:25:24.657923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:48d9aa04-f95c-473b-aae7-bc9ce9eef354&page=queryresults
[0m20:25:24.864351 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:48d9aa04-f95c-473b-aae7-bc9ce9eef354&page=queryresults
[0m20:25:24.872487 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [81:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:25:24.875005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d6127eb-3ba0-426b-94f5-3b4a47831d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178BC7A3D0>]}
[0m20:25:24.876006 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[31mERROR[0m in 1.08s]
[0m20:25:24.877003 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:24.878003 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [81:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql.
[0m20:25:24.880003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:24.882003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:24.882003 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:25:24.882003 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m20:25:24.882003 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:25:24.883512 [info ] [MainThread]: 
[0m20:25:24.884539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m20:25:24.885521 [debug] [MainThread]: Command end result
[0m20:25:24.906719 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:25:24.909721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:25:24.916296 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:25:24.916296 [info ] [MainThread]: 
[0m20:25:24.918278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:24.918278 [info ] [MainThread]: 
[0m20:25:24.919284 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [81:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:25:24.920351 [info ] [MainThread]: 
[0m20:25:24.924715 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:25:24.926607 [debug] [MainThread]: Command `dbt run` failed at 20:25:24.926607 after 6.32 seconds
[0m20:25:24.927611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178D1C5DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178D1C5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021788730F90>]}
[0m20:25:24.927611 [debug] [MainThread]: Flushing usage events
[0m20:25:25.569927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:33.131707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F80156EA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F80138DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F80138E6D0>]}


============================== 20:25:33.136238 | 303dc06f-caea-48c2-9929-ca05f2f51eb4 ==============================
[0m20:25:33.136238 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:25:33.136238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'send_anonymous_usage_stats': 'True'}
[0m20:25:34.240377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '303dc06f-caea-48c2-9929-ca05f2f51eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F832E1D190>]}
[0m20:25:34.281651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '303dc06f-caea-48c2-9929-ca05f2f51eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FCADD8D0>]}
[0m20:25:34.281651 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:25:34.628439 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:25:34.790418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:34.791418 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:25:34.970987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '303dc06f-caea-48c2-9929-ca05f2f51eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8348F0910>]}
[0m20:25:35.043325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:25:35.047870 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:25:35.134232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '303dc06f-caea-48c2-9929-ca05f2f51eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8345EA090>]}
[0m20:25:35.134232 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:25:35.135237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303dc06f-caea-48c2-9929-ca05f2f51eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F834A77A10>]}
[0m20:25:35.136239 [info ] [MainThread]: 
[0m20:25:35.137239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:35.137239 [info ] [MainThread]: 
[0m20:25:35.138250 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:25:35.139243 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:25:35.139243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:35.669681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m20:25:35.670682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:36.130250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:25:36.130805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:36.631390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m20:25:36.632441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:37.100364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303dc06f-caea-48c2-9929-ca05f2f51eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83440F910>]}
[0m20:25:37.101502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:37.103480 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:37.104487 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:25:37.105485 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:25:37.106660 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:37.113562 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:25:37.114822 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:37.147625 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:25:37.149624 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        tripid,
        vendorid,
        service_type,
        ratecodeid,
        pickup_locationid,
        pickup_borough,
        pickup_zone,
        dropoff_locationid,
        dropoff_borough,
        dropoff_zone,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        payment_type_description,
        SAFE_CAST(format_date('%Y', date(pickup_datetime)) AS INTEGER) as pickup_year,
        SAFE_CAST(format_date('%M', date(pickup_datetime)) AS INTEGER) as pickup_month,
        format_date('%Y-%Q', date(pickup_datetime)) as pickup_quarter_year,
        format_date('%Q', date(pickup_datetime)) as pickup_quarter
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    pickup_zone,
    pickup_borough,
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    number_of_trips,
    total_passenger_count,
    total_trip_distance,
    average_trip_distance,
    total_fare_amount,
    total_extra,
    total_mta_tax,
    total_tip_amount,
    total_tolls_amount,
    total_ehail_fee,
    total_improvement_surcharge,
    total_quarter_revenue,
    yoy_growth
from quarterly_revenue_growth
    );
  
[0m20:25:37.149624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:25:37.780199 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:6a8c6ed5-0d63-4b4f-8382-2967d77fb2db&page=queryresults
[0m20:25:37.959103 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:6a8c6ed5-0d63-4b4f-8382-2967d77fb2db&page=queryresults
[0m20:25:37.963130 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:25:37.964134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303dc06f-caea-48c2-9929-ca05f2f51eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83491B1D0>]}
[0m20:25:37.965134 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[31mERROR[0m in 0.86s]
[0m20:25:37.966134 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:37.966134 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql.
[0m20:25:37.969246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:37.971246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:37.972244 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:25:37.972244 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m20:25:37.973247 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:25:37.973751 [info ] [MainThread]: 
[0m20:25:37.973751 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m20:25:37.975756 [debug] [MainThread]: Command end result
[0m20:25:38.001652 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:25:38.005161 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:25:38.010162 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:25:38.010162 [info ] [MainThread]: 
[0m20:25:38.011161 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:38.012162 [info ] [MainThread]: 
[0m20:25:38.012162 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:25:38.013160 [info ] [MainThread]: 
[0m20:25:38.013160 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:25:38.015194 [debug] [MainThread]: Command `dbt run` failed at 20:25:38.015194 after 4.96 seconds
[0m20:25:38.015194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8015E7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8015E7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8010CB710>]}
[0m20:25:38.016194 [debug] [MainThread]: Flushing usage events
[0m20:25:38.613533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:51.982416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43946E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43946D5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43946F810>]}


============================== 20:25:51.987930 | f63ff216-27be-4091-8e89-b7cbb709b849 ==============================
[0m20:25:51.987930 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:25:51.988930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:25:53.189081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f63ff216-27be-4091-8e89-b7cbb709b849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46C3F3010>]}
[0m20:25:53.229274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f63ff216-27be-4091-8e89-b7cbb709b849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4349C8810>]}
[0m20:25:53.230274 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:25:53.588394 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:25:53.728084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:53.729083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:53.764411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f63ff216-27be-4091-8e89-b7cbb709b849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46C921390>]}
[0m20:25:53.840522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:25:53.845032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:25:53.863384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f63ff216-27be-4091-8e89-b7cbb709b849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46C46E490>]}
[0m20:25:53.864396 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:25:53.865400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f63ff216-27be-4091-8e89-b7cbb709b849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46C45CC50>]}
[0m20:25:53.866401 [info ] [MainThread]: 
[0m20:25:53.866401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:53.867407 [info ] [MainThread]: 
[0m20:25:53.868819 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:25:53.869883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:25:53.869883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:54.383540 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m20:25:54.383540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:54.839390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:25:54.840393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:55.299470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m20:25:55.300480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:55.839660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f63ff216-27be-4091-8e89-b7cbb709b849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46C7F81D0>]}
[0m20:25:55.841165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:55.843671 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:55.844675 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:25:55.846170 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:25:55.846955 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:55.855123 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:25:55.856127 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:55.888354 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:25:55.889864 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        tripid,
        vendorid,
        service_type,
        ratecodeid,
        pickup_locationid,
        pickup_borough,
        pickup_zone,
        dropoff_locationid,
        dropoff_borough,
        dropoff_zone,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        payment_type_description,
        SAFE_CAST(format_date('%Y', date(pickup_datetime)) AS INTEGER) as pickup_year,
        SAFE_CAST(format_date('%M', date(pickup_datetime)) AS INTEGER) as pickup_month,
        format_date('%Y-%Q', date(pickup_datetime)) as pickup_quarter_year,
        format_date('%Q', date(pickup_datetime)) as pickup_quarter
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    pickup_zone,
    pickup_borough,
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    number_of_trips,
    total_passenger_count,
    total_trip_distance,
    average_trip_distance,
    total_fare_amount,
    total_extra,
    total_mta_tax,
    total_tip_amount,
    total_tolls_amount,
    total_ehail_fee,
    total_improvement_surcharge,
    total_quarter_revenue,
    yoy_growth
from quarterly_revenue_growth
    );
  
[0m20:25:55.891236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:25:56.556880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:9367fc08-e5b8-4e59-935f-ce248451aabc&page=queryresults
[0m20:25:56.773500 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:9367fc08-e5b8-4e59-935f-ce248451aabc&page=queryresults
[0m20:25:56.779627 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:25:56.781135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f63ff216-27be-4091-8e89-b7cbb709b849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46C826F10>]}
[0m20:25:56.782592 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[31mERROR[0m in 0.93s]
[0m20:25:56.783105 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:25:56.783105 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql.
[0m20:25:56.785116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:56.786381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:56.787428 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:25:56.787428 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m20:25:56.788426 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:25:56.788426 [info ] [MainThread]: 
[0m20:25:56.789934 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m20:25:56.790934 [debug] [MainThread]: Command end result
[0m20:25:56.901298 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:25:56.903799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:25:56.909359 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:25:56.910359 [info ] [MainThread]: 
[0m20:25:56.910359 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:56.911360 [info ] [MainThread]: 
[0m20:25:56.912365 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: number_of_trips at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:25:56.912365 [info ] [MainThread]: 
[0m20:25:56.913870 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:25:56.913870 [debug] [MainThread]: Command `dbt run` failed at 20:25:56.913870 after 5.01 seconds
[0m20:25:56.914891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4394E1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D433C0F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46CD00C50>]}
[0m20:25:56.914891 [debug] [MainThread]: Flushing usage events
[0m20:25:57.488785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:25.933481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8826F5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8826F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8826F050>]}


============================== 20:26:25.938490 | 100b353e-114f-4f46-a92b-6054a2cb123e ==============================
[0m20:26:25.938490 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:26:25.939494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:26:27.021847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100b353e-114f-4f46-a92b-6054a2cb123e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBB1E7F90>]}
[0m20:26:27.063479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '100b353e-114f-4f46-a92b-6054a2cb123e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8660FA50>]}
[0m20:26:27.064484 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:26:27.421230 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:26:27.586480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:27.587479 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:26:27.782353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100b353e-114f-4f46-a92b-6054a2cb123e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBB8CBA50>]}
[0m20:26:27.850338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:26:27.853346 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:26:27.935690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100b353e-114f-4f46-a92b-6054a2cb123e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBB2AB090>]}
[0m20:26:27.936690 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:26:27.937690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100b353e-114f-4f46-a92b-6054a2cb123e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBB6933D0>]}
[0m20:26:27.938690 [info ] [MainThread]: 
[0m20:26:27.939690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:27.939690 [info ] [MainThread]: 
[0m20:26:27.940697 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:26:27.941697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:26:27.941697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:28.415854 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m20:26:28.416854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:28.869847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:26:28.870959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:29.323434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m20:26:29.324438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:29.807085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100b353e-114f-4f46-a92b-6054a2cb123e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBB9AE650>]}
[0m20:26:29.808081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:29.810086 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:26:29.810086 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:26:29.811082 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:26:29.812079 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:26:29.816182 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:26:29.817163 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:26:29.840623 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:26:29.841622 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        tripid,
        vendorid,
        service_type,
        ratecodeid,
        pickup_locationid,
        pickup_borough,
        pickup_zone,
        dropoff_locationid,
        dropoff_borough,
        dropoff_zone,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        payment_type_description,
        SAFE_CAST(format_date('%Y', date(pickup_datetime)) AS INTEGER) as pickup_year,
        SAFE_CAST(format_date('%M', date(pickup_datetime)) AS INTEGER) as pickup_month,
        format_date('%Y-%Q', date(pickup_datetime)) as pickup_quarter_year,
        format_date('%Q', date(pickup_datetime)) as pickup_quarter
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    pickup_zone,
    pickup_borough,
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    total_passenger_count,
    total_trip_distance,
    average_trip_distance,
    total_fare_amount,
    total_extra,
    total_mta_tax,
    total_tip_amount,
    total_tolls_amount,
    total_ehail_fee,
    total_improvement_surcharge,
    total_quarter_revenue,
    yoy_growth
from quarterly_revenue_growth
    );
  
[0m20:26:29.841622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:26:30.558659 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:41f25b3c-8b67-4d38-8797-a0790589dcce&page=queryresults
[0m20:26:30.745643 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:41f25b3c-8b67-4d38-8797-a0790589dcce&page=queryresults
[0m20:26:30.751433 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: total_passenger_count at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:26:30.754061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '100b353e-114f-4f46-a92b-6054a2cb123e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBB95DB90>]}
[0m20:26:30.755349 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[31mERROR[0m in 0.94s]
[0m20:26:30.756356 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:26:30.757386 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: total_passenger_count at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql.
[0m20:26:30.758891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:30.760217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:30.760217 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:26:30.761220 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m20:26:30.761220 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:26:30.761220 [info ] [MainThread]: 
[0m20:26:30.763220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m20:26:30.763721 [debug] [MainThread]: Command end result
[0m20:26:30.787456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:26:30.790457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:26:30.793986 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:26:30.793986 [info ] [MainThread]: 
[0m20:26:30.795732 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:26:30.795732 [info ] [MainThread]: 
[0m20:26:30.797072 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: total_passenger_count at [110:5]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:26:30.797072 [info ] [MainThread]: 
[0m20:26:30.798321 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:26:30.799839 [debug] [MainThread]: Command `dbt run` failed at 20:26:30.799839 after 4.93 seconds
[0m20:26:30.800341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC882A20D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC882A19D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC86486E90>]}
[0m20:26:30.800341 [debug] [MainThread]: Flushing usage events
[0m20:26:32.472445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:40.883316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D39D16FD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D39D16C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D39D16FBD0>]}


============================== 20:26:40.887332 | 96e1f7e6-f266-4fdf-a61c-cab18940a656 ==============================
[0m20:26:40.887332 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:26:40.889330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'send_anonymous_usage_stats': 'True'}
[0m20:26:41.958382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96e1f7e6-f266-4fdf-a61c-cab18940a656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3CEA5FF90>]}
[0m20:26:41.994451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96e1f7e6-f266-4fdf-a61c-cab18940a656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D39873D6D0>]}
[0m20:26:41.995456 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:26:42.328126 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:26:42.497316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:42.497316 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:26:42.691435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e1f7e6-f266-4fdf-a61c-cab18940a656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3D00E4550>]}
[0m20:26:42.761571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:26:42.765083 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:26:42.842394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e1f7e6-f266-4fdf-a61c-cab18940a656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3D05DC050>]}
[0m20:26:42.842394 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:26:42.844005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e1f7e6-f266-4fdf-a61c-cab18940a656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3D0592CD0>]}
[0m20:26:42.844969 [info ] [MainThread]: 
[0m20:26:42.845598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:42.846678 [info ] [MainThread]: 
[0m20:26:42.847591 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:26:42.847591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:26:42.848985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:43.363057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m20:26:43.363560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:43.843404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:26:43.843906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:44.316740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m20:26:44.316740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:44.858845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e1f7e6-f266-4fdf-a61c-cab18940a656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D398636650>]}
[0m20:26:44.860270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:44.862283 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:26:44.863277 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:26:44.863784 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:26:44.864792 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:26:44.872211 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:26:44.873712 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:26:44.900612 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:26:44.901610 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        tripid,
        vendorid,
        service_type,
        ratecodeid,
        pickup_locationid,
        pickup_borough,
        pickup_zone,
        dropoff_locationid,
        dropoff_borough,
        dropoff_zone,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        payment_type_description,
        SAFE_CAST(format_date('%Y', date(pickup_datetime)) AS INTEGER) as pickup_year,
        SAFE_CAST(format_date('%M', date(pickup_datetime)) AS INTEGER) as pickup_month,
        format_date('%Y-%Q', date(pickup_datetime)) as pickup_quarter_year,
        format_date('%Q', date(pickup_datetime)) as pickup_quarter
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        pickup_zone,
        pickup_borough,
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    *
from quarterly_revenue_growth
    );
  
[0m20:26:44.903114 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:26:45.533976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:a2175c7c-c996-4968-9c3b-232cf5ec2f9b&page=queryresults
[0m20:26:47.799044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e1f7e6-f266-4fdf-a61c-cab18940a656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3D015F290>]}
[0m20:26:47.799947 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[32mCREATE TABLE (77.0 rows, 11.2 KiB processed)[0m in 2.93s]
[0m20:26:47.800955 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:26:47.801946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:47.803456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:47.803456 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:26:47.804465 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m20:26:47.804465 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:26:47.804465 [info ] [MainThread]: 
[0m20:26:47.805489 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m20:26:47.806468 [debug] [MainThread]: Command end result
[0m20:26:47.829834 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:26:47.831830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:26:47.838344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:26:47.839340 [info ] [MainThread]: 
[0m20:26:47.840340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:47.841341 [info ] [MainThread]: 
[0m20:26:47.841341 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:26:47.842341 [debug] [MainThread]: Command `dbt run` succeeded at 20:26:47.842341 after 7.02 seconds
[0m20:26:47.843846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D398ED2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D39797F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D39797E910>]}
[0m20:26:47.843846 [debug] [MainThread]: Flushing usage events
[0m20:26:48.468434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:39.898648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5E96EE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5E96E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5E96FE10>]}


============================== 20:27:39.902356 | 7fd91945-4007-41e3-bcd7-c3fd2d2cd845 ==============================
[0m20:27:39.902356 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:27:39.903364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:27:40.947713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fd91945-4007-41e3-bcd7-c3fd2d2cd845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D12969B90>]}
[0m20:27:40.993131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fd91945-4007-41e3-bcd7-c3fd2d2cd845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5AF19FD0>]}
[0m20:27:40.994133 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:27:41.363741 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:27:41.568126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:41.569823 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:27:41.787556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fd91945-4007-41e3-bcd7-c3fd2d2cd845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D12A02450>]}
[0m20:27:41.857687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:27:41.863932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:27:41.986369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fd91945-4007-41e3-bcd7-c3fd2d2cd845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D12A00690>]}
[0m20:27:41.986369 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:27:41.987362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd91945-4007-41e3-bcd7-c3fd2d2cd845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D12E93410>]}
[0m20:27:41.989367 [info ] [MainThread]: 
[0m20:27:41.990361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:27:41.992907 [info ] [MainThread]: 
[0m20:27:41.993911 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:27:41.994910 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:27:41.995904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:42.470775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m20:27:42.470775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:42.983696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:27:42.993362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:43.485909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:27:43.486905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:43.995319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd91945-4007-41e3-bcd7-c3fd2d2cd845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D12637990>]}
[0m20:27:43.995319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:43.999327 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:27:44.000341 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:27:44.003828 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:27:44.004337 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:27:44.009230 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:27:44.010428 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:27:44.020893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:27:44.533825 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:27:44.535827 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    *
from quarterly_revenue_growth
    );
  
[0m20:27:44.906400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:fe603726-48a5-4d8f-bd6d-34126815cd2f&page=queryresults
[0m20:27:45.094811 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:fe603726-48a5-4d8f-bd6d-34126815cd2f&page=queryresults
[0m20:27:45.100409 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: pickup_zone; Did you mean pickup_year? at [55:26]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:27:45.103904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fd91945-4007-41e3-bcd7-c3fd2d2cd845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D128A0C90>]}
[0m20:27:45.104902 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[31mERROR[0m in 1.10s]
[0m20:27:45.104902 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:27:45.105900 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: pickup_zone; Did you mean pickup_year? at [55:26]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql.
[0m20:27:45.107905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:45.108903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:45.108903 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:27:45.108903 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_staging' was properly closed.
[0m20:27:45.108903 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:27:45.108903 [info ] [MainThread]: 
[0m20:27:45.110406 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m20:27:45.110406 [debug] [MainThread]: Command end result
[0m20:27:45.136443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:27:45.138448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:27:45.144283 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:27:45.145294 [info ] [MainThread]: 
[0m20:27:45.146294 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:27:45.146294 [info ] [MainThread]: 
[0m20:27:45.147289 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_revenue (models\core\fct_taxi_trips_quarterly_revenue.sql)
  Unrecognized name: pickup_zone; Did you mean pickup_year? at [55:26]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:27:45.147289 [info ] [MainThread]: 
[0m20:27:45.148573 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:27:45.149080 [debug] [MainThread]: Command `dbt run` failed at 20:27:45.149080 after 5.31 seconds
[0m20:27:45.149080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D13065410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D5A15F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1285EC90>]}
[0m20:27:45.149080 [debug] [MainThread]: Flushing usage events
[0m20:27:45.896503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:07.943384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0AD9C4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0AD78DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0AD96FC90>]}


============================== 20:28:07.947971 | e52f5e1b-4b7c-4788-b086-76ae8f3667d7 ==============================
[0m20:28:07.947971 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:28:07.949564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:28:09.100237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e52f5e1b-4b7c-4788-b086-76ae8f3667d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0AD985D90>]}
[0m20:28:09.144198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e52f5e1b-4b7c-4788-b086-76ae8f3667d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A9F1D150>]}
[0m20:28:09.145199 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:28:09.570743 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:28:09.776567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:28:09.777568 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:28:09.990408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e52f5e1b-4b7c-4788-b086-76ae8f3667d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0E1E24E50>]}
[0m20:28:10.065878 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:28:10.068878 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:28:10.169415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e52f5e1b-4b7c-4788-b086-76ae8f3667d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0E1D5B990>]}
[0m20:28:10.170447 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:28:10.170447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52f5e1b-4b7c-4788-b086-76ae8f3667d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0E1E74D50>]}
[0m20:28:10.172452 [info ] [MainThread]: 
[0m20:28:10.172452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:10.173455 [info ] [MainThread]: 
[0m20:28:10.174072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:28:10.175624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:28:10.175624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:10.678088 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m20:28:10.678088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:11.157081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:28:11.168093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:11.579925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:28:11.581442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:12.039329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52f5e1b-4b7c-4788-b086-76ae8f3667d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0E1CFFA10>]}
[0m20:28:12.040333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:12.046328 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:28:12.047326 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:28:12.048133 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:28:12.048590 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:28:12.053633 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:28:12.054633 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:28:12.062956 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:28:12.576119 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:28:12.577119 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    *
from quarterly_revenue_growth
    );
  
[0m20:28:12.964490 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:709e1a38-97c1-4737-9313-728d6d4633fa&page=queryresults
[0m20:28:15.418271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e52f5e1b-4b7c-4788-b086-76ae8f3667d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0AD579A90>]}
[0m20:28:15.419270 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[32mCREATE TABLE (2.0 rows, 8.0 KiB processed)[0m in 3.37s]
[0m20:28:15.420271 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:28:15.421271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:15.422271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:15.422271 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:28:15.422271 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_staging' was properly closed.
[0m20:28:15.423271 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:28:15.423271 [info ] [MainThread]: 
[0m20:28:15.424271 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m20:28:15.425271 [debug] [MainThread]: Command end result
[0m20:28:15.445272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:28:15.447272 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:28:15.452270 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:28:15.452270 [info ] [MainThread]: 
[0m20:28:15.453272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:15.454271 [info ] [MainThread]: 
[0m20:28:15.455270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:15.456271 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:15.455270 after 7.59 seconds
[0m20:28:15.456271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A915E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A915E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A915FA50>]}
[0m20:28:15.456271 [debug] [MainThread]: Flushing usage events
[0m20:28:16.090892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:48.007659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A4E6FE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A4E6F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A4E6FC10>]}


============================== 20:28:48.011660 | 5106052c-1d07-4a9b-b1d9-86c28348fee0 ==============================
[0m20:28:48.011660 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:28:48.014021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:28:49.312862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5106052c-1d07-4a9b-b1d9-86c28348fee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A41FF910>]}
[0m20:28:49.359578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5106052c-1d07-4a9b-b1d9-86c28348fee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A4213950>]}
[0m20:28:49.360084 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:28:49.749496 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:28:49.933748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:28:49.935228 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:28:50.169783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5106052c-1d07-4a9b-b1d9-86c28348fee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290D9431FD0>]}
[0m20:28:50.252780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:28:50.258310 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:28:50.367432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5106052c-1d07-4a9b-b1d9-86c28348fee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A4A79E50>]}
[0m20:28:50.367432 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:28:50.368432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5106052c-1d07-4a9b-b1d9-86c28348fee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290D92EBE50>]}
[0m20:28:50.369432 [info ] [MainThread]: 
[0m20:28:50.370433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:50.370938 [info ] [MainThread]: 
[0m20:28:50.371944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:28:50.372944 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:28:50.372944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:50.981502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m20:28:50.982502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:51.464451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:28:51.465451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:51.953394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m20:28:51.953900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:52.434324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5106052c-1d07-4a9b-b1d9-86c28348fee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290D9320510>]}
[0m20:28:52.435334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:52.437662 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:28:52.438756 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:28:52.439755 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:28:52.439755 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:28:52.444762 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:28:52.444762 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:28:52.454762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:28:52.968509 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:28:52.969520 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_year ,pickup_quarter_year
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_year ,pickup_quarter_year
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    *
from quarterly_revenue_growth
    );
  
[0m20:28:53.510336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:224b8d77-3601-4ef8-b31d-8b6b63094f9f&page=queryresults
[0m20:28:55.955043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5106052c-1d07-4a9b-b1d9-86c28348fee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290D9212010>]}
[0m20:28:55.957045 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[32mCREATE TABLE (2.0 rows, 8.0 KiB processed)[0m in 3.52s]
[0m20:28:55.958042 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:28:55.959041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:55.960043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:55.961043 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:28:55.961043 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m20:28:55.961043 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:28:55.962043 [info ] [MainThread]: 
[0m20:28:55.962043 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m20:28:55.963042 [debug] [MainThread]: Command end result
[0m20:28:55.987046 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:28:55.990047 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:28:55.995048 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:28:55.996057 [info ] [MainThread]: 
[0m20:28:55.997046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:55.997046 [info ] [MainThread]: 
[0m20:28:55.998047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:55.999048 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:55.999048 after 8.08 seconds
[0m20:28:55.999048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A4D5BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A4EE5D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290A064F510>]}
[0m20:28:56.000047 [debug] [MainThread]: Flushing usage events
[0m20:28:56.652479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:04.607212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629576E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629558E590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629576E9D0>]}


============================== 20:29:04.613278 | 62a82cdd-f26e-469c-8c33-decebcf30e74 ==============================
[0m20:29:04.613278 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:29:04.614279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:29:05.803046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a82cdd-f26e-469c-8c33-decebcf30e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262952FB390>]}
[0m20:29:05.846438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62a82cdd-f26e-469c-8c33-decebcf30e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026290CBDA50>]}
[0m20:29:05.847431 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:29:06.183498 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:29:06.361352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:06.362351 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:29:06.564967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62a82cdd-f26e-469c-8c33-decebcf30e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262C8D2BA50>]}
[0m20:29:06.637355 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:29:06.642372 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:29:06.742786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62a82cdd-f26e-469c-8c33-decebcf30e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262C8719C90>]}
[0m20:29:06.743795 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:29:06.743795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a82cdd-f26e-469c-8c33-decebcf30e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262C8AEA550>]}
[0m20:29:06.746264 [info ] [MainThread]: 
[0m20:29:06.747263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:06.747769 [info ] [MainThread]: 
[0m20:29:06.748773 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:29:06.750071 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:29:06.751088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:07.300361 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m20:29:07.301358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:07.769843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:29:07.770843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:08.274623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m20:29:08.274623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:08.767792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a82cdd-f26e-469c-8c33-decebcf30e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262C87198D0>]}
[0m20:29:08.769208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:08.772210 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:29:08.773207 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:29:08.773207 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:29:08.774618 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:29:08.780160 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:29:08.781160 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:29:08.793033 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:29:09.296220 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:29:09.297220 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_year ,pickup_quarter_year
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_year ,pickup_quarter_year
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_year ,pickup_quarter_year
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from agg_trips_per_quarter
)

select
    *
from quarterly_revenue_growth
    );
  
[0m20:29:09.653640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:ea5686ed-1feb-4cc2-90b5-f7d3ad0dbe23&page=queryresults
[0m20:29:12.412850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a82cdd-f26e-469c-8c33-decebcf30e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262C85B83D0>]}
[0m20:29:12.413845 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[32mCREATE TABLE (2.0 rows, 8.0 KiB processed)[0m in 3.64s]
[0m20:29:12.414847 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:29:12.415847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:12.417352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:12.418357 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:29:12.418357 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m20:29:12.418357 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:29:12.419368 [info ] [MainThread]: 
[0m20:29:12.419368 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m20:29:12.420357 [debug] [MainThread]: Command end result
[0m20:29:12.447179 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:29:12.449930 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:29:12.455928 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:29:12.455928 [info ] [MainThread]: 
[0m20:29:12.457433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:12.458440 [info ] [MainThread]: 
[0m20:29:12.459438 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:29:12.460438 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:12.460438 after 7.93 seconds
[0m20:29:12.460438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262957E7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262957E7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002628FEFFA50>]}
[0m20:29:12.461439 [debug] [MainThread]: Flushing usage events
[0m20:29:14.215641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:00.786828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FF54C63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FF528DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FF546D550>]}


============================== 20:31:00.792036 | dc3bf4a0-bf24-4d00-a379-1edaafbc783e ==============================
[0m20:31:00.792036 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:31:00.792036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_revenue', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:31:02.421708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc3bf4a0-bf24-4d00-a379-1edaafbc783e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FF0E5EB50>]}
[0m20:31:02.465087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc3bf4a0-bf24-4d00-a379-1edaafbc783e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FF09CA050>]}
[0m20:31:02.466565 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:31:02.843958 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:31:03.048462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:31:03.048462 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_revenue.sql
[0m20:31:03.259954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc3bf4a0-bf24-4d00-a379-1edaafbc783e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FA8527B50>]}
[0m20:31:03.339946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:31:03.345039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:31:03.457760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc3bf4a0-bf24-4d00-a379-1edaafbc783e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FA8958B90>]}
[0m20:31:03.457760 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:31:03.459258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc3bf4a0-bf24-4d00-a379-1edaafbc783e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FF0B4FBD0>]}
[0m20:31:03.460265 [info ] [MainThread]: 
[0m20:31:03.461265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:31:03.461265 [info ] [MainThread]: 
[0m20:31:03.462363 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:31:03.463362 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:31:03.464361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:03.999588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m20:31:03.999588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:04.472607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:31:04.482616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:05.006756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:31:05.008133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:05.485091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc3bf4a0-bf24-4d00-a379-1edaafbc783e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FA83F7AD0>]}
[0m20:31:05.485091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:05.488092 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:31:05.489093 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:31:05.490092 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue'
[0m20:31:05.490092 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:31:05.496275 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:31:05.497274 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:31:05.510446 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:31:06.020616 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:31:06.022122 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)


select
    *
from agg_trips_per_quarter
    );
  
[0m20:31:06.408691 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:5b30c26f-7297-4d78-bacb-4e1f4a3f8630&page=queryresults
[0m20:31:08.375515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc3bf4a0-bf24-4d00-a379-1edaafbc783e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FF08C4810>]}
[0m20:31:08.376515 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[32mCREATE TABLE (2.0 rows, 38.7 KiB processed)[0m in 2.89s]
[0m20:31:08.377516 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:31:08.379022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:08.380030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:08.380030 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:31:08.381534 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m20:31:08.381534 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:31:08.381534 [info ] [MainThread]: 
[0m20:31:08.382335 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m20:31:08.382335 [debug] [MainThread]: Command end result
[0m20:31:08.409627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:31:08.412133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:31:08.418139 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:31:08.418139 [info ] [MainThread]: 
[0m20:31:08.419136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:08.420136 [info ] [MainThread]: 
[0m20:31:08.420136 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:31:08.421638 [debug] [MainThread]: Command `dbt run` succeeded at 20:31:08.421638 after 7.70 seconds
[0m20:31:08.422641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEFC0F510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEFC0E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FEFC0E990>]}
[0m20:31:08.422641 [debug] [MainThread]: Flushing usage events
[0m20:31:10.132390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:16.472204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AED6C090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AED6F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AED6E0D0>]}


============================== 20:33:16.475209 | 36b4d14a-6ffd-4e9f-8f58-daa3464527a7 ==============================
[0m20:33:16.475209 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:33:16.476208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select +fct_taxi_trips_quarterly_revenue', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:33:17.543259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AED7BB90>]}
[0m20:33:17.581361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AC2FD9D0>]}
[0m20:33:17.582398 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:33:17.947348 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:33:18.026982 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:33:18.027986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AE886010>]}
[0m20:33:19.413255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E35AB2D0>]}
[0m20:33:19.484364 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:33:19.488684 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:33:19.514945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E38B11D0>]}
[0m20:33:19.514945 [info ] [MainThread]: Found 6 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:33:19.517150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E3821B50>]}
[0m20:33:19.519641 [info ] [MainThread]: 
[0m20:33:19.520647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:33:19.521648 [info ] [MainThread]: 
[0m20:33:19.522646 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:33:19.526662 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:33:19.526662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:20.058440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:20.535529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m20:33:20.535529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:21.015050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m20:33:21.016558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:21.527968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:33:21.538505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:22.034954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E3627D90>]}
[0m20:33:22.035460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:22.041773 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m20:33:22.042278 [info ] [Thread-1 (]: 1 of 5 START sql table model taxi_data_core.dim_zones .......................... [RUN]
[0m20:33:22.043283 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.dim_zones'
[0m20:33:22.044283 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m20:33:22.050330 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m20:33:22.052440 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m20:33:22.063126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:33:22.556553 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m20:33:22.557058 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m20:33:22.969711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:35e02eb9-6880-4cfe-8d00-7d3742be8432&page=queryresults
[0m20:33:24.909290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E368C7D0>]}
[0m20:33:24.910294 [info ] [Thread-1 (]: 1 of 5 OK created sql table model taxi_data_core.dim_zones ..................... [[32mCREATE TABLE (265.0 rows, 14.2 KiB processed)[0m in 2.86s]
[0m20:33:24.910294 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m20:33:24.911490 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m20:33:24.911490 [info ] [Thread-1 (]: 2 of 5 START sql view model taxi_data_staging.stg_green_tripdata ............... [RUN]
[0m20:33:24.912493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now model.taxi_rides_ny.stg_green_tripdata)
[0m20:33:24.912493 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m20:33:24.918816 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m20:33:24.919972 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m20:33:24.938005 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m20:33:24.940003 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'
;


[0m20:33:24.940003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:25.568931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:9dfdd268-957f-465e-99c8-b85dfda2685c&page=queryresults
[0m20:33:25.955347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E3CB5210>]}
[0m20:33:25.956855 [info ] [Thread-1 (]: 2 of 5 OK created sql view model taxi_data_staging.stg_green_tripdata .......... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m20:33:25.957865 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m20:33:25.957865 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m20:33:25.958861 [info ] [Thread-1 (]: 3 of 5 START sql view model taxi_data_staging.stg_yellow_tripdata .............. [RUN]
[0m20:33:25.959860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m20:33:25.960859 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m20:33:25.966650 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m20:33:25.968667 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m20:33:25.970666 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m20:33:25.971666 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
;


[0m20:33:25.972668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:26.578781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:a651ba3c-5540-48ca-9408-45c616b21849&page=queryresults
[0m20:33:26.973847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E38FFE50>]}
[0m20:33:26.974848 [info ] [Thread-1 (]: 3 of 5 OK created sql view model taxi_data_staging.stg_yellow_tripdata ......... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m20:33:26.976358 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m20:33:26.976661 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m20:33:26.977166 [info ] [Thread-1 (]: 4 of 5 START sql table model taxi_data_core.fact_trips ......................... [RUN]
[0m20:33:26.978172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now model.taxi_rides_ny.fact_trips)
[0m20:33:26.978172 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m20:33:26.980175 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m20:33:26.981178 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m20:33:26.983265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:27.527754 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m20:33:27.529742 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description,
    SAFE_CAST(format_date('%Y', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_year,
    SAFE_CAST(format_date('%M', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_month,
    format_date('%Y-%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter_year,
    format_date('%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m20:33:28.145124 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:03d78f88-781c-4347-94b1-fe14742275ab&page=queryresults
[0m20:33:42.445916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E3D16950>]}
[0m20:33:42.446919 [info ] [Thread-1 (]: 4 of 5 OK created sql table model taxi_data_core.fact_trips .................... [[32mCREATE TABLE (61.6m rows, 19.4 GiB processed)[0m in 15.47s]
[0m20:33:42.447913 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m20:33:42.448913 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:33:42.449914 [info ] [Thread-1 (]: 5 of 5 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m20:33:42.450914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fact_trips, now model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue)
[0m20:33:42.450914 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:33:42.453914 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:33:42.454915 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:33:42.456914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:42.968306 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m20:33:42.969398 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)


select
    *
from agg_trips_per_quarter
    );
  
[0m20:33:43.319490 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f7afe0eb-429a-4667-80f2-340028e0ebb1&page=queryresults
[0m20:33:46.091530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4d14a-6ffd-4e9f-8f58-daa3464527a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269E3D71B50>]}
[0m20:33:46.091530 [info ] [Thread-1 (]: 5 of 5 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[32mCREATE TABLE (43.0 rows, 12.1 GiB processed)[0m in 3.64s]
[0m20:33:46.092533 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m20:33:46.094531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:46.095530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:46.095530 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:33:46.096531 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_staging' was properly closed.
[0m20:33:46.096531 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue' was properly closed.
[0m20:33:46.096531 [info ] [MainThread]: 
[0m20:33:46.097531 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 26.57 seconds (26.57s).
[0m20:33:46.098530 [debug] [MainThread]: Command end result
[0m20:33:46.120544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:33:46.122537 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:33:46.126536 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:33:46.126536 [info ] [MainThread]: 
[0m20:33:46.127537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:46.127537 [info ] [MainThread]: 
[0m20:33:46.127537 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:33:46.130056 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:46.129041 after 29.76 seconds
[0m20:33:46.130056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AEDE6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AEDE6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269AEA930D0>]}
[0m20:33:46.130056 [debug] [MainThread]: Flushing usage events
[0m20:33:47.076392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:27.777465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583616CBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583616F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583616EC90>]}


============================== 20:36:27.782473 | 4edcaff3-c458-49e3-9b0c-752060cd270f ==============================
[0m20:36:27.782473 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:36:27.784569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'send_anonymous_usage_stats': 'True'}
[0m20:36:28.970315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4edcaff3-c458-49e3-9b0c-752060cd270f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025867F16910>]}
[0m20:36:29.012732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4edcaff3-c458-49e3-9b0c-752060cd270f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258316D9B10>]}
[0m20:36:29.013838 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:36:29.429072 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:36:29.653226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:36:29.655230 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:36:29.883530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4edcaff3-c458-49e3-9b0c-752060cd270f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586980E0D0>]}
[0m20:36:29.952143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:36:29.955888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:36:30.041034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4edcaff3-c458-49e3-9b0c-752060cd270f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258696ECF90>]}
[0m20:36:30.042544 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:36:30.043556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4edcaff3-c458-49e3-9b0c-752060cd270f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586986E690>]}
[0m20:36:30.044554 [info ] [MainThread]: 
[0m20:36:30.045561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:30.046560 [info ] [MainThread]: 
[0m20:36:30.047558 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:36:30.048559 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:36:30.048559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:30.674076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m20:36:30.674076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:31.153388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:36:31.166743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:31.639095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:36:31.640089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:32.109091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4edcaff3-c458-49e3-9b0c-752060cd270f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025869898F10>]}
[0m20:36:32.109091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:32.113688 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:36:32.113688 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m20:36:32.115187 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m20:36:32.115187 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:36:32.121579 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m20:36:32.122588 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:36:32.152915 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m20:36:32.154937 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by pickup_zone, pickup_borough, service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from quarterly_revenue
)


select
    *
from quarterly_revenue_growth
    );
  
[0m20:36:32.154937 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:36:32.842554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:d44d58c2-e901-4c02-97ed-d1356d6c7743&page=queryresults
[0m20:36:33.043150 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:d44d58c2-e901-4c02-97ed-d1356d6c7743&page=queryresults
[0m20:36:33.052906 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Unrecognized name: pickup_zone; Did you mean pickup_year? at [29:26]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:36:33.054418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4edcaff3-c458-49e3-9b0c-752060cd270f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258695D2810>]}
[0m20:36:33.055426 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy  [[31mERROR[0m in 0.94s]
[0m20:36:33.056894 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:36:33.056894 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Unrecognized name: pickup_zone; Did you mean pickup_year? at [29:26]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql.
[0m20:36:33.062518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:33.069537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:33.069537 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:36:33.070543 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m20:36:33.070543 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m20:36:33.071453 [info ] [MainThread]: 
[0m20:36:33.072059 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m20:36:33.074467 [debug] [MainThread]: Command end result
[0m20:36:33.106277 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:36:33.109285 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:36:33.114828 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:36:33.115842 [info ] [MainThread]: 
[0m20:36:33.115842 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:36:33.117111 [info ] [MainThread]: 
[0m20:36:33.118382 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Unrecognized name: pickup_zone; Did you mean pickup_year? at [29:26]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:36:33.118382 [info ] [MainThread]: 
[0m20:36:33.119388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:36:33.120384 [debug] [MainThread]: Command `dbt run` failed at 20:36:33.120384 after 5.44 seconds
[0m20:36:33.121384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583167A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025869854190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258698557D0>]}
[0m20:36:33.121384 [debug] [MainThread]: Flushing usage events
[0m20:36:33.840505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:49.523481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DA2EC7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DA2E6C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DA2E6F190>]}


============================== 20:36:49.527897 | 2de7ba19-7a8c-482d-a2df-98596a8d5360 ==============================
[0m20:36:49.527897 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:36:49.528992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'send_anonymous_usage_stats': 'True'}
[0m20:36:50.748978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2de7ba19-7a8c-482d-a2df-98596a8d5360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DA29FBED0>]}
[0m20:36:50.791088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2de7ba19-7a8c-482d-a2df-98596a8d5360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DA040D610>]}
[0m20:36:50.791088 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:36:51.153831 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:36:51.347417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:36:51.348444 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:36:51.559386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2de7ba19-7a8c-482d-a2df-98596a8d5360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD71AFD50>]}
[0m20:36:51.640953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:36:51.646350 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:36:51.726471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2de7ba19-7a8c-482d-a2df-98596a8d5360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD72AD310>]}
[0m20:36:51.727471 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:36:51.728471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2de7ba19-7a8c-482d-a2df-98596a8d5360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD7211450>]}
[0m20:36:51.729471 [info ] [MainThread]: 
[0m20:36:51.729471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:51.730471 [info ] [MainThread]: 
[0m20:36:51.730471 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:36:51.731471 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:36:51.732469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:52.286862 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m20:36:52.288307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:52.819375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m20:36:52.820374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:53.307081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:36:53.317786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:53.850731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2de7ba19-7a8c-482d-a2df-98596a8d5360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD73FB4D0>]}
[0m20:36:53.851301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:53.853314 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:36:53.854769 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m20:36:53.854769 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m20:36:53.855766 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:36:53.862137 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m20:36:53.862639 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:36:53.899358 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m20:36:53.900474 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from quarterly_revenue
)


select
    *
from quarterly_revenue_growth
    );
  
[0m20:36:53.900474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:36:54.524762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:ef517761-6848-43d1-beeb-f923f364ec5f&page=queryresults
[0m20:36:56.813913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de7ba19-7a8c-482d-a2df-98596a8d5360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD5823550>]}
[0m20:36:56.814921 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy .. [[32mCREATE TABLE (43.0 rows, 1.8 KiB processed)[0m in 2.96s]
[0m20:36:56.815919 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:36:56.817918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:56.818919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:56.819933 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:36:56.819933 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m20:36:56.819933 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m20:36:56.820918 [info ] [MainThread]: 
[0m20:36:56.820918 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m20:36:56.820918 [debug] [MainThread]: Command end result
[0m20:36:56.843445 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:36:56.846957 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:36:56.852576 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:36:56.852576 [info ] [MainThread]: 
[0m20:36:56.853585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:56.854585 [info ] [MainThread]: 
[0m20:36:56.855586 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:56.856353 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:56.856353 after 7.45 seconds
[0m20:36:56.857360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DA2EE7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D9E64E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D9E64E910>]}
[0m20:36:56.857360 [debug] [MainThread]: Flushing usage events
[0m20:36:57.465650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:47.697698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDC736CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDC736D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDC736EE10>]}


============================== 20:38:47.701698 | a0d5f435-d1e7-40d4-a54d-fa2a1c05572d ==============================
[0m20:38:47.701698 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:38:47.702699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:38:48.850457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0d5f435-d1e7-40d4-a54d-fa2a1c05572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDC5EFB490>]}
[0m20:38:48.888503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0d5f435-d1e7-40d4-a54d-fa2a1c05572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDC28AD510>]}
[0m20:38:48.889504 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:38:49.239862 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:38:49.414863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:38:49.414863 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:38:49.601943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0d5f435-d1e7-40d4-a54d-fa2a1c05572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDFA8D7D50>]}
[0m20:38:49.679200 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:38:49.682376 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:38:49.776611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0d5f435-d1e7-40d4-a54d-fa2a1c05572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDFA6AFA10>]}
[0m20:38:49.777134 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:38:49.777653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0d5f435-d1e7-40d4-a54d-fa2a1c05572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDFA9C7990>]}
[0m20:38:49.779223 [info ] [MainThread]: 
[0m20:38:49.779749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:49.780272 [info ] [MainThread]: 
[0m20:38:49.780789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:38:49.781891 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:38:49.782413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:50.296517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m20:38:50.297597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:50.804049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:38:50.806410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:51.309671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m20:38:51.310664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:51.850736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0d5f435-d1e7-40d4-a54d-fa2a1c05572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDFA5F3A10>]}
[0m20:38:51.850736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:51.853837 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:38:51.855111 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m20:38:51.856003 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m20:38:51.856003 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:38:51.862116 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m20:38:51.862116 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:38:51.872481 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:38:52.327585 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m20:38:52.328580 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from quarterly_revenue
    order by quarterly_revenue desc
)


select
    *
from quarterly_revenue_growth
    );
  
[0m20:38:52.716753 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:94c312b5-97d8-4a07-93d6-89c60e935185&page=queryresults
[0m20:38:52.899327 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:94c312b5-97d8-4a07-93d6-89c60e935185&page=queryresults
[0m20:38:52.903742 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  ORDER BY does not support expressions of type STRUCT<service_type STRING, pickup_quarter STRING, pickup_year INT64, ...> at [40:14]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:38:52.905750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0d5f435-d1e7-40d4-a54d-fa2a1c05572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDFA231B50>]}
[0m20:38:52.905750 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy  [[31mERROR[0m in 1.05s]
[0m20:38:52.906750 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:38:52.907751 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  ORDER BY does not support expressions of type STRUCT<service_type STRING, pickup_quarter STRING, pickup_year INT64, ...> at [40:14]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql.
[0m20:38:52.908814 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:52.910750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:52.910750 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:38:52.910750 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m20:38:52.911749 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m20:38:52.911749 [info ] [MainThread]: 
[0m20:38:52.911749 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m20:38:52.912749 [debug] [MainThread]: Command end result
[0m20:38:52.933980 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:38:52.935989 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:38:52.939000 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:38:52.940084 [info ] [MainThread]: 
[0m20:38:52.940084 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:38:52.940988 [info ] [MainThread]: 
[0m20:38:52.941572 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  ORDER BY does not support expressions of type STRUCT<service_type STRING, pickup_quarter STRING, pickup_year INT64, ...> at [40:14]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:38:52.941572 [info ] [MainThread]: 
[0m20:38:52.942587 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:38:52.943585 [debug] [MainThread]: Command `dbt run` failed at 20:38:52.943585 after 5.63 seconds
[0m20:38:52.943585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDC5586ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDFA777810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDC28AF890>]}
[0m20:38:52.943585 [debug] [MainThread]: Flushing usage events
[0m20:38:54.635356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:21.916001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09E56EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09E38DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09E56EA90>]}


============================== 20:39:21.919471 | eb0576ce-f95e-4924-8408-64f594de401d ==============================
[0m20:39:21.919471 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:39:21.920476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:39:23.160452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb0576ce-f95e-4924-8408-64f594de401d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D14DFF10>]}
[0m20:39:23.211154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb0576ce-f95e-4924-8408-64f594de401d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E099AFD790>]}
[0m20:39:23.212154 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:39:23.627953 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:39:23.821745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:23.823756 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:39:24.047475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb0576ce-f95e-4924-8408-64f594de401d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D1258810>]}
[0m20:39:24.127667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:39:24.131182 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:39:24.238626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb0576ce-f95e-4924-8408-64f594de401d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D19AD190>]}
[0m20:39:24.239621 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m20:39:24.240620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb0576ce-f95e-4924-8408-64f594de401d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D124CAD0>]}
[0m20:39:24.242127 [info ] [MainThread]: 
[0m20:39:24.245235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:24.245235 [info ] [MainThread]: 
[0m20:39:24.250251 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:39:24.252243 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m20:39:24.252243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:24.752710 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m20:39:24.752710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:25.236380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m20:39:25.244422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:25.707997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m20:39:25.708997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:26.150468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb0576ce-f95e-4924-8408-64f594de401d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D1ADC1D0>]}
[0m20:39:26.151470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:26.153468 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:39:26.154568 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m20:39:26.155569 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m20:39:26.155569 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:39:26.161574 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m20:39:26.163574 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:39:26.177456 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:39:26.718608 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m20:39:26.719995 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_year 
            order by pickup_quarter_year
        ) * 100 as yoy_growth
    from quarterly_revenue
    
)


select
    *
from quarterly_revenue_growth
order by yoy_growth desc
    );
  
[0m20:39:27.145995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:55147916-feeb-45ce-8af7-819e383e18d3&page=queryresults
[0m20:39:29.147875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb0576ce-f95e-4924-8408-64f594de401d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D14AFA50>]}
[0m20:39:29.148879 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy .. [[32mCREATE TABLE (43.0 rows, 1.8 KiB processed)[0m in 2.99s]
[0m20:39:29.149413 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m20:39:29.153856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:29.154859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:29.156251 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m20:39:29.156251 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_staging' was properly closed.
[0m20:39:29.156251 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m20:39:29.157256 [info ] [MainThread]: 
[0m20:39:29.158275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m20:39:29.159312 [debug] [MainThread]: Command end result
[0m20:39:29.187499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m20:39:29.190400 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m20:39:29.194292 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m20:39:29.195295 [info ] [MainThread]: 
[0m20:39:29.196296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:29.197297 [info ] [MainThread]: 
[0m20:39:29.197297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:39:29.199250 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:29.199250 after 7.37 seconds
[0m20:39:29.199754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09E0A2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E098D3E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E098D3F4D0>]}
[0m20:39:29.199754 [debug] [MainThread]: Flushing usage events
[0m20:39:29.806416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:47.618233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D29F56FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D29F56F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D29F56E8D0>]}


============================== 20:59:47.625296 | 629c4774-f24b-4344-927a-80ac3c508563 ==============================
[0m20:59:47.625296 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:59:47.626307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:59:49.293143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '629c4774-f24b-4344-927a-80ac3c508563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D0D80890>]}
[0m20:59:49.329142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '629c4774-f24b-4344-927a-80ac3c508563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D2504750>]}
[0m20:59:49.330143 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:59:49.803919 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:59:50.044040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:59:50.045048 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m20:59:50.046054 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://macros\get_payment_type_description.sql
[0m20:59:50.046054 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\staging\stg_green_tripdata.sql
[0m20:59:50.469780 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.taxi_rides_ny.stg_green_tripdata' (models\staging\stg_green_tripdata.sql) depends on a source named 'staging.greentrip_data' which was not found
[0m20:59:50.471775 [debug] [MainThread]: Command `dbt run` failed at 20:59:50.471775 after 2.92 seconds
[0m20:59:50.472777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D28429D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D2B1A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D2842E10>]}
[0m20:59:50.472777 [debug] [MainThread]: Flushing usage events
[0m20:59:52.247496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:19.551222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19206F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19206FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19206F310>]}


============================== 21:00:19.555733 | 98c73386-e92a-43b8-aea6-9d131fbf3e67 ==============================
[0m21:00:19.555733 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:00:19.555733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:00:20.592260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98c73386-e92a-43b8-aea6-9d131fbf3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1903DC450>]}
[0m21:00:20.632297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98c73386-e92a-43b8-aea6-9d131fbf3e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18D5E9F10>]}
[0m21:00:20.632297 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:00:21.089265 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:00:21.277600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:00:21.278725 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\staging\stg_green_tripdata.sql
[0m21:00:21.278725 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:00:21.279290 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://macros\get_payment_type_description.sql
[0m21:00:21.695583 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.taxi_rides_ny.stg_green_tripdata' (models\staging\stg_green_tripdata.sql) depends on a source named 'staging.greentrip_data' which was not found
[0m21:00:21.696573 [debug] [MainThread]: Command `dbt run` failed at 21:00:21.696573 after 2.24 seconds
[0m21:00:21.697584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18C6A6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18C8BF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18C8BF510>]}
[0m21:00:21.697584 [debug] [MainThread]: Flushing usage events
[0m21:00:22.281285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:34.719383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252BDF6FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252BDF6E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252BDF6FD10>]}


============================== 21:00:34.723897 | 0b2e668f-e7a1-4902-83ef-1972f62dba7d ==============================
[0m21:00:34.723897 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:00:34.724894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:00:35.862523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252BDFC0710>]}
[0m21:00:35.902276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252BB4D9E10>]}
[0m21:00:35.903276 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:00:36.329976 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:00:36.489422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:00:36.490934 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://macros\get_payment_type_description.sql
[0m21:00:36.491944 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:00:36.946933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F25967D0>]}
[0m21:00:37.010114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:00:37.014640 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:00:37.045720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F22A0990>]}
[0m21:00:37.045720 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:00:37.048717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F0B584D0>]}
[0m21:00:37.049717 [info ] [MainThread]: 
[0m21:00:37.051221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:37.051221 [info ] [MainThread]: 
[0m21:00:37.053227 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:00:37.059227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:00:37.059227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:37.674846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:38.284265 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m21:00:38.284265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:38.808686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m21:00:38.809690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:39.316861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:00:39.326495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:39.821880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F25B6590>]}
[0m21:00:39.821880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:39.827622 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m21:00:39.827622 [info ] [Thread-1 (]: 1 of 7 START sql table model taxi_data_core.dim_zones .......................... [RUN]
[0m21:00:39.828622 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.dim_zones'
[0m21:00:39.828622 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m21:00:39.833887 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m21:00:39.835888 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m21:00:39.848375 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:00:40.380980 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m21:00:40.382992 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m21:00:40.798635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:22041ab4-94f0-407c-b57b-279d13bfc014&page=queryresults
[0m21:00:43.018199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F26B98D0>]}
[0m21:00:43.019191 [info ] [Thread-1 (]: 1 of 7 OK created sql table model taxi_data_core.dim_zones ..................... [[32mCREATE TABLE (265.0 rows, 14.2 KiB processed)[0m in 3.19s]
[0m21:00:43.020191 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m21:00:43.020191 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m21:00:43.021192 [info ] [Thread-1 (]: 2 of 7 START sql view model taxi_data_staging.stg_green_tripdata ............... [RUN]
[0m21:00:43.021700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now model.taxi_rides_ny.stg_green_tripdata)
[0m21:00:43.022706 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m21:00:43.027221 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m21:00:43.028228 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m21:00:43.049127 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m21:00:43.051080 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    CASE
    WHEN payment_type = 1 THEN 'Credit card'
    WHEN payment_type = 2 THEN 'Cash'
    WHEN payment_type = 3 THEN 'No charge'
    WHEN payment_type = 4 THEN 'Dispute'
    WHEN payment_type = 5 THEN 'Unknown'
    WHEN payment_type = 0 THEN 'Voided trip'
    ELSE 'EMPTY'  
  END as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'
;


[0m21:00:43.051080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:44.109428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:33d22514-7158-42ca-a6f2-89d9824016ef&page=queryresults
[0m21:00:44.504785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252BDAD9150>]}
[0m21:00:44.504785 [info ] [Thread-1 (]: 2 of 7 OK created sql view model taxi_data_staging.stg_green_tripdata .......... [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m21:00:44.506781 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m21:00:44.506781 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:00:44.507779 [info ] [Thread-1 (]: 3 of 7 START sql view model taxi_data_staging.stg_yellow_tripdata .............. [RUN]
[0m21:00:44.508777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m21:00:44.508777 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:00:44.514309 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:00:44.515311 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:00:44.517823 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:00:44.519820 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    CASE
    WHEN payment_type = 1 THEN 'Credit card'
    WHEN payment_type = 2 THEN 'Cash'
    WHEN payment_type = 3 THEN 'No charge'
    WHEN payment_type = 4 THEN 'Dispute'
    WHEN payment_type = 5 THEN 'Unknown'
    WHEN payment_type = 0 THEN 'Voided trip'
    ELSE 'EMPTY'  
  END as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
;


[0m21:00:44.520808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:45.132586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:9756bdcb-51e8-41cf-8735-ea84697a0699&page=queryresults
[0m21:00:45.532355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F2B39A90>]}
[0m21:00:45.533366 [info ] [Thread-1 (]: 3 of 7 OK created sql view model taxi_data_staging.stg_yellow_tripdata ......... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m21:00:45.534848 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:00:45.535858 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m21:00:45.536858 [info ] [Thread-1 (]: 4 of 7 START sql table model taxi_data_core.fact_trips ......................... [RUN]
[0m21:00:45.537857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now model.taxi_rides_ny.fact_trips)
[0m21:00:45.537857 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m21:00:45.541360 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m21:00:45.542373 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m21:00:45.545366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:46.043915 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m21:00:46.044963 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description,
    SAFE_CAST(format_date('%Y', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_year,
    SAFE_CAST(format_date('%M', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_month,
    format_date('%Y-%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter_year,
    format_date('%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m21:00:46.623045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:9f106099-5b9e-4290-a8bc-edbf3650e476&page=queryresults
[0m21:01:03.169703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F2C01710>]}
[0m21:01:03.169703 [info ] [Thread-1 (]: 4 of 7 OK created sql table model taxi_data_core.fact_trips .................... [[32mCREATE TABLE (61.6m rows, 19.4 GiB processed)[0m in 17.63s]
[0m21:01:03.171210 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m21:01:03.173215 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m21:01:03.174304 [info ] [Thread-1 (]: 5 of 7 START sql table model taxi_data_core.dm_monthly_zone_revenue ............ [RUN]
[0m21:01:03.175230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fact_trips, now model.taxi_rides_ny.dm_monthly_zone_revenue)
[0m21:01:03.175230 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m21:01:03.178308 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
[0m21:01:03.179264 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m21:01:03.181291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:03.700024 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
[0m21:01:03.703191 [debug] [Thread-1 (]: On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`dm_monthly_zone_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips_data as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)
    select 
    -- Revenue grouping 
    pickup_zone as revenue_zone,
    timestamp_trunc(
        cast(pickup_datetime as timestamp),
        month
    ) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

    from trips_data
    group by 1,2,3
    );
  
[0m21:01:04.085203 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:238fb1ff-4281-4ef7-bcd4-25291a7c88e9&page=queryresults
[0m21:01:07.335382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F2A26D10>]}
[0m21:01:07.336426 [info ] [Thread-1 (]: 5 of 7 OK created sql table model taxi_data_core.dm_monthly_zone_revenue ....... [[32mCREATE TABLE (12.0k rows, 12.5 GiB processed)[0m in 4.16s]
[0m21:01:07.337493 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m21:01:07.337493 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m21:01:07.338521 [info ] [Thread-1 (]: 6 of 7 START sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue ... [RUN]
[0m21:01:07.340030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dm_monthly_zone_revenue, now model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue)
[0m21:01:07.340030 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m21:01:07.342680 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m21:01:07.343686 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m21:01:07.346434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:07.863492 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"
[0m21:01:07.865390 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
)

, agg_trips_per_quarter as (
    select 
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        count(tripid) as number_of_trips,
        sum(passenger_count) as total_passenger_count,
        sum(trip_distance) as total_trip_distance,
        avg(trip_distance) as average_trip_distance,
        sum(fare_amount) as total_fare_amount,
        sum(extra) as total_extra,
        sum(mta_tax) as total_mta_tax,
        sum(tip_amount) as total_tip_amount,
        sum(tolls_amount) as total_tolls_amount,
        sum(ehail_fee) as total_ehail_fee,
        sum(improvement_surcharge) as total_improvement_surcharge,
        sum(total_amount) as total_quarter_revenue
    from trips
    group by
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year
)


select
    *
from agg_trips_per_quarter
    );
  
[0m21:01:08.192233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:de1f3518-5672-40bc-8cb2-c72a32056ab2&page=queryresults
[0m21:01:11.158022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F2C13B90>]}
[0m21:01:11.159709 [info ] [Thread-1 (]: 6 of 7 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_revenue  [[32mCREATE TABLE (43.0 rows, 12.1 GiB processed)[0m in 3.82s]
[0m21:01:11.159709 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue
[0m21:01:11.161221 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:01:11.161221 [info ] [Thread-1 (]: 7 of 7 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m21:01:11.162733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fct_taxi_trips_quarterly_revenue, now model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy)
[0m21:01:11.162733 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:01:11.164529 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:01:11.165529 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:01:11.167595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:11.722804 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:01:11.723804 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_quarter_year 
            order by pickup_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_quarter_year 
            order by pickup_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_quarter_year 
            order by pickup_year
        ) * 100 as yoy_growth
    from quarterly_revenue
    
)


select
    *
from quarterly_revenue_growth
order by yoy_growth desc
    );
  
[0m21:01:12.104415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:c645070b-ebbf-40c0-af1e-2ea5224cc50c&page=queryresults
[0m21:01:13.979227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b2e668f-e7a1-4902-83ef-1972f62dba7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F27D0A50>]}
[0m21:01:13.980234 [info ] [Thread-1 (]: 7 of 7 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy .. [[32mCREATE TABLE (43.0 rows, 1.8 KiB processed)[0m in 2.82s]
[0m21:01:13.981229 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:01:13.982233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:01:13.983239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:13.983239 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:01:13.983239 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_staging' was properly closed.
[0m21:01:13.984227 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:01:13.984227 [info ] [MainThread]: 
[0m21:01:13.985227 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 36.93 seconds (36.93s).
[0m21:01:13.986228 [debug] [MainThread]: Command end result
[0m21:01:14.007017 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:01:14.009175 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:01:14.013685 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:01:14.013685 [info ] [MainThread]: 
[0m21:01:14.015252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:14.016256 [info ] [MainThread]: 
[0m21:01:14.016256 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:01:14.018091 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:14.018091 after 39.36 seconds
[0m21:01:14.018091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B95A6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B983B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B97BE910>]}
[0m21:01:14.018091 [debug] [MainThread]: Flushing usage events
[0m21:01:14.968100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:06.927082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DBE6EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DBE6C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DBE6F2D0>]}


============================== 21:02:06.932050 | 7656af61-0e26-4805-b1a5-66ece299f874 ==============================
[0m21:02:06.932050 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:02:06.933049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:02:08.054957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7656af61-0e26-4805-b1a5-66ece299f874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DB97BF50>]}
[0m21:02:08.098687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7656af61-0e26-4805-b1a5-66ece299f874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DB97A390>]}
[0m21:02:08.098687 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:02:08.470710 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:02:08.640727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:02:08.641727 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:02:08.828202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7656af61-0e26-4805-b1a5-66ece299f874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222044D7B10>]}
[0m21:02:08.894852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:02:08.897369 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:02:08.994545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7656af61-0e26-4805-b1a5-66ece299f874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222044300D0>]}
[0m21:02:08.994545 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:02:08.995551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7656af61-0e26-4805-b1a5-66ece299f874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222042AE2D0>]}
[0m21:02:08.996552 [info ] [MainThread]: 
[0m21:02:08.996552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:08.997551 [info ] [MainThread]: 
[0m21:02:08.998056 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:02:08.998056 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:02:08.999516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:09.595485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m21:02:09.595485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:10.108277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m21:02:10.120810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:10.598424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:02:10.599429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:11.127663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7656af61-0e26-4805-b1a5-66ece299f874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222044CF750>]}
[0m21:02:11.127663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:11.130677 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:02:11.131676 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m21:02:11.132674 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m21:02:11.132674 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:02:11.138178 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:02:11.140518 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:02:11.150207 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:02:11.711140 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:02:11.713141 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth as (
    select
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        lag(total_quarter_revenue) over (
            partition by service_type, pickup_quarter
            order by pickup_year
        ) as prev_year_revenue,
        (total_quarter_revenue - lag(total_quarter_revenue) over (
            partition by service_type, pickup_quarter 
            order by pickup_year
        )) / lag(total_quarter_revenue) over (
            partition by service_type, pickup_quarter
            order by pickup_year
        ) * 100 as yoy_growth
    from quarterly_revenue
    
)


select
    *
from quarterly_revenue_growth
order by yoy_growth desc
    );
  
[0m21:02:12.099153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f68c8e1a-3178-49cb-95c5-96be51b8111b&page=queryresults
[0m21:02:12.484791 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:f68c8e1a-3178-49cb-95c5-96be51b8111b&page=queryresults
[0m21:02:12.576923 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  division by zero: 0 / 0
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:02:12.578927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7656af61-0e26-4805-b1a5-66ece299f874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220421A350>]}
[0m21:02:12.578927 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy  [[31mERROR[0m in 1.44s]
[0m21:02:12.580933 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:02:12.581368 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  division by zero: 0 / 0
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql.
[0m21:02:12.583379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:12.585097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:12.585633 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:02:12.585633 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_staging' was properly closed.
[0m21:02:12.585633 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:02:12.585633 [info ] [MainThread]: 
[0m21:02:12.585633 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m21:02:12.588035 [debug] [MainThread]: Command end result
[0m21:02:12.612319 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:02:12.614796 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:02:12.619182 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:02:12.620187 [info ] [MainThread]: 
[0m21:02:12.620187 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:02:12.621187 [info ] [MainThread]: 
[0m21:02:12.621187 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  division by zero: 0 / 0
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:02:12.622163 [info ] [MainThread]: 
[0m21:02:12.622667 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:02:12.623990 [debug] [MainThread]: Command `dbt run` failed at 21:02:12.623990 after 5.77 seconds
[0m21:02:12.623990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DB086F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DBE63590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DBE63750>]}
[0m21:02:12.624546 [debug] [MainThread]: Flushing usage events
[0m21:02:13.257987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:47.582911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97506F510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9750C6ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97506C690>]}


============================== 21:03:47.585892 | 50dcf504-d10e-465e-a313-c48ba0b6981d ==============================
[0m21:03:47.585892 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:03:47.588498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'send_anonymous_usage_stats': 'True'}
[0m21:03:48.842011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50dcf504-d10e-465e-a313-c48ba0b6981d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B982E3C050>]}
[0m21:03:48.887703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50dcf504-d10e-465e-a313-c48ba0b6981d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9705CD650>]}
[0m21:03:48.888227 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:03:49.255257 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:03:49.456335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:03:49.457329 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:03:49.657932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50dcf504-d10e-465e-a313-c48ba0b6981d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B984763B50>]}
[0m21:03:49.735485 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:03:49.740000 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:03:49.847100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50dcf504-d10e-465e-a313-c48ba0b6981d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B984593190>]}
[0m21:03:49.848104 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:03:49.848104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50dcf504-d10e-465e-a313-c48ba0b6981d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9845C0A50>]}
[0m21:03:49.849105 [info ] [MainThread]: 
[0m21:03:49.850104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:03:49.850104 [info ] [MainThread]: 
[0m21:03:49.851104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:03:49.852106 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:03:49.853105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:50.795898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m21:03:50.797420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:51.244289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:03:51.246293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:51.727062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m21:03:51.727572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:52.219176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50dcf504-d10e-465e-a313-c48ba0b6981d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9840ABB50>]}
[0m21:03:52.220191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:52.225193 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:03:52.226194 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m21:03:52.227713 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m21:03:52.227713 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:03:52.233260 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:03:52.234261 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:03:52.245255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:03:52.760049 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:03:52.762050 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

WITH quarterly_revenue AS (
    SELECT 
        *
    FROM `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        
        -- Store previous year revenue only once for efficiency
        LAG(total_quarter_revenue) OVER (
            PARTITION BY service_type, pickup_quarter
            ORDER BY pickup_year
        ) AS prev_year_revenue,
        
        -- Calculate YoY growth safely, avoiding division by zero
        ROUND(
            (total_quarter_revenue - LAG(total_quarter_revenue) OVER (
                PARTITION BY service_type, pickup_quarter 
                ORDER BY pickup_year
            )) / NULLIF(LAG(total_quarter_revenue) OVER (
                PARTITION BY service_type, pickup_quarter
                ORDER BY pickup_year
            ), 0) * 100, 2
        ) AS yoy_growth_percentage

    FROM quarterly_revenue
)

SELECT * FROM quarterly_revenue_growth;
    );
  
[0m21:03:52.968921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:e8f38789-d833-46b2-8e35-1d0611a73275&page=queryresults
[0m21:03:52.969939 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:e8f38789-d833-46b2-8e35-1d0611a73275&page=queryresults
[0m21:03:52.977590 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [49:39]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:03:52.979619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50dcf504-d10e-465e-a313-c48ba0b6981d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B98411D410>]}
[0m21:03:52.980627 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy  [[31mERROR[0m in 0.75s]
[0m21:03:52.981619 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:03:52.982622 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [49:39]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql.
[0m21:03:52.984883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:52.985901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:52.987421 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:03:52.987421 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m21:03:52.988823 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:03:52.989330 [info ] [MainThread]: 
[0m21:03:52.990343 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m21:03:52.991346 [debug] [MainThread]: Command end result
[0m21:03:53.020123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:03:53.023142 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:03:53.028540 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:03:53.028540 [info ] [MainThread]: 
[0m21:03:53.029563 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:03:53.030559 [info ] [MainThread]: 
[0m21:03:53.030559 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [49:39]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:03:53.031559 [info ] [MainThread]: 
[0m21:03:53.032557 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:03:53.033557 [debug] [MainThread]: Command `dbt run` failed at 21:03:53.033557 after 5.53 seconds
[0m21:03:53.033557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B982E6F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B973E89AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9750635D0>]}
[0m21:03:53.035077 [debug] [MainThread]: Flushing usage events
[0m21:03:54.824350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:10.461883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E998E0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E998DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E9B6EE90>]}


============================== 21:05:10.466400 | bbf0461d-63af-4c3a-91c4-9d387a8a72fa ==============================
[0m21:05:10.466400 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:05:10.467405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile --select fct_taxi_trips_quarterly_yoy', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:05:11.643541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbf0461d-63af-4c3a-91c4-9d387a8a72fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E757EE10>]}
[0m21:05:11.683383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbf0461d-63af-4c3a-91c4-9d387a8a72fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E70E9F90>]}
[0m21:05:11.684372 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:05:12.047652 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:05:12.205078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:12.206082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:12.244334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbf0461d-63af-4c3a-91c4-9d387a8a72fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F504047050>]}
[0m21:05:12.315505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:05:12.319909 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:05:12.334864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbf0461d-63af-4c3a-91c4-9d387a8a72fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F502B1AA50>]}
[0m21:05:12.336199 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:05:12.336199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbf0461d-63af-4c3a-91c4-9d387a8a72fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F502EF9090>]}
[0m21:05:12.337206 [info ] [MainThread]: 
[0m21:05:12.338666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:12.338666 [info ] [MainThread]: 
[0m21:05:12.339671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:05:12.342063 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m21:05:12.343059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:13.971835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m21:05:13.973234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:14.457475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m21:05:14.457475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:14.953508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbf0461d-63af-4c3a-91c4-9d387a8a72fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50425C190>]}
[0m21:05:14.953508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:14.959043 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:05:14.960052 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m21:05:14.960052 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:05:14.965614 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:05:14.965614 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:05:14.967122 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:05:14.968728 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:05:14.968728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:14.968728 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m21:05:14.970311 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:05:14.970311 [debug] [MainThread]: Command end result
[0m21:05:14.996001 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:05:14.997082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:05:15.001842 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:05:15.001842 [info ] [MainThread]: Compiled node 'fct_taxi_trips_quarterly_yoy' is:


WITH quarterly_revenue AS (
    SELECT 
        *
    FROM `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        
        -- Store previous year revenue only once for efficiency
        LAG(total_quarter_revenue) OVER (
            PARTITION BY service_type, pickup_quarter
            ORDER BY pickup_year
        ) AS prev_year_revenue,
        
        -- Calculate YoY growth safely, avoiding division by zero
        ROUND(
            (total_quarter_revenue - LAG(total_quarter_revenue) OVER (
                PARTITION BY service_type, pickup_quarter 
                ORDER BY pickup_year
            )) / NULLIF(LAG(total_quarter_revenue) OVER (
                PARTITION BY service_type, pickup_quarter
                ORDER BY pickup_year
            ), 0) * 100, 2
        ) AS yoy_growth_percentage

    FROM quarterly_revenue
)

SELECT * FROM quarterly_revenue_growth;
[0m21:05:15.003250 [debug] [MainThread]: Command `dbt compile` succeeded at 21:05:15.003250 after 4.61 seconds
[0m21:05:15.004256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E2F1E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E2F1E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E2F1FA10>]}
[0m21:05:15.004256 [debug] [MainThread]: Flushing usage events
[0m21:05:16.675595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:54.619534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDB0C63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDB0C4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDB0C55D0>]}


============================== 21:05:54.623231 | 4022411e-da75-43de-a951-ed5c55a74dc7 ==============================
[0m21:05:54.623231 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:05:54.624322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:05:55.609103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4022411e-da75-43de-a951-ed5c55a74dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC02F1D0D0>]}
[0m21:05:55.646640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4022411e-da75-43de-a951-ed5c55a74dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD6589B10>]}
[0m21:05:55.647667 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:05:55.978356 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:05:56.131663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:56.131663 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:56.171607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4022411e-da75-43de-a951-ed5c55a74dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0442EB50>]}
[0m21:05:56.241597 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:05:56.247107 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:05:56.266446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4022411e-da75-43de-a951-ed5c55a74dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDB0785D0>]}
[0m21:05:56.266446 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:05:56.267357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4022411e-da75-43de-a951-ed5c55a74dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD6592110>]}
[0m21:05:56.268359 [info ] [MainThread]: 
[0m21:05:56.269359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:56.269359 [info ] [MainThread]: 
[0m21:05:56.270357 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:05:56.271473 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:05:56.272358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:57.871267 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m21:05:57.871267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:58.321995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:05:58.323499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:58.807452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m21:05:58.808957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:59.303710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4022411e-da75-43de-a951-ed5c55a74dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC04507CD0>]}
[0m21:05:59.304808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:59.309795 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:05:59.310815 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m21:05:59.311799 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m21:05:59.311799 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:05:59.320441 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:05:59.321446 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:05:59.332006 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:05:59.875233 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:05:59.876236 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

WITH quarterly_revenue AS (
    SELECT 
        *
    FROM `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, quarterly_revenue_growth AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        
        -- Store previous year revenue only once for efficiency
        LAG(total_quarter_revenue) OVER (
            PARTITION BY service_type, pickup_quarter
            ORDER BY pickup_year
        ) AS prev_year_revenue,
        
        -- Calculate YoY growth safely, avoiding division by zero
        ROUND(
            (total_quarter_revenue - LAG(total_quarter_revenue) OVER (
                PARTITION BY service_type, pickup_quarter 
                ORDER BY pickup_year
            )) / NULLIF(LAG(total_quarter_revenue) OVER (
                PARTITION BY service_type, pickup_quarter
                ORDER BY pickup_year
            ), 0) * 100, 2
        ) AS yoy_growth_percentage

    FROM quarterly_revenue
)

SELECT * FROM quarterly_revenue_growth;
    );
  
[0m21:06:00.087457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:63097af0-7c0f-48c1-80d9-5199a86bbb45&page=queryresults
[0m21:06:00.088466 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:63097af0-7c0f-48c1-80d9-5199a86bbb45&page=queryresults
[0m21:06:00.094549 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [49:39]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:06:00.096556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4022411e-da75-43de-a951-ed5c55a74dc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC04357210>]}
[0m21:06:00.096556 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy  [[31mERROR[0m in 0.78s]
[0m21:06:00.097548 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:06:00.098548 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [49:39]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql.
[0m21:06:00.099548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:06:00.101548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:00.101548 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:06:00.102549 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m21:06:00.102549 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:06:00.103548 [info ] [MainThread]: 
[0m21:06:00.103548 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m21:06:00.104569 [debug] [MainThread]: Command end result
[0m21:06:00.204718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:06:00.206727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:06:00.211228 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:06:00.211731 [info ] [MainThread]: 
[0m21:06:00.211731 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:06:00.213244 [info ] [MainThread]: 
[0m21:06:00.214260 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [49:39]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:06:00.214260 [info ] [MainThread]: 
[0m21:06:00.215454 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:06:00.216453 [debug] [MainThread]: Command `dbt run` failed at 21:06:00.216453 after 5.65 seconds
[0m21:06:00.216453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC04809A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0480AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC04808150>]}
[0m21:06:00.217453 [debug] [MainThread]: Flushing usage events
[0m21:06:00.817925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:07.789730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F43C45D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F43C5A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F436C110>]}


============================== 21:07:07.795437 | 02fc5b9c-c99d-4c2e-8a61-ab5ab07ae1c0 ==============================
[0m21:07:07.795437 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:07:07.796445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:07:08.960036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02fc5b9c-c99d-4c2e-8a61-ab5ab07ae1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F2EFBDD0>]}
[0m21:07:08.998731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02fc5b9c-c99d-4c2e-8a61-ab5ab07ae1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EF8999D0>]}
[0m21:07:08.999732 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:07:09.407248 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:07:09.594114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:07:09.595121 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:07:09.769653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02fc5b9c-c99d-4c2e-8a61-ab5ab07ae1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B50395BA90>]}
[0m21:07:09.835651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:07:09.838660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:07:09.935317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02fc5b9c-c99d-4c2e-8a61-ab5ab07ae1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B50382BA90>]}
[0m21:07:09.936322 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:07:09.937323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02fc5b9c-c99d-4c2e-8a61-ab5ab07ae1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5036AD150>]}
[0m21:07:09.938323 [info ] [MainThread]: 
[0m21:07:09.939324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:07:09.940406 [info ] [MainThread]: 
[0m21:07:09.941398 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:07:09.942391 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:07:09.942391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:10.443652 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m21:07:10.443652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:10.945717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:07:10.955979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:11.406853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m21:07:11.407870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:11.861719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02fc5b9c-c99d-4c2e-8a61-ab5ab07ae1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B50362DC90>]}
[0m21:07:11.862710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:07:11.866461 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:07:11.866461 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m21:07:11.867410 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m21:07:11.868350 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:07:11.873354 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:07:11.874433 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:07:11.886596 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:07:12.372409 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:07:12.374406 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

WITH quarterly_revenue AS (
    SELECT
        *
    FROM `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, previous_revenue AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        
        -- Compute previous year's revenue ONCE
        LAG(total_quarter_revenue) OVER (
            PARTITION BY service_type, pickup_quarter
            ORDER BY pickup_year
        ) AS prev_year_revenue
    FROM quarterly_revenue
)

SELECT
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    total_quarter_revenue,
    prev_year_revenue,

    -- Ensure proper division and rounding
    ROUND(
        (total_quarter_revenue - prev_year_revenue) / NULLIF(prev_year_revenue, 0) * 100,
        2
    ) AS yoy_growth_percentage

FROM previous_revenue;
    );
  
[0m21:07:12.668376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:3b6118cd-dd2d-49cf-8388-e7bdf5d1f608&page=queryresults
[0m21:07:12.668376 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:3b6118cd-dd2d-49cf-8388-e7bdf5d1f608&page=queryresults
[0m21:07:12.678912 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [51:22]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:07:12.679909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02fc5b9c-c99d-4c2e-8a61-ab5ab07ae1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5032AF210>]}
[0m21:07:12.680908 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy  [[31mERROR[0m in 0.81s]
[0m21:07:12.681908 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:07:12.682906 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [51:22]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql.
[0m21:07:12.683912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:07:12.685422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:12.686436 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:07:12.686436 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m21:07:12.686436 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:07:12.686436 [info ] [MainThread]: 
[0m21:07:12.687434 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m21:07:12.688443 [debug] [MainThread]: Command end result
[0m21:07:12.714268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:07:12.716798 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:07:12.720810 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:07:12.721810 [info ] [MainThread]: 
[0m21:07:12.721810 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:07:12.722814 [info ] [MainThread]: 
[0m21:07:12.723820 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [51:22]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:07:12.723820 [info ] [MainThread]: 
[0m21:07:12.723820 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:07:12.725338 [debug] [MainThread]: Command `dbt run` failed at 21:07:12.725338 after 5.02 seconds
[0m21:07:12.726355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EF880FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F4363790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F43639D0>]}
[0m21:07:12.726355 [debug] [MainThread]: Flushing usage events
[0m21:07:14.412679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:25.357380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20246EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20246C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20246C950>]}


============================== 21:07:25.364378 | 492cd4f4-e756-41b6-afc5-e633cd65df87 ==============================
[0m21:07:25.364378 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:07:25.365380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile --select fct_taxi_trips_quarterly_yoy', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:07:26.561090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '492cd4f4-e756-41b6-afc5-e633cd65df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F230D7F2D0>]}
[0m21:07:26.598433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '492cd4f4-e756-41b6-afc5-e633cd65df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27D9ED6D0>]}
[0m21:07:26.599427 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:07:26.933195 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:07:27.087583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:07:27.088582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:07:27.129466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '492cd4f4-e756-41b6-afc5-e633cd65df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2359ECA50>]}
[0m21:07:27.204560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:07:27.209603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:07:27.226137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '492cd4f4-e756-41b6-afc5-e633cd65df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F235406DD0>]}
[0m21:07:27.227137 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:07:27.227137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '492cd4f4-e756-41b6-afc5-e633cd65df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2353E2950>]}
[0m21:07:27.229136 [info ] [MainThread]: 
[0m21:07:27.229136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:07:27.230129 [info ] [MainThread]: 
[0m21:07:27.230129 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:07:27.233653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m21:07:27.233653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:27.712611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m21:07:27.713614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:28.187683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data)
[0m21:07:28.189683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:28.671023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '492cd4f4-e756-41b6-afc5-e633cd65df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F235930F10>]}
[0m21:07:28.671962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:07:28.676659 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:07:28.677582 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m21:07:28.677582 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:07:28.684659 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:07:28.686269 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:07:28.686269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:07:28.688382 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:07:28.689357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:28.690268 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m21:07:28.690268 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:07:28.691361 [debug] [MainThread]: Command end result
[0m21:07:28.714501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:07:28.716876 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:07:28.720871 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:07:28.720871 [info ] [MainThread]: Compiled node 'fct_taxi_trips_quarterly_yoy' is:


WITH quarterly_revenue AS (
    SELECT
        *
    FROM `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, previous_revenue AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,
        
        -- Compute previous year's revenue ONCE
        LAG(total_quarter_revenue) OVER (
            PARTITION BY service_type, pickup_quarter
            ORDER BY pickup_year
        ) AS prev_year_revenue
    FROM quarterly_revenue
)

SELECT
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    total_quarter_revenue,
    prev_year_revenue,

    -- Ensure proper division and rounding
    ROUND(
        (total_quarter_revenue - prev_year_revenue) / NULLIF(prev_year_revenue, 0) * 100,
        2
    ) AS yoy_growth_percentage

FROM previous_revenue;
[0m21:07:28.722795 [debug] [MainThread]: Command `dbt compile` succeeded at 21:07:28.722795 after 3.44 seconds
[0m21:07:28.722795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F200F86BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27CC2E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27CC2E910>]}
[0m21:07:28.722795 [debug] [MainThread]: Flushing usage events
[0m21:07:29.305259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:11:25.036605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650106DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265010C4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265010A8390>]}


============================== 21:11:25.041604 | a535ebdb-8778-4989-b4dd-641a42308cd1 ==============================
[0m21:11:25.041604 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:11:25.042605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:26.498872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a535ebdb-8778-4989-b4dd-641a42308cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026532FF3F50>]}
[0m21:11:26.537449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a535ebdb-8778-4989-b4dd-641a42308cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FC61D690>]}
[0m21:11:26.538447 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:11:26.903891 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:11:27.095593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:11:27.095593 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:11:27.277956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a535ebdb-8778-4989-b4dd-641a42308cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026534742610>]}
[0m21:11:27.349878 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:11:27.353389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:11:27.449623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a535ebdb-8778-4989-b4dd-641a42308cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026534593290>]}
[0m21:11:27.450626 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:11:27.450626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a535ebdb-8778-4989-b4dd-641a42308cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265344AD410>]}
[0m21:11:27.452625 [info ] [MainThread]: 
[0m21:11:27.453134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:11:27.454134 [info ] [MainThread]: 
[0m21:11:27.455138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:11:27.457136 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:11:27.458137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:28.125374 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_staging'
[0m21:11:28.125374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:28.623656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m21:11:28.624658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:29.130642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m21:11:29.139835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:29.596416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a535ebdb-8778-4989-b4dd-641a42308cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653411DA90>]}
[0m21:11:29.596416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:11:29.601415 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:11:29.602921 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m21:11:29.603925 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m21:11:29.603925 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:11:29.609936 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:11:29.610928 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:11:29.619452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:11:30.112300 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:11:30.113307 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

WITH quarterly_revenue AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue
    FROM `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, previous_revenue AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,

        -- Compute previous year's revenue ONCE
        LAG(total_quarter_revenue) OVER (
            PARTITION BY service_type, pickup_quarter
            ORDER BY pickup_year
        ) AS prev_year_revenue
    FROM quarterly_revenue
)

SELECT
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    total_quarter_revenue,
    prev_year_revenue,

    -- Ensure proper division and rounding
    ROUND(
        SAFE_DIVIDE(total_quarter_revenue - prev_year_revenue, prev_year_revenue) * 100,
        2
    ) AS yoy_growth_percentage

FROM previous_revenue;
    );
  
[0m21:11:30.347546 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:abb3bbb6-52ab-4c54-8ddb-cef32680c7ac&page=queryresults
[0m21:11:30.348548 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:abb3bbb6-52ab-4c54-8ddb-cef32680c7ac&page=queryresults
[0m21:11:30.357254 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [55:22]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:11:30.359390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a535ebdb-8778-4989-b4dd-641a42308cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265343ABF90>]}
[0m21:11:30.360485 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy  [[31mERROR[0m in 0.76s]
[0m21:11:30.361545 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:11:30.363053 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [55:22]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql.
[0m21:11:30.365325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:11:30.367002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:30.367529 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:11:30.368050 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m21:11:30.368050 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:11:30.368571 [info ] [MainThread]: 
[0m21:11:30.369086 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m21:11:30.370115 [debug] [MainThread]: Command end result
[0m21:11:30.394646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:11:30.398647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:11:30.404086 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:11:30.404592 [info ] [MainThread]: 
[0m21:11:30.405655 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:11:30.406185 [info ] [MainThread]: 
[0m21:11:30.407252 [error] [MainThread]:   Database Error in model fct_taxi_trips_quarterly_yoy (models\core\fct_taxi_trips_quarterly_yoy.sql)
  Syntax error: Expected ")" but got ";" at [55:22]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:11:30.407802 [info ] [MainThread]: 
[0m21:11:30.408406 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:11:30.409660 [debug] [MainThread]: Command `dbt run` failed at 21:11:30.409019 after 5.44 seconds
[0m21:11:30.410883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265010C5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FFE91AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FB8BE990>]}
[0m21:11:30.411414 [debug] [MainThread]: Flushing usage events
[0m21:11:31.255447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:50.498017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082CDC7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082CB8E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082CB8DE50>]}


============================== 21:12:50.504195 | 8e95520c-78e3-4895-806f-29ea7c9c7d33 ==============================
[0m21:12:50.504195 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:12:50.505195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_taxi_trips_quarterly_yoy', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:12:52.131396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e95520c-78e3-4895-806f-29ea7c9c7d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002085FCDE510>]}
[0m21:12:52.170819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e95520c-78e3-4895-806f-29ea7c9c7d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082A3DD810>]}
[0m21:12:52.171822 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:12:52.487783 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:12:52.652027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:12:52.652530 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_quarterly_yoy.sql
[0m21:12:52.825077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e95520c-78e3-4895-806f-29ea7c9c7d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208613D3890>]}
[0m21:12:52.885387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:12:52.889338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:12:52.978366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e95520c-78e3-4895-806f-29ea7c9c7d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020861291190>]}
[0m21:12:52.979354 [info ] [MainThread]: Found 7 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:12:52.979354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e95520c-78e3-4895-806f-29ea7c9c7d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020861436D50>]}
[0m21:12:52.980590 [info ] [MainThread]: 
[0m21:12:52.981589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:12:52.981589 [info ] [MainThread]: 
[0m21:12:52.982589 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:12:52.983602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:12:52.983602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:53.498508 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m21:12:53.499539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:53.947865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:12:53.949368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:55.060635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m21:12:55.060635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:55.533626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e95520c-78e3-4895-806f-29ea7c9c7d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002085FD53AD0>]}
[0m21:12:55.535626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:55.538227 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:12:55.539743 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy ....... [RUN]
[0m21:12:55.540754 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy'
[0m21:12:55.540754 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:12:55.547754 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:12:55.548752 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:12:55.558258 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:12:56.045172 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"
[0m21:12:56.046453 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_yoy`
      
    
    

    OPTIONS()
    as (
      

WITH quarterly_revenue AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue
    FROM `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_quarterly_revenue`
)

, previous_revenue AS (
    SELECT
        service_type,
        pickup_quarter,
        pickup_year,
        pickup_quarter_year,
        total_quarter_revenue,

        -- Compute previous year's revenue ONCE
        LAG(total_quarter_revenue) OVER (
            PARTITION BY service_type, pickup_quarter
            ORDER BY pickup_year
        ) AS prev_year_revenue
    FROM quarterly_revenue
)

SELECT
    service_type,
    pickup_quarter,
    pickup_year,
    pickup_quarter_year,
    total_quarter_revenue,
    prev_year_revenue,

    -- Ensure proper division and rounding
    ROUND(
        SAFE_DIVIDE(total_quarter_revenue - prev_year_revenue, prev_year_revenue) * 100,
        2
    ) AS yoy_growth_percentage

FROM previous_revenue
    );
  
[0m21:12:56.437632 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:bdd5ea51-a1f8-4c33-ae3c-dc1ba94443b6&page=queryresults
[0m21:12:58.673498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e95520c-78e3-4895-806f-29ea7c9c7d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002085FD6C410>]}
[0m21:12:58.674500 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_quarterly_yoy .. [[32mCREATE TABLE (43.0 rows, 1.8 KiB processed)[0m in 3.13s]
[0m21:12:58.675539 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy
[0m21:12:58.677606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:12:58.679498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:58.680673 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:12:58.680673 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m21:12:58.680673 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_quarterly_yoy' was properly closed.
[0m21:12:58.681674 [info ] [MainThread]: 
[0m21:12:58.682674 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m21:12:58.683674 [debug] [MainThread]: Command end result
[0m21:12:58.704804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:12:58.706811 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:12:58.710646 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:12:58.710646 [info ] [MainThread]: 
[0m21:12:58.711657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:12:58.712651 [info ] [MainThread]: 
[0m21:12:58.712651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:12:58.713650 [debug] [MainThread]: Command `dbt run` succeeded at 21:12:58.713650 after 8.30 seconds
[0m21:12:58.713650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082854E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082854E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082854FA10>]}
[0m21:12:58.714650 [debug] [MainThread]: Flushing usage events
[0m21:13:00.384442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:17:31.654391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18B6C3F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18B66F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18B66E210>]}


============================== 21:17:31.662418 | 4f208159-94cb-4cb2-a5c0-b5affe48126a ==============================
[0m21:17:31.662418 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:17:31.663414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_monthly_fare_p95', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:17:33.262735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f208159-94cb-4cb2-a5c0-b5affe48126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18B1A1C10>]}
[0m21:17:33.301795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f208159-94cb-4cb2-a5c0-b5affe48126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F186B78690>]}
[0m21:17:33.302797 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:17:33.653879 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:17:33.855565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:17:33.856574 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://models\core\fct_taxi_trips_monthly_fare_p95.sql
[0m21:17:34.080743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f208159-94cb-4cb2-a5c0-b5affe48126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1BEABBA10>]}
[0m21:17:34.151911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:17:34.156439 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:17:34.258802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f208159-94cb-4cb2-a5c0-b5affe48126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1BE61CD10>]}
[0m21:17:34.259329 [info ] [MainThread]: Found 8 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:17:34.259860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f208159-94cb-4cb2-a5c0-b5affe48126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1BEA91F50>]}
[0m21:17:34.261452 [info ] [MainThread]: 
[0m21:17:34.261984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:17:34.262506 [info ] [MainThread]: 
[0m21:17:34.263552 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:17:34.264604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:17:34.265126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:34.878676 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m21:17:34.879591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:35.381509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:17:35.390246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:35.906921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m21:17:35.908042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:36.406212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f208159-94cb-4cb2-a5c0-b5affe48126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1BE61C450>]}
[0m21:17:36.407310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:36.411676 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:17:36.412250 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_monthly_fare_p95 .... [RUN]
[0m21:17:36.413322 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95'
[0m21:17:36.413322 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:17:36.418091 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"
[0m21:17:36.419416 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:17:36.448530 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"
[0m21:17:36.450111 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_monthly_fare_p95`
      
    
    

    OPTIONS()
    as (
      

with filtered_trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
    WHERE fare_amount > 0 and trip_distance > 0 and payment_type_description in ('Cash', 'Credit card')
)

SELECT
    service_type,
    pickup_year,
    pickup_month,
    PERCENTILE_CONT(fare_amount, 0.97) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p97,
    PERCENTILE_CONT(fare_amount, 0.95) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p95,
    PERCENTILE_CONT(fare_amount, 0.90) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p90
FROM filtered_trips
    );
  
[0m21:17:36.450111 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:17:37.194028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:a6c3ce19-77ac-4681-96a5-02caac55243b&page=queryresults
[0m21:18:13.378842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f208159-94cb-4cb2-a5c0-b5affe48126a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18B179490>]}
[0m21:18:13.379740 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_monthly_fare_p95  [[32mCREATE TABLE (60.4m rows, 3.4 GiB processed)[0m in 36.96s]
[0m21:18:13.380732 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:18:13.382733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:13.383733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:13.385160 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:18:13.385160 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m21:18:13.385160 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95' was properly closed.
[0m21:18:13.385160 [info ] [MainThread]: 
[0m21:18:13.386625 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 39.12 seconds (39.12s).
[0m21:18:13.386625 [debug] [MainThread]: Command end result
[0m21:18:13.414084 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:18:13.417585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:18:13.423090 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:18:13.423464 [info ] [MainThread]: 
[0m21:18:13.424574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:13.425078 [info ] [MainThread]: 
[0m21:18:13.425733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:18:13.427247 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:13.426743 after 41.86 seconds
[0m21:18:13.427247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18B6E5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F185DBF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F185DBE910>]}
[0m21:18:13.428310 [debug] [MainThread]: Flushing usage events
[0m21:18:15.241947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:25.144535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEE36F950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEE36C890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDEE36EDD0>]}


============================== 21:19:25.150612 | 9d270768-536d-4504-a980-2dbf2307346d ==============================
[0m21:19:25.150612 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:19:25.152048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select +fct_taxi_trips_monthly_fare_p95', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:19:26.491181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDECE79B50>]}
[0m21:19:26.530701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE996D9D0>]}
[0m21:19:26.531717 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:19:26.879564 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:19:27.076731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:19:27.076731 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fact_trips.sql
[0m21:19:27.318984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03743F10>]}
[0m21:19:27.465027 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:19:27.468976 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:19:27.499261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE033D8BD0>]}
[0m21:19:27.500775 [info ] [MainThread]: Found 8 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:19:27.501783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03232650>]}
[0m21:19:27.503792 [info ] [MainThread]: 
[0m21:19:27.504784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:27.504784 [info ] [MainThread]: 
[0m21:19:27.505799 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:19:27.508790 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:19:27.509790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:28.152440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:28.692560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m21:19:28.692560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:29.165079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_core)
[0m21:19:29.175730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:29.659497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:19:29.660924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:30.164826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE9C2E910>]}
[0m21:19:30.165330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:30.169342 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m21:19:30.169342 [info ] [Thread-1 (]: 1 of 5 START sql table model taxi_data_core.dim_zones .......................... [RUN]
[0m21:19:30.170849 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.dim_zones'
[0m21:19:30.171855 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m21:19:30.178358 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m21:19:30.179362 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m21:19:30.194880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:19:30.664972 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m21:19:30.665974 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `tough-timing-449701-k0`.`taxi_data`.`taxi_zone_lookup`
    );
  
[0m21:19:31.035751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:63631b5d-3e75-4769-8ad0-10a8266212a1&page=queryresults
[0m21:19:33.219359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03B636D0>]}
[0m21:19:33.220915 [info ] [Thread-1 (]: 1 of 5 OK created sql table model taxi_data_core.dim_zones ..................... [[32mCREATE TABLE (265.0 rows, 14.2 KiB processed)[0m in 3.05s]
[0m21:19:33.221921 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m21:19:33.221921 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m21:19:33.223047 [info ] [Thread-1 (]: 2 of 5 START sql view model taxi_data_staging.stg_green_tripdata ............... [RUN]
[0m21:19:33.223047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now model.taxi_rides_ny.stg_green_tripdata)
[0m21:19:33.224031 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m21:19:33.241103 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m21:19:33.242108 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m21:19:33.255800 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m21:19:33.258776 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    CASE
    WHEN payment_type = 1 THEN 'Credit card'
    WHEN payment_type = 2 THEN 'Cash'
    WHEN payment_type = 3 THEN 'No charge'
    WHEN payment_type = 4 THEN 'Dispute'
    WHEN payment_type = 5 THEN 'Unknown'
    WHEN payment_type = 0 THEN 'Voided trip'
    ELSE 'EMPTY'  
  END as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'
;


[0m21:19:33.259730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:33.935812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:4046ffe3-bfa1-435e-8b12-d600be8b8226&page=queryresults
[0m21:19:34.338294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03ED5E90>]}
[0m21:19:34.338294 [info ] [Thread-1 (]: 2 of 5 OK created sql view model taxi_data_staging.stg_green_tripdata .......... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m21:19:34.339399 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m21:19:34.339399 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:19:34.340959 [info ] [Thread-1 (]: 3 of 5 START sql view model taxi_data_staging.stg_yellow_tripdata .............. [RUN]
[0m21:19:34.340959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m21:19:34.340959 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:19:34.347974 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:19:34.350487 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:19:34.353497 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:19:34.356021 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `tough-timing-449701-k0`.`taxi_data`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    CASE
    WHEN payment_type = 1 THEN 'Credit card'
    WHEN payment_type = 2 THEN 'Cash'
    WHEN payment_type = 3 THEN 'No charge'
    WHEN payment_type = 4 THEN 'Dispute'
    WHEN payment_type = 5 THEN 'Unknown'
    WHEN payment_type = 0 THEN 'Voided trip'
    ELSE 'EMPTY'  
  END as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
;


[0m21:19:34.357010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:35.030769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:ccc3991a-bfc5-4621-b775-fea9395ec008&page=queryresults
[0m21:19:35.404193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03F00E90>]}
[0m21:19:35.405958 [info ] [Thread-1 (]: 3 of 5 OK created sql view model taxi_data_staging.stg_yellow_tripdata ......... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m21:19:35.406581 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:19:35.407574 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m21:19:35.408586 [info ] [Thread-1 (]: 4 of 5 START sql table model taxi_data_core.fact_trips ......................... [RUN]
[0m21:19:35.408586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now model.taxi_rides_ny.fact_trips)
[0m21:19:35.408586 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m21:19:35.411285 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m21:19:35.412278 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m21:19:35.414372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:35.925490 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m21:19:35.926511 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `tough-timing-449701-k0`.`taxi_data_staging`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `tough-timing-449701-k0`.`taxi_data_core`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description,
    SAFE_CAST(format_date('%Y', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_year,
    SAFE_CAST(format_date('%m', date(trips_unioned.pickup_datetime)) AS INTEGER) as pickup_month,
    format_date('%Y-%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter_year,
    format_date('%Q', date(trips_unioned.pickup_datetime)) as pickup_quarter
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m21:19:36.552972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:4be4250b-e93a-4c75-9350-9f0392c7bb10&page=queryresults
[0m21:19:50.857660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03FC67D0>]}
[0m21:19:50.858662 [info ] [Thread-1 (]: 4 of 5 OK created sql table model taxi_data_core.fact_trips .................... [[32mCREATE TABLE (61.6m rows, 19.4 GiB processed)[0m in 15.45s]
[0m21:19:50.859661 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m21:19:50.860661 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:19:50.861165 [info ] [Thread-1 (]: 5 of 5 START sql table model taxi_data_core.fct_taxi_trips_monthly_fare_p95 .... [RUN]
[0m21:19:50.861165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fact_trips, now model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95)
[0m21:19:50.862173 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:19:50.864178 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"
[0m21:19:50.864178 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:19:50.866177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:51.331719 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"
[0m21:19:51.332772 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_monthly_fare_p95`
      
    
    

    OPTIONS()
    as (
      

with filtered_trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
    WHERE fare_amount > 0 and trip_distance > 0 and payment_type_description in ('Cash', 'Credit card')
)

SELECT
    service_type,
    pickup_year,
    pickup_month,
    PERCENTILE_CONT(fare_amount, 0.97) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p97,
    PERCENTILE_CONT(fare_amount, 0.95) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p95,
    PERCENTILE_CONT(fare_amount, 0.90) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p90
FROM filtered_trips
    );
  
[0m21:19:51.669817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:5b384bde-53ba-4809-b0a7-50417a9c5cd2&page=queryresults
[0m21:20:02.139396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d270768-536d-4504-a980-2dbf2307346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE03FD0650>]}
[0m21:20:02.139396 [info ] [Thread-1 (]: 5 of 5 OK created sql table model taxi_data_core.fct_taxi_trips_monthly_fare_p95  [[32mCREATE TABLE (60.4m rows, 3.8 GiB processed)[0m in 11.28s]
[0m21:20:02.140904 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:20:02.142974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:02.143978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:02.144979 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:20:02.144979 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_staging' was properly closed.
[0m21:20:02.144979 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95' was properly closed.
[0m21:20:02.146060 [info ] [MainThread]: 
[0m21:20:02.146060 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 34.64 seconds (34.64s).
[0m21:20:02.148061 [debug] [MainThread]: Command end result
[0m21:20:02.176334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:20:02.181662 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:20:02.188905 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:20:02.189424 [info ] [MainThread]: 
[0m21:20:02.190458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:02.191001 [info ] [MainThread]: 
[0m21:20:02.191536 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:20:02.193126 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:02.192590 after 37.19 seconds
[0m21:20:02.193680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE8BFE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE8BFE910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDE8BFFA50>]}
[0m21:20:02.194206 [debug] [MainThread]: Flushing usage events
[0m21:20:04.035165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:22:45.278218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012BD6F210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012BD6C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012BD6F810>]}


============================== 21:22:45.284062 | 526878bb-f2bf-4632-8996-a0e181618279 ==============================
[0m21:22:45.284062 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:22:45.284062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_taxi_trips_monthly_fare_p95', 'send_anonymous_usage_stats': 'True'}
[0m21:22:46.903062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '526878bb-f2bf-4632-8996-a0e181618279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012B2714D0>]}
[0m21:22:46.944065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '526878bb-f2bf-4632-8996-a0e181618279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201292DD550>]}
[0m21:22:46.945065 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:22:47.302199 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:22:47.468547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:22:47.469549 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_monthly_fare_p95.sql
[0m21:22:47.648913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '526878bb-f2bf-4632-8996-a0e181618279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020160427F50>]}
[0m21:22:47.715422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:22:47.719430 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:22:47.794140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '526878bb-f2bf-4632-8996-a0e181618279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020160289C50>]}
[0m21:22:47.795141 [info ] [MainThread]: Found 8 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:22:47.795141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526878bb-f2bf-4632-8996-a0e181618279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201604ABF10>]}
[0m21:22:47.796141 [info ] [MainThread]: 
[0m21:22:47.797143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:22:47.797143 [info ] [MainThread]: 
[0m21:22:47.798141 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:22:47.799142 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:22:47.799142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:49.380805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data_core'
[0m21:22:49.380805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:49.858441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_core, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:22:49.860058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:22:50.400228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data)
[0m21:22:50.402223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:22:50.927630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526878bb-f2bf-4632-8996-a0e181618279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015EC4B8D0>]}
[0m21:22:50.927630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:22:50.931623 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:22:50.931623 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_monthly_fare_p95 .... [RUN]
[0m21:22:50.932623 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95'
[0m21:22:50.933625 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:22:50.938630 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"
[0m21:22:50.939625 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:22:50.949624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:22:51.464449 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"
[0m21:22:51.465449 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_monthly_fare_p95`
      
    
    

    OPTIONS()
    as (
      

with filtered_trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
    WHERE fare_amount > 0 and trip_distance > 0 and payment_type_description in ('Cash', 'Credit card')
)

SELECT
    service_type,
    pickup_year,
    pickup_month,
    PERCENTILE_CONT(fare_amount, 0.97) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p97,
    PERCENTILE_CONT(fare_amount, 0.95) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p95,
    PERCENTILE_CONT(fare_amount, 0.90) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p90
FROM filtered_trips
GROUP BY service_type, pickup_year, pickup_month
    );
  
[0m21:22:51.895386 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:590c1438-9d47-475c-92ff-a3c74179309c&page=queryresults
[0m21:22:52.077699 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:590c1438-9d47-475c-92ff-a3c74179309c&page=queryresults
[0m21:22:52.086862 [debug] [Thread-1 (]: Database Error in model fct_taxi_trips_monthly_fare_p95 (models\core\fct_taxi_trips_monthly_fare_p95.sql)
  SELECT list expression references column fare_amount which is neither grouped nor aggregated at [26:21]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_monthly_fare_p95.sql
[0m21:22:52.089000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526878bb-f2bf-4632-8996-a0e181618279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015EBE5950>]}
[0m21:22:52.090006 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model taxi_data_core.fct_taxi_trips_monthly_fare_p95  [[31mERROR[0m in 1.15s]
[0m21:22:52.090557 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:22:52.091595 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95' to be skipped because of status 'error'.  Reason: Database Error in model fct_taxi_trips_monthly_fare_p95 (models\core\fct_taxi_trips_monthly_fare_p95.sql)
  SELECT list expression references column fare_amount which is neither grouped nor aggregated at [26:21]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_monthly_fare_p95.sql.
[0m21:22:52.093084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:22:52.094077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:52.094580 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:22:52.094914 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data' was properly closed.
[0m21:22:52.094914 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95' was properly closed.
[0m21:22:52.095417 [info ] [MainThread]: 
[0m21:22:52.096043 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m21:22:52.096709 [debug] [MainThread]: Command end result
[0m21:22:52.121514 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:22:52.123816 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:22:52.128527 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:22:52.129037 [info ] [MainThread]: 
[0m21:22:52.129556 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:22:52.130071 [info ] [MainThread]: 
[0m21:22:52.131138 [error] [MainThread]:   Database Error in model fct_taxi_trips_monthly_fare_p95 (models\core\fct_taxi_trips_monthly_fare_p95.sql)
  SELECT list expression references column fare_amount which is neither grouped nor aggregated at [26:21]
  compiled code at target\run\taxi_rides_ny\models\core\fct_taxi_trips_monthly_fare_p95.sql
[0m21:22:52.131651 [info ] [MainThread]: 
[0m21:22:52.131651 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:22:52.133232 [debug] [MainThread]: Command `dbt run` failed at 21:22:52.133232 after 7.02 seconds
[0m21:22:52.133779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012BC5AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012BE01050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012BD637D0>]}
[0m21:22:52.133779 [debug] [MainThread]: Flushing usage events
[0m21:22:53.854948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:56.460059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A1D6E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A1D6E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A1D6CA10>]}


============================== 21:23:56.464076 | 8dd4afb5-e27b-4b50-90a6-2f2dfea49505 ==============================
[0m21:23:56.464076 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:23:56.465071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\watan\\Documents\\GitHub\\Data-Engineering-Zoomcamp-answers\\Data-Engineering-Zoomcamp-answers\\Module_04\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_taxi_trips_monthly_fare_p95', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:23:57.760521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dd4afb5-e27b-4b50-90a6-2f2dfea49505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A1873750>]}
[0m21:23:57.796585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dd4afb5-e27b-4b50-90a6-2f2dfea49505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769F3DDA90>]}
[0m21:23:57.796585 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m21:23:58.119808 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:23:58.286814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:23:58.288325 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models\core\fct_taxi_trips_monthly_fare_p95.sql
[0m21:23:58.462090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dd4afb5-e27b-4b50-90a6-2f2dfea49505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D613E510>]}
[0m21:23:58.533627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:23:58.536627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:23:58.628589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dd4afb5-e27b-4b50-90a6-2f2dfea49505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A197A090>]}
[0m21:23:58.628589 [info ] [MainThread]: Found 8 models, 1 seed, 11 data tests, 2 sources, 628 macros
[0m21:23:58.630589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd4afb5-e27b-4b50-90a6-2f2dfea49505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D61FF650>]}
[0m21:23:58.631587 [info ] [MainThread]: 
[0m21:23:58.632594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:58.633587 [info ] [MainThread]: 
[0m21:23:58.634586 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:23:58.634586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0'
[0m21:23:58.635587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:59.192256 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tough-timing-449701-k0_taxi_data'
[0m21:23:59.193217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:59.684529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data, now list_tough-timing-449701-k0_taxi_data_staging)
[0m21:23:59.696057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:00.215392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tough-timing-449701-k0_taxi_data_staging, now list_tough-timing-449701-k0_taxi_data_core)
[0m21:24:00.216520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:00.760458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd4afb5-e27b-4b50-90a6-2f2dfea49505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D46C1650>]}
[0m21:24:00.761466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:24:00.767403 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:24:00.767403 [info ] [Thread-1 (]: 1 of 1 START sql table model taxi_data_core.fct_taxi_trips_monthly_fare_p95 .... [RUN]
[0m21:24:00.769371 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95'
[0m21:24:00.769371 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:24:00.775458 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"
[0m21:24:00.776423 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:24:00.784566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:24:01.264069 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"
[0m21:24:01.265065 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95"} */

  
    

    create or replace table `tough-timing-449701-k0`.`taxi_data_core`.`fct_taxi_trips_monthly_fare_p95`
      
    
    

    OPTIONS()
    as (
      

with filtered_trips as (
    select 
        *
    from `tough-timing-449701-k0`.`taxi_data_core`.`fact_trips`
    WHERE fare_amount > 0 and trip_distance > 0 and payment_type_description in ('Cash', 'Credit card')
)

SELECT DISTINCT * FROM (
SELECT
    service_type,
    pickup_year,
    pickup_month,
    PERCENTILE_CONT(fare_amount, 0.97) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p97,
    PERCENTILE_CONT(fare_amount, 0.95) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p95,
    PERCENTILE_CONT(fare_amount, 0.90) OVER (
        PARTITION BY service_type, pickup_year, pickup_month
    ) AS p90
FROM filtered_trips)
    );
  
[0m21:24:01.646419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tough-timing-449701-k0&j=bq:us-east1:c6c64a7e-7026-4755-9949-609b35097dd1&page=queryresults
[0m21:24:09.482608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd4afb5-e27b-4b50-90a6-2f2dfea49505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D4C1FA90>]}
[0m21:24:09.482608 [info ] [Thread-1 (]: 1 of 1 OK created sql table model taxi_data_core.fct_taxi_trips_monthly_fare_p95  [[32mCREATE TABLE (73.0 rows, 3.8 GiB processed)[0m in 8.71s]
[0m21:24:09.483611 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95
[0m21:24:09.484606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:24:09.485690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:09.485690 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0' was properly closed.
[0m21:24:09.486611 [debug] [MainThread]: Connection 'list_tough-timing-449701-k0_taxi_data_core' was properly closed.
[0m21:24:09.486611 [debug] [MainThread]: Connection 'model.taxi_rides_ny.fct_taxi_trips_monthly_fare_p95' was properly closed.
[0m21:24:09.486611 [info ] [MainThread]: 
[0m21:24:09.487676 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.85 seconds (10.85s).
[0m21:24:09.488607 [debug] [MainThread]: Command end result
[0m21:24:09.508653 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\manifest.json
[0m21:24:09.513165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\semantic_manifest.json
[0m21:24:09.517163 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\watan\Documents\GitHub\Data-Engineering-Zoomcamp-answers\Data-Engineering-Zoomcamp-answers\Module_04\target\run_results.json
[0m21:24:09.517163 [info ] [MainThread]: 
[0m21:24:09.518164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:24:09.519164 [info ] [MainThread]: 
[0m21:24:09.519164 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:24:09.521185 [debug] [MainThread]: Command `dbt run` succeeded at 21:24:09.520165 after 13.38 seconds
[0m21:24:09.521185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769D64E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769D64E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769D64FA10>]}
[0m21:24:09.521185 [debug] [MainThread]: Flushing usage events
[0m21:24:11.232578 [debug] [MainThread]: An error was encountered while trying to flush usage events
